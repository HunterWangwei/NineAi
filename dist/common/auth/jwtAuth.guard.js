'use strict';const _0x2612cb=_0x41fb;function _0x5ec1(){const _0x4d0c1a=['UnauthorizedException','NON_AUTHORITATIVE_INFORMATION','HttpStatus','design:paramtypes','slice','Bearer','extractToken','checkTokenAuth','jsonwebtoken','1055898teUQZO','getOwnPropertyDescriptor','get','../../modules/globalConfig/globalConfig.service','35jPJfSa','@nestjs/common','redisCacheService','object','259286kpBwfp','65484aFkhpS','canActivate','validateToken','createTokenFromFingerprint','../../modules/auth/auth.service','authorization','headers','authService','getRandomItemFromArray','copyRightMsg','switchToHttp','checkDomain','globalConfigService','fingerprint','function','x-website-domain','HttpException','defineProperty','JWT_SECRET','804344elxOzd','split','jwt','decorate','ModuleRef','__metadata','RedisCacheService','user','handleRequest','__esModule','length','metadata','6EyGVWd','亲爱的用户,请登录后继续操作,我们正在等您的到来！','getRequest','9197947rtTfAo','JwtAuthGuard','UNAUTHORIZED','1168cdGszG','AuthGuard','20MRPUvx','AuthService','decrypt','toString','1938868WWpXWN','2550655KISvmu','moduleRef'];_0x5ec1=function(){return _0x4d0c1a;};return _0x5ec1();}(function(_0xb239c0,_0x4b8e5e){const _0x3a3000=_0x41fb,_0x2cd81e=_0xb239c0();while(!![]){try{const _0x454114=-parseInt(_0x3a3000(0x95))/0x1+-parseInt(_0x3a3000(0xa9))/0x2+-parseInt(_0x3a3000(0xb5))/0x3*(parseInt(_0x3a3000(0x81))/0x4)+parseInt(_0x3a3000(0x82))/0x5+parseInt(_0x3a3000(0x8d))/0x6*(-parseInt(_0x3a3000(0x91))/0x7)+-parseInt(_0x3a3000(0xbb))/0x8*(-parseInt(_0x3a3000(0x96))/0x9)+parseInt(_0x3a3000(0xbd))/0xa*(parseInt(_0x3a3000(0xb8))/0xb);if(_0x454114===_0x4b8e5e)break;else _0x2cd81e['push'](_0x2cd81e['shift']());}catch(_0x3796a8){_0x2cd81e['push'](_0x2cd81e['shift']());}}}(_0x5ec1,0xb3316));function _0x41fb(_0x2ff4ed,_0x29e19d){const _0x5ec148=_0x5ec1();return _0x41fb=function(_0x41fb98,_0x270914){_0x41fb98=_0x41fb98-0x81;let _0x25dab2=_0x5ec148[_0x41fb98];return _0x25dab2;},_0x41fb(_0x2ff4ed,_0x29e19d);}var __decorate=this&&this['__decorate']||function(_0x5aed1f,_0x45409a,_0x4072fd,_0x38d40f){const _0x3b6cd2=_0x41fb;var _0x1bc12d=arguments[_0x3b6cd2(0xb3)],_0x166219=_0x1bc12d<0x3?_0x45409a:_0x38d40f===null?_0x38d40f=Object[_0x3b6cd2(0x8e)](_0x45409a,_0x4072fd):_0x38d40f,_0x5e5f80;if(typeof Reflect===_0x3b6cd2(0x94)&&typeof Reflect[_0x3b6cd2(0xac)]===_0x3b6cd2(0xa4))_0x166219=Reflect['decorate'](_0x5aed1f,_0x45409a,_0x4072fd,_0x38d40f);else{for(var _0x13d0fd=_0x5aed1f['length']-0x1;_0x13d0fd>=0x0;_0x13d0fd--)if(_0x5e5f80=_0x5aed1f[_0x13d0fd])_0x166219=(_0x1bc12d<0x3?_0x5e5f80(_0x166219):_0x1bc12d>0x3?_0x5e5f80(_0x45409a,_0x4072fd,_0x166219):_0x5e5f80(_0x45409a,_0x4072fd))||_0x166219;}return _0x1bc12d>0x3&&_0x166219&&Object[_0x3b6cd2(0xa7)](_0x45409a,_0x4072fd,_0x166219),_0x166219;},__metadata=this&&this[_0x2612cb(0xae)]||function(_0xd7d433,_0x2d7bbf){const _0x11d65e=_0x2612cb;if(typeof Reflect===_0x11d65e(0x94)&&typeof Reflect[_0x11d65e(0xb4)]===_0x11d65e(0xa4))return Reflect[_0x11d65e(0xb4)](_0xd7d433,_0x2d7bbf);};Object[_0x2612cb(0xa7)](exports,_0x2612cb(0xb2),{'value':!![]}),exports[_0x2612cb(0xb9)]=void 0x0;const redisCache_service_1=require('../../modules/redisCache/redisCache.service'),common_1=require(_0x2612cb(0x92)),passport_1=require('@nestjs/passport'),jwt=require(_0x2612cb(0x8c)),core_1=require('@nestjs/core'),globalConfig_service_1=require(_0x2612cb(0x90)),utils_1=require('../utils'),auth_service_1=require(_0x2612cb(0x9a));let JwtAuthGuard=class JwtAuthGuard extends(0x0,passport_1[_0x2612cb(0xbc)])(_0x2612cb(0xab)){constructor(_0x5328b0,_0x5aaaa7,_0x964fc9,_0x1f7d3f){const _0x10fd4f=_0x2612cb;super(),this['redisCacheService']=_0x5328b0,this[_0x10fd4f(0x83)]=_0x5aaaa7,this['globalConfigService']=_0x964fc9,this[_0x10fd4f(0x9d)]=_0x1f7d3f;}async[_0x2612cb(0x97)](_0x247d84){const _0x39142a=_0x2612cb;!this[_0x39142a(0x93)]&&(this[_0x39142a(0x93)]=this[_0x39142a(0x83)][_0x39142a(0x8f)](redisCache_service_1[_0x39142a(0xaf)],{'strict':![]}));const _0x113067=_0x247d84[_0x39142a(0xa0)]()[_0x39142a(0xb7)](),_0x450848=_0x113067['headers'][_0x39142a(0xa5)],_0x2a7e75=this[_0x39142a(0x8a)](_0x113067);_0x113067[_0x39142a(0xb0)]=this[_0x39142a(0x98)](_0x2a7e75);const _0x1fdd6c=await this[_0x39142a(0xa2)]['getNineAiToken']();if(!_0x1fdd6c){const _0x1c323c=(0x0,utils_1[_0x39142a(0x9e)])(utils_1[_0x39142a(0x9f)]);throw new common_1[(_0x39142a(0xa6))]((0x0,utils_1[_0x39142a(0xbf)])(_0x1c323c),common_1[_0x39142a(0x86)][_0x39142a(0x85)]);}return await this[_0x39142a(0x93)][_0x39142a(0x8b)](_0x2a7e75,_0x113067),await this['globalConfigService'][_0x39142a(0xa1)](_0x450848,_0x113067),!![];}[_0x2612cb(0x8a)](_0x22bcba){const _0x54d19b=_0x2612cb;if(!_0x22bcba['headers']['authorization']){if(_0x22bcba[_0x54d19b(0x9c)]['fingerprint']){let _0x5de627=_0x22bcba[_0x54d19b(0x9c)][_0x54d19b(0xa3)];_0x5de627>0x7fffffff&&(_0x5de627=_0x5de627[_0x54d19b(0xc0)]()[_0x54d19b(0x88)](-0x9),_0x5de627=Number(String(Number(_0x5de627))));const _0x3d139b=this[_0x54d19b(0x9d)][_0x54d19b(0x99)](_0x5de627);return _0x3d139b;}return null;}const _0x4e3d17=_0x22bcba['headers'][_0x54d19b(0x9b)][_0x54d19b(0xaa)]('\x20');if(_0x4e3d17[_0x54d19b(0xb3)]!==0x2||_0x4e3d17[0x0]!==_0x54d19b(0x89))return null;return _0x4e3d17[0x1];}[_0x2612cb(0x98)](_0x54c6ee){const _0x16579f=_0x2612cb;try{return jwt['verify'](_0x54c6ee,process['env'][_0x16579f(0xa8)]);}catch(_0x1cdb87){throw new common_1['HttpException'](_0x16579f(0xb6),common_1[_0x16579f(0x86)][_0x16579f(0xba)]);}}[_0x2612cb(0xb1)](_0x946291,_0x317595,_0x231e6d){const _0x380f8a=_0x2612cb;if(_0x946291||!_0x317595)throw _0x946291||new common_1[(_0x380f8a(0x84))]();return _0x317595;}};JwtAuthGuard=__decorate([(0x0,common_1['Injectable'])(),__metadata(_0x2612cb(0x87),[redisCache_service_1[_0x2612cb(0xaf)],core_1[_0x2612cb(0xad)],globalConfig_service_1['GlobalConfigService'],auth_service_1[_0x2612cb(0xbe)]])],JwtAuthGuard),exports[_0x2612cb(0xb9)]=JwtAuthGuard;