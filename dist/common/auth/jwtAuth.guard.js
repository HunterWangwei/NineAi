'use strict';const _0x873a96=_0x5bcf;(function(_0x91c996,_0x238644){const _0x9ccb76=_0x5bcf,_0xc094c7=_0x91c996();while(!![]){try{const _0x2a3108=parseInt(_0x9ccb76(0x1cb))/0x1*(-parseInt(_0x9ccb76(0x1e6))/0x2)+parseInt(_0x9ccb76(0x1da))/0x3+parseInt(_0x9ccb76(0x1e0))/0x4+-parseInt(_0x9ccb76(0x1ed))/0x5+parseInt(_0x9ccb76(0x1b9))/0x6*(-parseInt(_0x9ccb76(0x1dd))/0x7)+-parseInt(_0x9ccb76(0x1c3))/0x8*(-parseInt(_0x9ccb76(0x1cd))/0x9)+parseInt(_0x9ccb76(0x1d5))/0xa;if(_0x2a3108===_0x238644)break;else _0xc094c7['push'](_0xc094c7['shift']());}catch(_0x21d4d2){_0xc094c7['push'](_0xc094c7['shift']());}}}(_0xd19a,0x575e3));var __decorate=this&&this[_0x873a96(0x1e2)]||function(_0x4bb5d6,_0x38e8e3,_0x452421,_0xd83d17){const _0x3694f7=_0x873a96;var _0x1b2177=arguments[_0x3694f7(0x1c6)],_0x45914a=_0x1b2177<0x3?_0x38e8e3:_0xd83d17===null?_0xd83d17=Object['getOwnPropertyDescriptor'](_0x38e8e3,_0x452421):_0xd83d17,_0x69a7cf;if(typeof Reflect===_0x3694f7(0x1d4)&&typeof Reflect[_0x3694f7(0x1c8)]===_0x3694f7(0x1dc))_0x45914a=Reflect[_0x3694f7(0x1c8)](_0x4bb5d6,_0x38e8e3,_0x452421,_0xd83d17);else{for(var _0x3b649b=_0x4bb5d6[_0x3694f7(0x1c6)]-0x1;_0x3b649b>=0x0;_0x3b649b--)if(_0x69a7cf=_0x4bb5d6[_0x3b649b])_0x45914a=(_0x1b2177<0x3?_0x69a7cf(_0x45914a):_0x1b2177>0x3?_0x69a7cf(_0x38e8e3,_0x452421,_0x45914a):_0x69a7cf(_0x38e8e3,_0x452421))||_0x45914a;}return _0x1b2177>0x3&&_0x45914a&&Object[_0x3694f7(0x1d0)](_0x38e8e3,_0x452421,_0x45914a),_0x45914a;},__metadata=this&&this[_0x873a96(0x1d9)]||function(_0x50352f,_0x26da7c){const _0x5eb3ec=_0x873a96;if(typeof Reflect===_0x5eb3ec(0x1d4)&&typeof Reflect[_0x5eb3ec(0x1eb)]===_0x5eb3ec(0x1dc))return Reflect[_0x5eb3ec(0x1eb)](_0x50352f,_0x26da7c);};Object[_0x873a96(0x1d0)](exports,'__esModule',{'value':!![]}),exports[_0x873a96(0x1bd)]=void 0x0;const redisCache_service_1=require('../../modules/redisCache/redisCache.service'),common_1=require(_0x873a96(0x1e3)),passport_1=require(_0x873a96(0x1e1)),jwt=require('jsonwebtoken'),core_1=require(_0x873a96(0x1bf)),globalConfig_service_1=require(_0x873a96(0x1bc)),utils_1=require('../utils'),auth_service_1=require('../../modules/auth/auth.service');let JwtAuthGuard=class JwtAuthGuard extends(0x0,passport_1[_0x873a96(0x1bb)])('jwt'){constructor(_0x32a013,_0x294373,_0x51855e,_0x2984f4){const _0x226073=_0x873a96;super(),this[_0x226073(0x1de)]=_0x32a013,this[_0x226073(0x1d1)]=_0x294373,this[_0x226073(0x1ea)]=_0x51855e,this[_0x226073(0x1d8)]=_0x2984f4;}async[_0x873a96(0x1c9)](_0x2bf1cf){const _0x390516=_0x873a96;!this[_0x390516(0x1de)]&&(this[_0x390516(0x1de)]=this[_0x390516(0x1d1)]['get'](redisCache_service_1['RedisCacheService'],{'strict':![]}));const _0x33668d=_0x2bf1cf[_0x390516(0x1c5)]()[_0x390516(0x1cf)](),_0x1362ab=_0x33668d[_0x390516(0x1d2)]['x-website-domain'],_0x23fa6a=this[_0x390516(0x1c4)](_0x33668d);_0x33668d[_0x390516(0x1ca)]=this[_0x390516(0x1e9)](_0x23fa6a);const _0x53fdeb=await this['globalConfigService'][_0x390516(0x1d6)]();if(!_0x53fdeb){const _0x4d72de=(0x0,utils_1[_0x390516(0x1ce)])(utils_1[_0x390516(0x1c0)]);throw new common_1[(_0x390516(0x1d7))]((0x0,utils_1[_0x390516(0x1e7)])(_0x4d72de),common_1[_0x390516(0x1e8)][_0x390516(0x1c2)]);}return await this[_0x390516(0x1de)][_0x390516(0x1ef)](_0x23fa6a,_0x33668d),await this[_0x390516(0x1ea)]['checkDomain'](_0x1362ab),!![];}[_0x873a96(0x1c4)](_0x202318){const _0x25b1a1=_0x873a96;if(!_0x202318[_0x25b1a1(0x1d2)][_0x25b1a1(0x1ec)]){if(_0x202318[_0x25b1a1(0x1d2)][_0x25b1a1(0x1f0)]){let _0x35f234=_0x202318['headers'][_0x25b1a1(0x1f0)];_0x35f234>0x7fffffff&&(_0x35f234=_0x35f234['toString']()['slice'](-0x9),_0x35f234=Number(String(Number(_0x35f234))));const _0x324ff6=this[_0x25b1a1(0x1d8)]['createTokenFromFingerprint'](_0x35f234);return _0x324ff6;}return null;}const _0x4bbb4a=_0x202318[_0x25b1a1(0x1d2)][_0x25b1a1(0x1ec)]['split']('\x20');if(_0x4bbb4a[_0x25b1a1(0x1c6)]!==0x2||_0x4bbb4a[0x0]!==_0x25b1a1(0x1ee))return null;return _0x4bbb4a[0x1];}['validateToken'](_0x4c77d8){const _0x54086a=_0x873a96;try{return jwt[_0x54086a(0x1d3)](_0x4c77d8,process[_0x54086a(0x1c1)][_0x54086a(0x1ba)]);}catch(_0x216632){throw new common_1[(_0x54086a(0x1d7))](_0x54086a(0x1db),common_1[_0x54086a(0x1e8)][_0x54086a(0x1e5)]);}}[_0x873a96(0x1be)](_0x396a19,_0x13bb65,_0x50e829){const _0x51e813=_0x873a96;if(_0x396a19||!_0x13bb65)throw _0x396a19||new common_1[(_0x51e813(0x1c7))]();return _0x13bb65;}};function _0xd19a(){const _0x16c088=['GlobalConfigService','9UPRQbp','getRandomItemFromArray','getRequest','defineProperty','moduleRef','headers','verify','object','1028810rhxEwZ','getNineAiToken','HttpException','authService','__metadata','418194VeAxyF','亲爱的用户,请登录后继续操作,我们正在等您的到来！','function','21aoFQas','redisCacheService','RedisCacheService','2258856gpVRpS','@nestjs/passport','__decorate','@nestjs/common','design:paramtypes','UNAUTHORIZED','12btrKAf','decrypt','HttpStatus','validateToken','globalConfigService','metadata','authorization','610915fdcCbt','Bearer','checkTokenAuth','fingerprint','601830fXDcWv','JWT_SECRET','AuthGuard','../../modules/globalConfig/globalConfig.service','JwtAuthGuard','handleRequest','@nestjs/core','copyRightMsg','env','NON_AUTHORITATIVE_INFORMATION','176144PZclEV','extractToken','switchToHttp','length','UnauthorizedException','decorate','canActivate','user','8009ZixzNA'];_0xd19a=function(){return _0x16c088;};return _0xd19a();}function _0x5bcf(_0x36a605,_0x573c08){const _0xd19ad9=_0xd19a();return _0x5bcf=function(_0x5bcfea,_0x4c256d){_0x5bcfea=_0x5bcfea-0x1b9;let _0x53d3e2=_0xd19ad9[_0x5bcfea];return _0x53d3e2;},_0x5bcf(_0x36a605,_0x573c08);}JwtAuthGuard=__decorate([(0x0,common_1['Injectable'])(),__metadata(_0x873a96(0x1e4),[redisCache_service_1[_0x873a96(0x1df)],core_1['ModuleRef'],globalConfig_service_1[_0x873a96(0x1cc)],auth_service_1['AuthService']])],JwtAuthGuard),exports[_0x873a96(0x1bd)]=JwtAuthGuard;