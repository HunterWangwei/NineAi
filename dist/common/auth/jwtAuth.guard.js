'use strict';const _0x5ef563=_0x2644;function _0x2644(_0x4b7dd1,_0x342cb7){const _0x4ea53a=_0x4ea5();return _0x2644=function(_0x2644a2,_0x3b6c4e){_0x2644a2=_0x2644a2-0xef;let _0x113cab=_0x4ea53a[_0x2644a2];return _0x113cab;},_0x2644(_0x4b7dd1,_0x342cb7);}(function(_0x5f197f,_0x5ca030){const _0x4f8f2b=_0x2644,_0x41f2e4=_0x5f197f();while(!![]){try{const _0x510d0e=parseInt(_0x4f8f2b(0x108))/0x1*(parseInt(_0x4f8f2b(0x11a))/0x2)+-parseInt(_0x4f8f2b(0x103))/0x3*(-parseInt(_0x4f8f2b(0x102))/0x4)+parseInt(_0x4f8f2b(0xf4))/0x5*(parseInt(_0x4f8f2b(0xf8))/0x6)+-parseInt(_0x4f8f2b(0x10a))/0x7+-parseInt(_0x4f8f2b(0x10b))/0x8*(parseInt(_0x4f8f2b(0x10d))/0x9)+-parseInt(_0x4f8f2b(0x110))/0xa+parseInt(_0x4f8f2b(0x127))/0xb*(parseInt(_0x4f8f2b(0xff))/0xc);if(_0x510d0e===_0x5ca030)break;else _0x41f2e4['push'](_0x41f2e4['shift']());}catch(_0x445175){_0x41f2e4['push'](_0x41f2e4['shift']());}}}(_0x4ea5,0x3f461));var __decorate=this&&this[_0x5ef563(0x111)]||function(_0x3e231c,_0x3d0753,_0x17bbd4,_0x37e2dd){const _0x1ced9f=_0x5ef563;var _0x392221=arguments[_0x1ced9f(0x107)],_0x6a7992=_0x392221<0x3?_0x3d0753:_0x37e2dd===null?_0x37e2dd=Object['getOwnPropertyDescriptor'](_0x3d0753,_0x17bbd4):_0x37e2dd,_0x3025ee;if(typeof Reflect===_0x1ced9f(0x119)&&typeof Reflect[_0x1ced9f(0x10f)]===_0x1ced9f(0x100))_0x6a7992=Reflect[_0x1ced9f(0x10f)](_0x3e231c,_0x3d0753,_0x17bbd4,_0x37e2dd);else{for(var _0x1f5bf7=_0x3e231c['length']-0x1;_0x1f5bf7>=0x0;_0x1f5bf7--)if(_0x3025ee=_0x3e231c[_0x1f5bf7])_0x6a7992=(_0x392221<0x3?_0x3025ee(_0x6a7992):_0x392221>0x3?_0x3025ee(_0x3d0753,_0x17bbd4,_0x6a7992):_0x3025ee(_0x3d0753,_0x17bbd4))||_0x6a7992;}return _0x392221>0x3&&_0x6a7992&&Object[_0x1ced9f(0xf0)](_0x3d0753,_0x17bbd4,_0x6a7992),_0x6a7992;},__metadata=this&&this[_0x5ef563(0x104)]||function(_0x422b68,_0x2050aa){const _0x1f719a=_0x5ef563;if(typeof Reflect===_0x1f719a(0x119)&&typeof Reflect[_0x1f719a(0xfc)]===_0x1f719a(0x100))return Reflect[_0x1f719a(0xfc)](_0x422b68,_0x2050aa);};Object['defineProperty'](exports,'__esModule',{'value':!![]}),exports['JwtAuthGuard']=void 0x0;function _0x4ea5(){const _0x50ee57=['4703501XDwaZg','decrypt','@nestjs/common','../../modules/redisCache/redisCache.service','checkTokenAuth','handleRequest','get','jwt','defineProperty','authService','JWT_SECRET','slice','507665bYeIFi','UNAUTHORIZED','AuthGuard','split','12bcrRWe','HttpStatus','canActivate','extractToken','metadata','Bearer','toString','12HSvxqs','function','UnauthorizedException','556NoFiEt','6516sBdwRf','__metadata','AuthService','RedisCacheService','length','69858ZPWGSY','亲爱的用户,请登录后继续操作,我们正在等您的到来！','372008oFCloU','16ANOnYz','authorization','982809hBqYnc','Injectable','decorate','4717080VnvTyN','__decorate','moduleRef','headers','../utils','../../modules/auth/auth.service','checkDomain','getRequest','design:paramtypes','object','2WHebCD','x-website-domain','switchToHttp','globalConfigService','HttpException','verify','@nestjs/core','user','redisCacheService','validateToken','fingerprint','createTokenFromFingerprint','jsonwebtoken'];_0x4ea5=function(){return _0x50ee57;};return _0x4ea5();}const redisCache_service_1=require(_0x5ef563(0x12a)),common_1=require(_0x5ef563(0x129)),passport_1=require('@nestjs/passport'),jwt=require(_0x5ef563(0x126)),core_1=require(_0x5ef563(0x120)),globalConfig_service_1=require('../../modules/globalConfig/globalConfig.service'),utils_1=require(_0x5ef563(0x114)),auth_service_1=require(_0x5ef563(0x115));let JwtAuthGuard=class JwtAuthGuard extends(0x0,passport_1[_0x5ef563(0xf6)])(_0x5ef563(0xef)){constructor(_0x170519,_0xc5416e,_0x1c2a31,_0x1cfc8d){const _0x49ba9a=_0x5ef563;super(),this[_0x49ba9a(0x122)]=_0x170519,this[_0x49ba9a(0x112)]=_0xc5416e,this['globalConfigService']=_0x1c2a31,this[_0x49ba9a(0xf1)]=_0x1cfc8d;}async[_0x5ef563(0xfa)](_0x4a4e13){const _0x187669=_0x5ef563;!this['redisCacheService']&&(this['redisCacheService']=this[_0x187669(0x112)][_0x187669(0x12d)](redisCache_service_1[_0x187669(0x106)],{'strict':![]}));const _0x3c51f6=_0x4a4e13[_0x187669(0x11c)]()[_0x187669(0x117)](),_0x378100=_0x3c51f6['headers'][_0x187669(0x11b)],_0x5e18ff=this['extractToken'](_0x3c51f6);_0x3c51f6[_0x187669(0x121)]=this[_0x187669(0x123)](_0x5e18ff);const _0x48a794=await this[_0x187669(0x11d)]['getNineAiToken']();if(!_0x48a794){const _0x55465d=(0x0,utils_1['getRandomItemFromArray'])(utils_1['copyRightMsg']);throw new common_1[(_0x187669(0x11e))]((0x0,utils_1[_0x187669(0x128)])(_0x55465d),common_1['HttpStatus']['NON_AUTHORITATIVE_INFORMATION']);}return await this[_0x187669(0x122)][_0x187669(0x12b)](_0x5e18ff,_0x3c51f6),await this[_0x187669(0x11d)][_0x187669(0x116)](_0x378100),!![];}[_0x5ef563(0xfb)](_0x37b873){const _0x58fc48=_0x5ef563;if(!_0x37b873['headers'][_0x58fc48(0x10c)]){if(_0x37b873['headers'][_0x58fc48(0x124)]){let _0x9580e5=_0x37b873[_0x58fc48(0x113)][_0x58fc48(0x124)];_0x9580e5>0x7fffffff&&(_0x9580e5=_0x9580e5[_0x58fc48(0xfe)]()[_0x58fc48(0xf3)](-0x9),_0x9580e5=Number(String(Number(_0x9580e5))));const _0x5c4203=this[_0x58fc48(0xf1)][_0x58fc48(0x125)](_0x9580e5);return _0x5c4203;}return null;}const _0x5f32db=_0x37b873[_0x58fc48(0x113)][_0x58fc48(0x10c)][_0x58fc48(0xf7)]('\x20');if(_0x5f32db[_0x58fc48(0x107)]!==0x2||_0x5f32db[0x0]!==_0x58fc48(0xfd))return null;return _0x5f32db[0x1];}['validateToken'](_0x1e5b0c){const _0x564b2f=_0x5ef563;try{return jwt[_0x564b2f(0x11f)](_0x1e5b0c,process['env'][_0x564b2f(0xf2)]);}catch(_0xe9f9b8){throw new common_1[(_0x564b2f(0x11e))](_0x564b2f(0x109),common_1[_0x564b2f(0xf9)][_0x564b2f(0xf5)]);}}[_0x5ef563(0x12c)](_0x359a5c,_0x7261bf,_0x2e459f){const _0x2ea78b=_0x5ef563;if(_0x359a5c||!_0x7261bf)throw _0x359a5c||new common_1[(_0x2ea78b(0x101))]();return _0x7261bf;}};JwtAuthGuard=__decorate([(0x0,common_1[_0x5ef563(0x10e)])(),__metadata(_0x5ef563(0x118),[redisCache_service_1[_0x5ef563(0x106)],core_1['ModuleRef'],globalConfig_service_1['GlobalConfigService'],auth_service_1[_0x5ef563(0x105)]])],JwtAuthGuard),exports['JwtAuthGuard']=JwtAuthGuard;