'use strict';const _0x542390=_0x3f06;(function(_0x1d86cc,_0x4d5f8f){const _0x495d4f=_0x3f06,_0x1f5905=_0x1d86cc();while(!![]){try{const _0x1e11a7=parseInt(_0x495d4f(0x18c))/0x1+parseInt(_0x495d4f(0x172))/0x2*(parseInt(_0x495d4f(0x18f))/0x3)+-parseInt(_0x495d4f(0x184))/0x4+parseInt(_0x495d4f(0x16c))/0x5*(parseInt(_0x495d4f(0x18a))/0x6)+parseInt(_0x495d4f(0x162))/0x7+-parseInt(_0x495d4f(0x169))/0x8*(parseInt(_0x495d4f(0x199))/0x9)+-parseInt(_0x495d4f(0x15d))/0xa*(parseInt(_0x495d4f(0x190))/0xb);if(_0x1e11a7===_0x4d5f8f)break;else _0x1f5905['push'](_0x1f5905['shift']());}catch(_0x22647e){_0x1f5905['push'](_0x1f5905['shift']());}}}(_0x73e0,0x6d8b7));var __decorate=this&&this[_0x542390(0x181)]||function(_0x2741b2,_0x5a4dc9,_0x2d3f87,_0xe9c33b){const _0x5ae8e1=_0x542390;var _0x88c765=arguments['length'],_0x48f52c=_0x88c765<0x3?_0x5a4dc9:_0xe9c33b===null?_0xe9c33b=Object['getOwnPropertyDescriptor'](_0x5a4dc9,_0x2d3f87):_0xe9c33b,_0x35c0dd;if(typeof Reflect==='object'&&typeof Reflect[_0x5ae8e1(0x15c)]==='function')_0x48f52c=Reflect['decorate'](_0x2741b2,_0x5a4dc9,_0x2d3f87,_0xe9c33b);else{for(var _0x2fd1ab=_0x2741b2[_0x5ae8e1(0x183)]-0x1;_0x2fd1ab>=0x0;_0x2fd1ab--)if(_0x35c0dd=_0x2741b2[_0x2fd1ab])_0x48f52c=(_0x88c765<0x3?_0x35c0dd(_0x48f52c):_0x88c765>0x3?_0x35c0dd(_0x5a4dc9,_0x2d3f87,_0x48f52c):_0x35c0dd(_0x5a4dc9,_0x2d3f87))||_0x48f52c;}return _0x88c765>0x3&&_0x48f52c&&Object['defineProperty'](_0x5a4dc9,_0x2d3f87,_0x48f52c),_0x48f52c;},__metadata=this&&this[_0x542390(0x164)]||function(_0x47f598,_0x2219d6){const _0x424dd8=_0x542390;if(typeof Reflect===_0x424dd8(0x191)&&typeof Reflect[_0x424dd8(0x194)]===_0x424dd8(0x197))return Reflect[_0x424dd8(0x194)](_0x47f598,_0x2219d6);};Object['defineProperty'](exports,_0x542390(0x18b),{'value':!![]}),exports[_0x542390(0x186)]=void 0x0;function _0x73e0(){const _0x4131ab=['jwt','metadata','JWT_SECRET','globalConfigService','function','user','2169162ZCIMhS','extractToken','decorate','230NnfNcf','ModuleRef','authorization','authService','AuthGuard','5144895IEjilm','getRequest','__metadata','AuthService','fingerprint','HttpException','switchToHttp','24vAWLOp','NON_AUTHORITATIVE_INFORMATION','checkTokenAuth','2095jqkUtR','env','design:paramtypes','validateToken','copyRightMsg','UNAUTHORIZED','466eCCPRR','../utils','redisCacheService','jsonwebtoken','headers','get','moduleRef','Bearer','GlobalConfigService','Injectable','getRandomItemFromArray','RedisCacheService','UnauthorizedException','verify','decrypt','__decorate','checkDomain','length','2234692SNkSFM','../../modules/auth/auth.service','JwtAuthGuard','../../modules/redisCache/redisCache.service','HttpStatus','handleRequest','8418QrcDKJ','__esModule','816629MNPrNd','@nestjs/common','getNineAiToken','6354wHXFWi','431651ccSrts','object','split'];_0x73e0=function(){return _0x4131ab;};return _0x73e0();}const redisCache_service_1=require(_0x542390(0x187)),common_1=require(_0x542390(0x18d)),passport_1=require('@nestjs/passport'),jwt=require(_0x542390(0x175)),core_1=require('@nestjs/core'),globalConfig_service_1=require('../../modules/globalConfig/globalConfig.service'),utils_1=require(_0x542390(0x173)),auth_service_1=require(_0x542390(0x185));function _0x3f06(_0x2eba58,_0x12eed2){const _0x73e03e=_0x73e0();return _0x3f06=function(_0x3f0679,_0x1965f2){_0x3f0679=_0x3f0679-0x15c;let _0x54e9d2=_0x73e03e[_0x3f0679];return _0x54e9d2;},_0x3f06(_0x2eba58,_0x12eed2);}let JwtAuthGuard=class JwtAuthGuard extends(0x0,passport_1[_0x542390(0x161)])(_0x542390(0x193)){constructor(_0x182b0c,_0x235086,_0x204a4f,_0x48d6f0){const _0xb6dba9=_0x542390;super(),this['redisCacheService']=_0x182b0c,this[_0xb6dba9(0x178)]=_0x235086,this[_0xb6dba9(0x196)]=_0x204a4f,this[_0xb6dba9(0x160)]=_0x48d6f0;}async['canActivate'](_0x3e739c){const _0xa36669=_0x542390;!this[_0xa36669(0x174)]&&(this['redisCacheService']=this[_0xa36669(0x178)][_0xa36669(0x177)](redisCache_service_1[_0xa36669(0x17d)],{'strict':![]}));const _0x49b7a0=_0x3e739c[_0xa36669(0x168)]()[_0xa36669(0x163)](),_0x10f180=_0x49b7a0[_0xa36669(0x176)]['x-website-domain'],_0x385130=this[_0xa36669(0x19a)](_0x49b7a0);_0x49b7a0[_0xa36669(0x198)]=this[_0xa36669(0x16f)](_0x385130);const _0x4476a8=await this[_0xa36669(0x196)][_0xa36669(0x18e)]();if(!_0x4476a8){const _0x38bd46=(0x0,utils_1[_0xa36669(0x17c)])(utils_1[_0xa36669(0x170)]);throw new common_1['HttpException']((0x0,utils_1[_0xa36669(0x180)])(_0x38bd46),common_1[_0xa36669(0x188)][_0xa36669(0x16a)]);}return await this[_0xa36669(0x174)][_0xa36669(0x16b)](_0x385130,_0x49b7a0),await this[_0xa36669(0x196)][_0xa36669(0x182)](_0x10f180,_0x49b7a0),!![];}[_0x542390(0x19a)](_0x223b62){const _0x392a7a=_0x542390;if(!_0x223b62[_0x392a7a(0x176)][_0x392a7a(0x15f)]){if(_0x223b62[_0x392a7a(0x176)]['fingerprint']){let _0x465280=_0x223b62[_0x392a7a(0x176)][_0x392a7a(0x166)];_0x465280>0x7fffffff&&(_0x465280=_0x465280['toString']()['slice'](-0x9),_0x465280=Number(String(Number(_0x465280))));const _0x4171f5=this[_0x392a7a(0x160)]['createTokenFromFingerprint'](_0x465280);return _0x4171f5;}return null;}const _0x1514e2=_0x223b62[_0x392a7a(0x176)]['authorization'][_0x392a7a(0x192)]('\x20');if(_0x1514e2[_0x392a7a(0x183)]!==0x2||_0x1514e2[0x0]!==_0x392a7a(0x179))return null;return _0x1514e2[0x1];}[_0x542390(0x16f)](_0x2cc139){const _0x55ae52=_0x542390;try{return jwt[_0x55ae52(0x17f)](_0x2cc139,process[_0x55ae52(0x16d)][_0x55ae52(0x195)]);}catch(_0x4564b6){throw new common_1[(_0x55ae52(0x167))]('亲爱的用户,请登录后继续操作,我们正在等您的到来！',common_1[_0x55ae52(0x188)][_0x55ae52(0x171)]);}}[_0x542390(0x189)](_0x4072e8,_0x38f01f,_0x52c0f4){const _0x328e5f=_0x542390;if(_0x4072e8||!_0x38f01f)throw _0x4072e8||new common_1[(_0x328e5f(0x17e))]();return _0x38f01f;}};JwtAuthGuard=__decorate([(0x0,common_1[_0x542390(0x17b)])(),__metadata(_0x542390(0x16e),[redisCache_service_1[_0x542390(0x17d)],core_1[_0x542390(0x15e)],globalConfig_service_1[_0x542390(0x17a)],auth_service_1[_0x542390(0x165)]])],JwtAuthGuard),exports[_0x542390(0x186)]=JwtAuthGuard;