'use strict';const _0x218951=_0x4fa1;(function(_0x375350,_0x4814b5){const _0x321a53=_0x4fa1,_0x1196f4=_0x375350();while(!![]){try{const _0x5918eb=-parseInt(_0x321a53(0x115))/0x1+parseInt(_0x321a53(0x108))/0x2*(-parseInt(_0x321a53(0x110))/0x3)+-parseInt(_0x321a53(0xfe))/0x4+-parseInt(_0x321a53(0x106))/0x5*(-parseInt(_0x321a53(0x102))/0x6)+parseInt(_0x321a53(0xc6))/0x7+parseInt(_0x321a53(0xfb))/0x8*(parseInt(_0x321a53(0xe1))/0x9)+-parseInt(_0x321a53(0x119))/0xa*(-parseInt(_0x321a53(0xea))/0xb);if(_0x5918eb===_0x4814b5)break;else _0x1196f4['push'](_0x1196f4['shift']());}catch(_0x58e5ad){_0x1196f4['push'](_0x1196f4['shift']());}}}(_0x4e57,0x27dd7));function _0x4e57(){const _0x2f365e=['UserAppsEntity','decorate','./appCats.entity','1552803EtHAcI','该分类下存在App，不可删除！','error:\x20','@nestjs/typeorm','createAppCat','createQueryBuilder','findOne','map','该分类不存在！','修改App信息成功','修改App信息失败！','您正在编辑一个不存在的应用！','forEach','HttpException','auditPass','affected','typeorm','该应用不存在！','删除App失败！','RAND()','name','removeEmoji','auditFail','role','Not','save','count','36vBAtVi','删除App成功','InjectRepository','删除成功','__decorate','appRole','split','AppCatsEntity','metadata','6446REIZFA','boolean','catInfo','appDes','getMany','delMineApp','preset','length','super','status','catId','findAndCount','updateApp','user','./app.entity','取消收藏成功!','coverImg','295072PGrqFc','appCatsEntity','删除应用成功！','223544spWRzy','catName','DESC','delete','18LFxNyw','AppEntity','system','log','460485UjXlKo','demoData','22gAXSvz','random','您正在操作一个不存在的资源！','appEntity','Like','MoreThan','应用审核拒绝完成','queryOneCat','50469OkQssN','mineApps','该应用名称已存在！','createApp','__metadata','322884TmJCkh','updateAppCats','delAppCat','design:paramtypes','1390BjzAfK','createGptsFromUser','修改成功','HttpStatus','缺失必要参数！','defineProperty','update','AppService','orderBy','slice','该分类名称已存在！','BAD_REQUEST','修改失败！','userAppsEntity','find','isGpts','object','customApp','当前应用已被下架或不存在！','function','__esModule','collect','gptsImg','appId','des','appList','Repository','已将应用加入到我的个人工作台！','./userApps.entity','getOwnPropertyDescriptor','frontAppList'];_0x4e57=function(){return _0x2f365e;};return _0x4e57();}function _0x4fa1(_0xe17d55,_0x415e4e){const _0x4e5736=_0x4e57();return _0x4fa1=function(_0x4fa129,_0x54ebfd){_0x4fa129=_0x4fa129-0xbe;let _0x3f4edd=_0x4e5736[_0x4fa129];return _0x3f4edd;},_0x4fa1(_0xe17d55,_0x415e4e);}var __decorate=this&&this[_0x218951(0xe5)]||function(_0x380b01,_0x71c556,_0x4142b9,_0x5335b8){const _0x566f7d=_0x218951;var _0x39f074=arguments[_0x566f7d(0xf1)],_0x544fcd=_0x39f074<0x3?_0x71c556:_0x5335b8===null?_0x5335b8=Object[_0x566f7d(0xc1)](_0x71c556,_0x4142b9):_0x5335b8,_0xd6b469;if(typeof Reflect===_0x566f7d(0x129)&&typeof Reflect[_0x566f7d(0xc4)]===_0x566f7d(0x12c))_0x544fcd=Reflect['decorate'](_0x380b01,_0x71c556,_0x4142b9,_0x5335b8);else{for(var _0x512e11=_0x380b01[_0x566f7d(0xf1)]-0x1;_0x512e11>=0x0;_0x512e11--)if(_0xd6b469=_0x380b01[_0x512e11])_0x544fcd=(_0x39f074<0x3?_0xd6b469(_0x544fcd):_0x39f074>0x3?_0xd6b469(_0x71c556,_0x4142b9,_0x544fcd):_0xd6b469(_0x71c556,_0x4142b9))||_0x544fcd;}return _0x39f074>0x3&&_0x544fcd&&Object['defineProperty'](_0x71c556,_0x4142b9,_0x544fcd),_0x544fcd;},__metadata=this&&this[_0x218951(0x114)]||function(_0x15647e,_0x51a844){const _0x2f07fb=_0x218951;if(typeof Reflect===_0x2f07fb(0x129)&&typeof Reflect[_0x2f07fb(0xe9)]==='function')return Reflect['metadata'](_0x15647e,_0x51a844);},__param=this&&this['__param']||function(_0x2a396f,_0x3abd95){return function(_0xc868da,_0x112cd0){_0x3abd95(_0xc868da,_0x112cd0,_0x2a396f);};};Object[_0x218951(0x11e)](exports,_0x218951(0x12d),{'value':!![]}),exports[_0x218951(0x120)]=void 0x0;const common_1=require('@nestjs/common'),appCats_entity_1=require(_0x218951(0xc5)),typeorm_1=require(_0x218951(0xd6)),typeorm_2=require(_0x218951(0xc9)),app_entity_1=require(_0x218951(0xf8)),userApps_entity_1=require(_0x218951(0xc0));let AppService=class AppService{constructor(_0x43bea9,_0x33c83b,_0xb42fdd){const _0x1137a2=_0x218951;this[_0x1137a2(0xfc)]=_0x43bea9,this[_0x1137a2(0x10b)]=_0x33c83b,this[_0x1137a2(0x126)]=_0xb42fdd;}async[_0x218951(0xca)](_0x18f7c5){const _0x58a9bf=_0x218951,{name:_0x540620}=_0x18f7c5,_0x5850b1=await this[_0x58a9bf(0xfc)][_0x58a9bf(0xcc)]({'where':{'name':_0x540620}});if(_0x5850b1)throw new common_1[(_0x58a9bf(0xd3))](_0x58a9bf(0x123),common_1[_0x58a9bf(0x11c)][_0x58a9bf(0x124)]);return await this[_0x58a9bf(0xfc)][_0x58a9bf(0xdf)](_0x18f7c5);}async[_0x218951(0x117)](_0x37fc28){const _0x33bb5a=_0x218951,{id:_0x344ddc}=_0x37fc28,_0x304e78=await this[_0x33bb5a(0xfc)][_0x33bb5a(0xcc)]({'where':{'id':_0x344ddc}});if(!_0x304e78)throw new common_1[(_0x33bb5a(0xd3))](_0x33bb5a(0xce),common_1[_0x33bb5a(0x11c)]['BAD_REQUEST']);const _0x2b0b02=await this[_0x33bb5a(0x10b)][_0x33bb5a(0xe0)]({'where':{'catId':_0x344ddc}});if(_0x2b0b02>0x0)throw new common_1['HttpException'](_0x33bb5a(0xc7),common_1['HttpStatus'][_0x33bb5a(0x124)]);const _0x4a4939=await this[_0x33bb5a(0xfc)]['delete'](_0x344ddc);if(_0x4a4939[_0x33bb5a(0xd5)]>0x0)return _0x33bb5a(0xe4);throw new common_1['HttpException']('删除失败！',common_1[_0x33bb5a(0x11c)][_0x33bb5a(0x124)]);}async[_0x218951(0x116)](_0x3a4a2b){const _0x2201c3=_0x218951,{id:_0x4b22a8,name:_0x579079}=_0x3a4a2b,_0xd30a8b=await this[_0x2201c3(0xfc)]['findOne']({'where':{'name':_0x579079,'id':(0x0,typeorm_1[_0x2201c3(0xde)])(_0x4b22a8)}});if(_0xd30a8b)throw new common_1[(_0x2201c3(0xd3))]('该分类名称已存在！',common_1[_0x2201c3(0x11c)][_0x2201c3(0x124)]);const _0x1e52bd=await this['appCatsEntity'][_0x2201c3(0x11f)]({'id':_0x4b22a8},_0x3a4a2b);if(_0x1e52bd['affected']>0x0)return _0x2201c3(0x11b);throw new common_1[(_0x2201c3(0xd3))](_0x2201c3(0x125),common_1[_0x2201c3(0x11c)][_0x2201c3(0x124)]);}async[_0x218951(0x10f)](_0x2806b2){const _0x52b76d=_0x218951,{id:_0x121ea9}=_0x2806b2;if(!_0x121ea9)throw new common_1['HttpException'](_0x52b76d(0x11d),common_1[_0x52b76d(0x11c)][_0x52b76d(0x124)]);const _0x223803=await this[_0x52b76d(0x10b)][_0x52b76d(0xcc)]({'where':{'id':_0x121ea9}});if(!_0x223803)throw new common_1[(_0x52b76d(0xd3))](_0x52b76d(0x12b),common_1['HttpStatus'][_0x52b76d(0x124)]);const {demoData:_0xb543bf,coverImg:_0x1801d5,gptsImg:_0x260ed5,des:_0xf1d49a,name:_0x47c813,modelTypeId:_0x27de78}=_0x223803;return{'demoData':_0xb543bf?_0xb543bf[_0x52b76d(0xe7)]('\x0a'):[],'coverImg':_0x1801d5||_0x260ed5,'des':_0xf1d49a,'name':_0x47c813,'modelTypeId':_0x27de78};}async[_0x218951(0x109)](){const _0x38479e=_0x218951,_0x3d95cb=await this[_0x38479e(0x10b)][_0x38479e(0xcb)]()[_0x38479e(0x121)](_0x38479e(0xd9))['limit'](0x9)[_0x38479e(0xee)](),_0x384177=[...new Set(_0x3d95cb['map'](_0x56384b=>_0x56384b[_0x38479e(0xf4)]))],_0x53dfe7=await this['appCatsEntity']['find']({'where':{'id':(0x0,typeorm_1['In'])(_0x384177)}});return _0x3d95cb[_0x38479e(0xd2)](_0x555303=>{const _0x3edbc2=_0x38479e;_0x555303[_0x3edbc2(0xfa)]=_0x555303[_0x3edbc2(0xfa)]||_0x555303['gptsImg'];const _0x43a3d1=_0x53dfe7[_0x3edbc2(0x127)](_0x523de0=>_0x523de0['id']===_0x555303[_0x3edbc2(0xf4)]);_0x555303[_0x3edbc2(0xec)]=_0x43a3d1;}),_0x3d95cb;}async['appCatsList'](_0xb9acb1){const _0x462389=_0x218951,{page:page=0x1,size:size=0xa,name:_0x27bd6c,status:_0x1923be}=_0xb9acb1,_0x3b98e7={};_0x27bd6c&&(_0x3b98e7['name']=(0x0,typeorm_1[_0x462389(0x10c)])('%'+_0x27bd6c+'%')),[0x0,0x1,'0','1']['includes'](_0x1923be)&&(_0x3b98e7[_0x462389(0xf3)]=_0x1923be);const [_0x58bc5e,_0x374d6c]=await this['appCatsEntity']['findAndCount']({'where':_0x3b98e7,'order':{'order':_0x462389(0x100)},'skip':(page-0x1)*size,'take':size}),_0x2d97b8=_0x58bc5e[_0x462389(0xcd)](_0x1f861e=>_0x1f861e['id']),_0x38c9ab=await this[_0x462389(0x10b)][_0x462389(0x127)]({'where':{'catId':(0x0,typeorm_1['In'])(_0x2d97b8)}}),_0x2a30a2={};return _0x38c9ab[_0x462389(0xd2)](_0x1fbf0f=>{const _0x167d88=_0x462389;_0x2a30a2[_0x1fbf0f['catId']]?_0x2a30a2[_0x1fbf0f[_0x167d88(0xf4)]]+=0x1:_0x2a30a2[_0x1fbf0f[_0x167d88(0xf4)]]=0x1;}),_0x58bc5e['forEach'](_0x264911=>_0x264911['appCount']=_0x2a30a2[_0x264911['id']]||0x0),{'rows':_0x58bc5e,'count':_0x374d6c};}async[_0x218951(0x132)](_0x307cc4,_0x472ced,_0x4be62f='id'){const _0x5f41ce=_0x218951;var _0x547958;const {page:page=0x1,size:size=0xa,name:_0x384184,status:_0x3d6faa,catId:_0x217df5,role:_0x510836,modelTypeId:_0x419e08,isGpts:_0x35f6e9}=_0x472ced,_0x4e6113={};_0x384184&&(_0x4e6113[_0x5f41ce(0xda)]=(0x0,typeorm_1[_0x5f41ce(0x10c)])('%'+_0x384184+'%')),_0x217df5&&(_0x4e6113['catId']=_0x217df5),_0x510836&&(_0x4e6113[_0x5f41ce(0xdd)]=_0x510836),_0x419e08&&(_0x4e6113['modelTypeId']=_0x419e08),_0x3d6faa&&(_0x4e6113['status']=_0x3d6faa);typeof _0x35f6e9===_0x5f41ce(0xeb)&&(_0x35f6e9&&(_0x4e6113[_0x5f41ce(0x128)]=_0x35f6e9));const [_0x55b12a,_0xb25397]=await this[_0x5f41ce(0x10b)]['findAndCount']({'where':_0x4e6113,'order':{[_0x4be62f]:_0x5f41ce(0x100)},'skip':(page-0x1)*size,'take':size}),_0x7fa9a9=_0x55b12a[_0x5f41ce(0xcd)](_0x10845d=>_0x10845d['catId']),_0x51e262=await this[_0x5f41ce(0xfc)][_0x5f41ce(0x127)]({'where':{'id':(0x0,typeorm_1['In'])(_0x7fa9a9)}});return _0x55b12a[_0x5f41ce(0xd2)](_0x474b72=>{const _0x2aad9c=_0x5f41ce,_0x57f066=_0x51e262[_0x2aad9c(0x127)](_0x30c71b=>_0x30c71b['id']===_0x474b72['catId']);_0x474b72[_0x2aad9c(0xfa)]=_0x474b72['coverImg']||_0x474b72['gptsImg'],_0x474b72[_0x2aad9c(0xff)]=_0x57f066?_0x57f066[_0x2aad9c(0xda)]:'',_0x474b72[_0x2aad9c(0xff)]=_0x57f066?_0x57f066['name']:'未分类';}),((_0x547958=_0x307cc4===null||_0x307cc4===void 0x0?void 0x0:_0x307cc4[_0x5f41ce(0xf7)])===null||_0x547958===void 0x0?void 0x0:_0x547958[_0x5f41ce(0xdd)])!==_0x5f41ce(0xf2)&&_0x55b12a[_0x5f41ce(0xd2)](_0x2de307=>{const _0xe7cefc=_0x5f41ce;delete _0x2de307[_0xe7cefc(0xf0)];}),{'rows':_0x55b12a,'count':_0xb25397};}async[_0x218951(0xc2)](_0x2c3474,_0x2f1fc6,_0x3364e6='id'){const _0x4604dd=_0x218951;var _0x2f39f6;try{const {page:page=0x1,size:size=0x3e8,name:_0x535399,catId:_0x2eba12,role:_0x5680ba}=_0x2f1fc6,_0x3a9872=[{'userId':(0x0,typeorm_1[_0x4604dd(0x10d)])(0x0),'public':!![],'status':0x5},{'role':_0x4604dd(0x104),'status':0x1}],[_0x5d23e3,_0x5288c0]=await this[_0x4604dd(0x10b)]['findAndCount']({'where':_0x3a9872,'order':{'order':'DESC'},'skip':(page-0x1)*size,'take':size}),_0x186b0f=_0x5d23e3[_0x4604dd(0xcd)](_0x1832c2=>_0x1832c2[_0x4604dd(0xf4)]),_0x5f4e2a=await this[_0x4604dd(0xfc)]['find']({'where':{'id':(0x0,typeorm_1['In'])(_0x186b0f)}});return _0x5d23e3['forEach'](_0x411cc7=>{const _0x329528=_0x5f4e2a['find'](_0xe29ba6=>_0xe29ba6['id']===_0x411cc7['catId']);_0x411cc7['catName']=_0x329528?_0x329528['name']:'';}),((_0x2f39f6=_0x2c3474===null||_0x2c3474===void 0x0?void 0x0:_0x2c3474[_0x4604dd(0xf7)])===null||_0x2f39f6===void 0x0?void 0x0:_0x2f39f6['role'])!=='super'&&_0x5d23e3[_0x4604dd(0xd2)](_0x2ded73=>{const _0x2ce992=_0x4604dd;delete _0x2ded73[_0x2ce992(0xf0)],_0x2ded73[_0x2ce992(0xfa)]=_0x2ded73[_0x2ce992(0xfa)]||_0x2ded73['gptsImg'];}),{'rows':_0x5d23e3,'count':_0x5288c0};}catch(_0x113a0e){console[_0x4604dd(0x105)](_0x4604dd(0xc8),_0x113a0e);}}async[_0x218951(0x113)](_0x415bd0){const _0x4499e5=_0x218951,{name:_0x12f34e,catId:_0x3f2293}=_0x415bd0;_0x415bd0[_0x4499e5(0xdd)]=_0x4499e5(0x104);const _0x2fb91c=await this[_0x4499e5(0x10b)][_0x4499e5(0xcc)]({'where':{'name':_0x12f34e}});if(_0x2fb91c)throw new common_1[(_0x4499e5(0xd3))](_0x4499e5(0x112),common_1[_0x4499e5(0x11c)][_0x4499e5(0x124)]);const _0x1813d2=await this[_0x4499e5(0xfc)]['findOne']({'where':{'id':_0x3f2293}});if(!_0x1813d2)throw new common_1[(_0x4499e5(0xd3))](_0x4499e5(0xce),common_1['HttpStatus'][_0x4499e5(0x124)]);try{return await this[_0x4499e5(0x10b)][_0x4499e5(0xdf)](_0x415bd0);}catch(_0x4b357b){console[_0x4499e5(0x105)](_0x4499e5(0xc8),_0x4b357b);throw new common_1[(_0x4499e5(0xd3))](_0x4b357b['message'],common_1['HttpStatus'][_0x4499e5(0x124)]);}}['removeEmoji'](_0x250fb4){const _0x277a5b=/[\u{1F600}-\u{1F64F}\u{1F300}-\u{1F5FF}\u{1F680}-\u{1F6FF}\u{1F700}-\u{1F77F}\u{1F780}-\u{1F7FF}\u{1F800}-\u{1F8FF}\u{1F900}-\u{1F9FF}\u{1FA00}-\u{1FA6F}\u{1FA70}-\u{1FAFF}\u{2600}-\u{26FF}\u{2700}-\u{27BF}\u{1F1E6}-\u{1F1FF}\u{1F191}-\u{1F251}\u{2B50}]+/gu;return _0x250fb4['replace'](_0x277a5b,'');}async[_0x218951(0x11a)](_0x110921,_0x53243e){const _0x584ec7=_0x218951,{gptsId:_0x579af0,coverImg:_0x13c495,name:_0x9735f,des:_0x336dac,demoData:_0x4e1c91}=_0x53243e,_0x53beb1=_0x110921[_0x584ec7(0xf7)]['id'],_0x305c4b=await this['appEntity'][_0x584ec7(0xcc)]({'where':{'gptsId':_0x579af0}});if(_0x305c4b)return _0x305c4b;const _0x2ae6b4={'catId':0x0,'name':this[_0x584ec7(0xdb)](_0x9735f),'des':this[_0x584ec7(0xdb)](_0x336dac)?this[_0x584ec7(0xdb)](_0x336dac)[_0x584ec7(0x122)](0x0,0xf8):'','demoData':_0x4e1c91,'status':0x5,'gptsImg':_0x13c495,'gptsId':_0x579af0,'userId':_0x53beb1,'public':!![],'role':_0x584ec7(0xf7),'isGpts':!![],'order':0x3e8};try{const _0x3e56e6=await this[_0x584ec7(0x10b)][_0x584ec7(0xdf)](_0x2ae6b4);return _0x3e56e6;}catch(_0x88b92d){console[_0x584ec7(0x105)](_0x584ec7(0xc8),_0x88b92d);throw new common_1[(_0x584ec7(0xd3))]('使用此应用失败！',common_1[_0x584ec7(0x11c)][_0x584ec7(0x124)]);}}async[_0x218951(0x12a)](_0x3bb74d,_0xc5f9a5){const _0x42c6d1=_0x218951,{id:_0x1d9615}=_0xc5f9a5[_0x42c6d1(0xf7)],{name:_0x554c18,catId:_0x37182c,des:_0xbaf434,preset:_0x31854a,coverImg:_0x5936d2,demoData:_0x4335c2,public:_0x30ce4f,appId:_0x36820e,modelTypeId:_0x5741ff}=_0x3bb74d;if(_0x36820e){const _0x4f6a07=await this[_0x42c6d1(0x10b)][_0x42c6d1(0xcc)]({'where':{'id':_0x36820e,'userId':_0x1d9615}});if(!_0x4f6a07)throw new common_1[(_0x42c6d1(0xd3))](_0x42c6d1(0xd1),common_1['HttpStatus'][_0x42c6d1(0x124)]);const _0x5a0779={'name':_0x554c18,'catId':_0x37182c,'des':_0xbaf434,'preset':_0x31854a,'coverImg':_0x5936d2,'demoData':_0x4335c2,'public':_0x30ce4f,'status':_0x30ce4f?0x3:0x1,'modelTypeId':_0x5741ff},_0x3fdd07=await this[_0x42c6d1(0x10b)][_0x42c6d1(0x11f)]({'id':_0x36820e,'userId':_0x1d9615},_0x5a0779);if(_0x3fdd07[_0x42c6d1(0xd5)])return _0x42c6d1(0x11b);else throw new common_1[(_0x42c6d1(0xd3))](_0x42c6d1(0x125),common_1[_0x42c6d1(0x11c)][_0x42c6d1(0x124)]);}if(!_0x36820e){const _0x151e7b=await this[_0x42c6d1(0xfc)][_0x42c6d1(0xcc)]({'where':{'id':_0x37182c}});if(!_0x151e7b)throw new common_1[(_0x42c6d1(0xd3))](_0x42c6d1(0xce),common_1[_0x42c6d1(0x11c)]['BAD_REQUEST']);const _0x20abc7=await this[_0x42c6d1(0x10b)][_0x42c6d1(0xcc)]({'where':{'name':_0x554c18}});if(_0x20abc7)throw new common_1[(_0x42c6d1(0xd3))](_0x42c6d1(0x112),common_1[_0x42c6d1(0x11c)]['BAD_REQUEST']);const _0x669d9e={'name':_0x554c18,'catId':_0x37182c,'des':_0xbaf434,'preset':_0x31854a,'coverImg':_0x5936d2,'status':_0x30ce4f?0x3:0x1,'demoData':_0x4335c2,'public':_0x30ce4f,'role':'user','userId':_0x1d9615},_0x1e07b6=await this['appEntity']['save'](_0x669d9e),_0xa51202={'appId':_0x1e07b6['id'],'userId':_0x1d9615,'appType':_0x42c6d1(0xf7),'public':_0x30ce4f,'status':_0x30ce4f?0x3:0x1,'catId':_0x37182c};return this[_0x42c6d1(0x126)][_0x42c6d1(0xdf)](_0xa51202);}}async[_0x218951(0xf6)](_0xf9f82f){const _0x37726e=_0x218951;try{const {id:_0x36c280,name:_0x1050c5,catId:_0x3f48fb,status:_0x3f0f72}=_0xf9f82f,_0x56f3c9=await this['appEntity'][_0x37726e(0xcc)]({'where':{'name':_0x1050c5,'id':(0x0,typeorm_1[_0x37726e(0xde)])(_0x36c280)}});if(_0x56f3c9)throw new common_1['HttpException'](_0x37726e(0x112),common_1[_0x37726e(0x11c)][_0x37726e(0x124)]);if(_0x3f48fb){const _0x131e46=await this['appCatsEntity']['findOne']({'where':{'id':_0x3f48fb}});if(!_0x131e46)throw new common_1[(_0x37726e(0xd3))]('该分类不存在！',common_1[_0x37726e(0x11c)][_0x37726e(0x124)]);}const _0xd21490=await this[_0x37726e(0x10b)][_0x37726e(0xcc)]({'where':{'id':_0x36c280}});_0xd21490[_0x37726e(0xf3)]!==_0xf9f82f[_0x37726e(0xf3)]&&await this[_0x37726e(0x126)][_0x37726e(0x11f)]({'appId':_0x36c280},{'status':_0x3f0f72});_0xf9f82f[_0x37726e(0x12f)]=_0xf9f82f[_0x37726e(0xfa)],_0xf9f82f[_0x37726e(0xfa)]=_0xd21490===null||_0xd21490===void 0x0?void 0x0:_0xd21490[_0x37726e(0xfa)];const _0x1f2bd2=await this[_0x37726e(0x10b)][_0x37726e(0x11f)]({'id':_0x36c280},_0xf9f82f);if(_0x1f2bd2[_0x37726e(0xd5)]>0x0)return _0x37726e(0xcf);throw new common_1['HttpException'](_0x37726e(0xd0),common_1['HttpStatus'][_0x37726e(0x124)]);}catch(_0x4511c8){console[_0x37726e(0x105)](_0x37726e(0xc8),_0x4511c8);throw new common_1[(_0x37726e(0xd3))](_0x37726e(0xd0),common_1[_0x37726e(0x11c)][_0x37726e(0x124)]);}}async['delApp'](_0x221200){const _0x516aef=_0x218951,{id:_0x1afa3b}=_0x221200,_0x5799fe=await this['appEntity'][_0x516aef(0xcc)]({'where':{'id':_0x1afa3b}});if(!_0x5799fe)throw new common_1[(_0x516aef(0xd3))](_0x516aef(0xd7),common_1[_0x516aef(0x11c)][_0x516aef(0x124)]);const _0x5c973a=await this[_0x516aef(0x126)][_0x516aef(0x127)]({'where':{'appId':_0x1afa3b}}),_0x43dbbe=_0x5c973a[_0x516aef(0xcd)](_0x13c3a3=>_0x13c3a3['id']);_0x5c973a[_0x516aef(0xf1)]&&await this[_0x516aef(0x126)][_0x516aef(0x101)]({'id':(0x0,typeorm_1['In'])(_0x43dbbe)});const _0x43af25=await this[_0x516aef(0x10b)][_0x516aef(0x101)](_0x1afa3b);if(_0x43af25[_0x516aef(0xd5)]>0x0)return _0x516aef(0xe2);throw new common_1[(_0x516aef(0xd3))](_0x516aef(0xd8),common_1[_0x516aef(0x11c)][_0x516aef(0x124)]);}async[_0x218951(0xd4)](_0x26d7e2){const _0x154ab0=_0x218951,{id:_0xc98b57}=_0x26d7e2,_0x10063f=await this['appEntity'][_0x154ab0(0xcc)]({'where':{'id':_0xc98b57,'status':0x3}});if(!_0x10063f)throw new common_1[(_0x154ab0(0xd3))]('该应用不存在！',common_1[_0x154ab0(0x11c)][_0x154ab0(0x124)]);return await this[_0x154ab0(0x10b)][_0x154ab0(0x11f)]({'id':_0xc98b57},{'status':0x5}),await this['userAppsEntity'][_0x154ab0(0x11f)]({'appId':_0xc98b57},{'status':0x5}),'应用审核通过';}async[_0x218951(0xdc)](_0x4cd45e){const _0x765c0c=_0x218951,{id:_0x298dcc}=_0x4cd45e,_0x3f1109=await this['appEntity'][_0x765c0c(0xcc)]({'where':{'id':_0x298dcc,'status':0x3}});if(!_0x3f1109)throw new common_1[(_0x765c0c(0xd3))](_0x765c0c(0xd7),common_1[_0x765c0c(0x11c)][_0x765c0c(0x124)]);return await this['appEntity'][_0x765c0c(0x11f)]({'id':_0x298dcc},{'status':0x4}),await this[_0x765c0c(0x126)]['update']({'appId':_0x298dcc},{'status':0x4}),_0x765c0c(0x10e);}async[_0x218951(0xef)](_0x32e483,_0x3a6379){const _0x53973d=_0x218951,{id:_0x895033}=_0x32e483,_0x4e4a1c=await this[_0x53973d(0x10b)][_0x53973d(0xcc)]({'where':{'id':_0x895033,'userId':_0x3a6379[_0x53973d(0xf7)]['id']}});if(!_0x4e4a1c)throw new common_1[(_0x53973d(0xd3))](_0x53973d(0x10a),common_1[_0x53973d(0x11c)][_0x53973d(0x124)]);return await this['appEntity'][_0x53973d(0x101)](_0x895033),await this[_0x53973d(0x126)][_0x53973d(0x101)]({'appId':_0x895033,'userId':_0x3a6379['user']['id']}),_0x53973d(0xfd);}async[_0x218951(0x12e)](_0x206b4c,_0x34355d){const _0x282a5=_0x218951,{appId:_0x45e776}=_0x206b4c,{id:_0x49ea03}=_0x34355d['user'],_0x411230=await this[_0x282a5(0x126)]['findOne']({'where':{'appId':_0x45e776,'userId':_0x49ea03}});if(_0x411230){const _0x55d4f7=await this[_0x282a5(0x126)]['delete']({'appId':_0x45e776,'userId':_0x49ea03});if(_0x55d4f7[_0x282a5(0xd5)]>0x0)return _0x282a5(0xf9);else throw new common_1[(_0x282a5(0xd3))]('取消收藏失败！',common_1[_0x282a5(0x11c)][_0x282a5(0x124)]);}const _0x3b55c7=await this[_0x282a5(0x10b)][_0x282a5(0xcc)]({'where':{'id':_0x45e776}}),{id:_0x108a9d,role:_0x30efd8,catId:_0x3c57f5}=_0x3b55c7,_0x56396c={'userId':_0x49ea03,'appId':_0x108a9d,'catId':_0x3c57f5,'appRole':_0x30efd8,'public':!![],'status':0x1};return await this[_0x282a5(0x126)]['save'](_0x56396c),_0x282a5(0xbf);}async[_0x218951(0x111)](_0x1b213d,_0x499dd1={'page':0x1,'size':0x1e}){const _0x540eba=_0x218951,{id:_0x7363a7}=_0x1b213d['user'],{page:page=0x1,size:size=0x1e}=_0x499dd1,[_0x372e17,_0x39b37c]=await this['userAppsEntity'][_0x540eba(0xf5)]({'where':{'userId':_0x7363a7,'status':(0x0,typeorm_1['In'])([0x1,0x3,0x4,0x5])},'order':{'id':'DESC'},'skip':(page-0x1)*size,'take':size}),_0x3c8b40=_0x372e17[_0x540eba(0xcd)](_0x257049=>_0x257049[_0x540eba(0x130)]),_0x2a514d=await this[_0x540eba(0x10b)][_0x540eba(0x127)]({'where':{'id':(0x0,typeorm_1['In'])(_0x3c8b40)}});return _0x372e17['forEach'](_0x28f974=>{const _0x2007aa=_0x540eba,_0x19afb9=_0x2a514d['find'](_0x28aaa3=>_0x28aaa3['id']===_0x28f974[_0x2007aa(0x130)]);_0x28f974['appName']=_0x19afb9?_0x19afb9[_0x2007aa(0xda)]:'',_0x28f974[_0x2007aa(0xe6)]=_0x19afb9?_0x19afb9[_0x2007aa(0xdd)]:'',_0x28f974[_0x2007aa(0xed)]=_0x19afb9?_0x19afb9[_0x2007aa(0x131)]:'',_0x28f974[_0x2007aa(0xfa)]=_0x19afb9?_0x19afb9[_0x2007aa(0xfa)]||_0x19afb9[_0x2007aa(0x12f)]:'',_0x28f974[_0x2007aa(0x107)]=_0x19afb9?_0x19afb9[_0x2007aa(0x107)]:'',_0x28f974['preset']=(_0x19afb9===null||_0x19afb9===void 0x0?void 0x0:_0x19afb9['userId'])===_0x7363a7?_0x19afb9===null||_0x19afb9===void 0x0?void 0x0:_0x19afb9['preset']:'******';}),{'rows':_0x372e17,'count':_0x39b37c};}};AppService=__decorate([(0x0,common_1['Injectable'])(),__param(0x0,(0x0,typeorm_2['InjectRepository'])(appCats_entity_1[_0x218951(0xe8)])),__param(0x1,(0x0,typeorm_2['InjectRepository'])(app_entity_1[_0x218951(0x103)])),__param(0x2,(0x0,typeorm_2[_0x218951(0xe3)])(userApps_entity_1[_0x218951(0xc3)])),__metadata(_0x218951(0x118),[typeorm_1['Repository'],typeorm_1['Repository'],typeorm_1[_0x218951(0xbe)]])],AppService),exports[_0x218951(0x120)]=AppService;