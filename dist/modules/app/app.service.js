'use strict';const _0x10b39e=_0x45b4;(function(_0x1ebfca,_0x51278e){const _0x3bc420=_0x45b4,_0x4406f9=_0x1ebfca();while(!![]){try{const _0x5317eb=parseInt(_0x3bc420(0xaf))/0x1+-parseInt(_0x3bc420(0xa4))/0x2+parseInt(_0x3bc420(0xcc))/0x3+-parseInt(_0x3bc420(0xcd))/0x4+-parseInt(_0x3bc420(0xa6))/0x5*(-parseInt(_0x3bc420(0xad))/0x6)+-parseInt(_0x3bc420(0x97))/0x7*(parseInt(_0x3bc420(0x7e))/0x8)+-parseInt(_0x3bc420(0xa5))/0x9;if(_0x5317eb===_0x51278e)break;else _0x4406f9['push'](_0x4406f9['shift']());}catch(_0x2043c6){_0x4406f9['push'](_0x4406f9['shift']());}}}(_0x5abc,0x3fbfb));var __decorate=this&&this[_0x10b39e(0x7d)]||function(_0xadf799,_0x2f938c,_0x128c48,_0x1b0a03){const _0x486825=_0x10b39e;var _0x21350d=arguments['length'],_0x5f3eaf=_0x21350d<0x3?_0x2f938c:_0x1b0a03===null?_0x1b0a03=Object['getOwnPropertyDescriptor'](_0x2f938c,_0x128c48):_0x1b0a03,_0x4be2c8;if(typeof Reflect===_0x486825(0x7f)&&typeof Reflect['decorate']===_0x486825(0x76))_0x5f3eaf=Reflect[_0x486825(0xa1)](_0xadf799,_0x2f938c,_0x128c48,_0x1b0a03);else{for(var _0x281fb0=_0xadf799[_0x486825(0x94)]-0x1;_0x281fb0>=0x0;_0x281fb0--)if(_0x4be2c8=_0xadf799[_0x281fb0])_0x5f3eaf=(_0x21350d<0x3?_0x4be2c8(_0x5f3eaf):_0x21350d>0x3?_0x4be2c8(_0x2f938c,_0x128c48,_0x5f3eaf):_0x4be2c8(_0x2f938c,_0x128c48))||_0x5f3eaf;}return _0x21350d>0x3&&_0x5f3eaf&&Object['defineProperty'](_0x2f938c,_0x128c48,_0x5f3eaf),_0x5f3eaf;},__metadata=this&&this[_0x10b39e(0xd6)]||function(_0x53822e,_0x383c8b){const _0x3319e3=_0x10b39e;if(typeof Reflect==='object'&&typeof Reflect[_0x3319e3(0xa9)]===_0x3319e3(0x76))return Reflect['metadata'](_0x53822e,_0x383c8b);},__param=this&&this[_0x10b39e(0xd7)]||function(_0x5021cb,_0x19c59d){return function(_0x534423,_0x634f0d){_0x19c59d(_0x534423,_0x634f0d,_0x5021cb);};};function _0x5abc(){const _0x221f38=['forEach','186VTpkDB','修改成功','374593iVJnuf','Like','slice','@nestjs/common','name','delApp','appDes','HttpException','catId','删除App成功','gptsImg','updateAppCats','./app.entity','orderBy','findOne','appName','appList','coverImg','已将应用加入到我的个人工作台！','修改App信息失败！','super','system','该分类名称已存在！','catName','appId','des','UserAppsEntity','queryOneCat','delMineApp','1363233vehIja','2016112vIIMLq','createQueryBuilder','删除失败！','取消收藏成功!','typeorm','split','log','appRole','find','__metadata','__param','catInfo','findAndCount','./userApps.entity','该应用名称已存在！','AppService','preset','Injectable','createApp','BAD_REQUEST','userId','HttpStatus','删除App失败！','role','AppEntity','getMany','delete','function','userAppsEntity','replace','修改失败！','./appCats.entity','RAND()','map','__decorate','8WJjlPZ','object','该分类不存在！','使用此应用失败！','user','Not','count','应用审核通过','MoreThan','DESC','@nestjs/typeorm','affected','appCatsList','design:paramtypes','random','缺失必要参数！','未分类','取消收藏失败！','error:\x20','collect','appCatsEntity','auditPass','length','InjectRepository','该应用不存在！','1026522SyRxyx','删除成功','updateApp','save','status','createGptsFromUser','update','boolean','appEntity','defineProperty','decorate','Repository','delAppCat','540874NcesNI','1495089yWESmG','83765pAvvue','includes','您正在编辑一个不存在的应用！','metadata','frontAppList','limit'];_0x5abc=function(){return _0x221f38;};return _0x5abc();}Object[_0x10b39e(0xa0)](exports,'__esModule',{'value':!![]}),exports['AppService']=void 0x0;function _0x45b4(_0x28919d,_0x58c474){const _0x5abc4d=_0x5abc();return _0x45b4=function(_0x45b427,_0x614166){_0x45b427=_0x45b427-0x6f;let _0x69b619=_0x5abc4d[_0x45b427];return _0x69b619;},_0x45b4(_0x28919d,_0x58c474);}const common_1=require(_0x10b39e(0xb2)),appCats_entity_1=require(_0x10b39e(0x7a)),typeorm_1=require(_0x10b39e(0xd1)),typeorm_2=require(_0x10b39e(0x88)),app_entity_1=require(_0x10b39e(0xbb)),userApps_entity_1=require(_0x10b39e(0xda));let AppService=class AppService{constructor(_0x25f2dc,_0x2eadc6,_0x2a1f66){const _0x4835c0=_0x10b39e;this[_0x4835c0(0x92)]=_0x25f2dc,this['appEntity']=_0x2eadc6,this[_0x4835c0(0x77)]=_0x2a1f66;}async['createAppCat'](_0x209f71){const _0x159db9=_0x10b39e,{name:_0xb34d73}=_0x209f71,_0x2cb837=await this[_0x159db9(0x92)]['findOne']({'where':{'name':_0xb34d73}});if(_0x2cb837)throw new common_1[(_0x159db9(0xb6))](_0x159db9(0xc5),common_1[_0x159db9(0x70)][_0x159db9(0xe0)]);return await this[_0x159db9(0x92)][_0x159db9(0x9a)](_0x209f71);}async[_0x10b39e(0xa3)](_0x205fcb){const _0x15a60e=_0x10b39e,{id:_0x5d03af}=_0x205fcb,_0x186014=await this['appCatsEntity'][_0x15a60e(0xbd)]({'where':{'id':_0x5d03af}});if(!_0x186014)throw new common_1[(_0x15a60e(0xb6))](_0x15a60e(0x80),common_1['HttpStatus'][_0x15a60e(0xe0)]);const _0x3e966e=await this[_0x15a60e(0x9f)][_0x15a60e(0x84)]({'where':{'catId':_0x5d03af}});if(_0x3e966e>0x0)throw new common_1[(_0x15a60e(0xb6))]('该分类下存在App，不可删除！',common_1[_0x15a60e(0x70)][_0x15a60e(0xe0)]);const _0x5a9ba9=await this[_0x15a60e(0x92)][_0x15a60e(0x75)](_0x5d03af);if(_0x5a9ba9[_0x15a60e(0x89)]>0x0)return _0x15a60e(0x98);throw new common_1[(_0x15a60e(0xb6))](_0x15a60e(0xcf),common_1['HttpStatus'][_0x15a60e(0xe0)]);}async[_0x10b39e(0xba)](_0x4dc0f1){const _0x5d8f08=_0x10b39e,{id:_0x1b7da2,name:_0x10efe9}=_0x4dc0f1,_0x3ca22b=await this[_0x5d8f08(0x92)]['findOne']({'where':{'name':_0x10efe9,'id':(0x0,typeorm_1['Not'])(_0x1b7da2)}});if(_0x3ca22b)throw new common_1[(_0x5d8f08(0xb6))](_0x5d8f08(0xc5),common_1['HttpStatus'][_0x5d8f08(0xe0)]);const _0x5671d6=await this[_0x5d8f08(0x92)][_0x5d8f08(0x9d)]({'id':_0x1b7da2},_0x4dc0f1);if(_0x5671d6['affected']>0x0)return _0x5d8f08(0xae);throw new common_1[(_0x5d8f08(0xb6))](_0x5d8f08(0x79),common_1[_0x5d8f08(0x70)][_0x5d8f08(0xe0)]);}async[_0x10b39e(0xca)](_0x140442){const _0xd8c0bf=_0x10b39e,{id:_0x1daeec}=_0x140442;if(!_0x1daeec)throw new common_1[(_0xd8c0bf(0xb6))](_0xd8c0bf(0x8d),common_1[_0xd8c0bf(0x70)][_0xd8c0bf(0xe0)]);const _0x5a9b4b=await this[_0xd8c0bf(0x9f)][_0xd8c0bf(0xbd)]({'where':{'id':_0x1daeec}});if(!_0x5a9b4b)throw new common_1[(_0xd8c0bf(0xb6))]('当前应用已被下架或不存在！',common_1[_0xd8c0bf(0x70)]['BAD_REQUEST']);const {demoData:_0x2ca2d1,coverImg:_0x4df3f6,gptsImg:_0x5bffa4,des:_0x2a09d9,name:_0x4a65a2,modelTypeId:_0x1ddc78}=_0x5a9b4b;return{'demoData':_0x2ca2d1?_0x2ca2d1[_0xd8c0bf(0xd2)]('\x0a'):[],'coverImg':_0x4df3f6||_0x5bffa4,'des':_0x2a09d9,'name':_0x4a65a2,'modelTypeId':_0x1ddc78};}async[_0x10b39e(0x8c)](){const _0x50a237=_0x10b39e,_0x738e5a=await this[_0x50a237(0x9f)][_0x50a237(0xce)]()[_0x50a237(0xbc)](_0x50a237(0x7b))[_0x50a237(0xab)](0x9)[_0x50a237(0x74)](),_0x58b13c=[...new Set(_0x738e5a[_0x50a237(0x7c)](_0x53b16d=>_0x53b16d[_0x50a237(0xb7)]))],_0x70a1ec=await this[_0x50a237(0x92)][_0x50a237(0xd5)]({'where':{'id':(0x0,typeorm_1['In'])(_0x58b13c)}});return _0x738e5a[_0x50a237(0xac)](_0x1600a6=>{const _0x373778=_0x50a237;_0x1600a6[_0x373778(0xc0)]=_0x1600a6[_0x373778(0xc0)]||_0x1600a6[_0x373778(0xb9)];const _0x245657=_0x70a1ec[_0x373778(0xd5)](_0x24a8a2=>_0x24a8a2['id']===_0x1600a6[_0x373778(0xb7)]);_0x1600a6[_0x373778(0xd8)]=_0x245657;}),_0x738e5a;}async[_0x10b39e(0x8a)](_0x5349d2){const _0x447ede=_0x10b39e,{page:page=0x1,size:size=0xa,name:_0x1b68a3,status:_0x5683b2}=_0x5349d2,_0x558bf5={};_0x1b68a3&&(_0x558bf5[_0x447ede(0xb3)]=(0x0,typeorm_1[_0x447ede(0xb0)])('%'+_0x1b68a3+'%')),[0x0,0x1,'0','1'][_0x447ede(0xa7)](_0x5683b2)&&(_0x558bf5[_0x447ede(0x9b)]=_0x5683b2);const [_0xb1d5fa,_0x114245]=await this['appCatsEntity'][_0x447ede(0xd9)]({'where':_0x558bf5,'order':{'order':_0x447ede(0x87)},'skip':(page-0x1)*size,'take':size}),_0x41eae4=_0xb1d5fa[_0x447ede(0x7c)](_0x24b9a8=>_0x24b9a8['id']),_0x2e8127=await this[_0x447ede(0x9f)][_0x447ede(0xd5)]({'where':{'catId':(0x0,typeorm_1['In'])(_0x41eae4)}}),_0x9ab5aa={};return _0x2e8127[_0x447ede(0xac)](_0x585401=>{_0x9ab5aa[_0x585401['catId']]?_0x9ab5aa[_0x585401['catId']]+=0x1:_0x9ab5aa[_0x585401['catId']]=0x1;}),_0xb1d5fa[_0x447ede(0xac)](_0x3d76f7=>_0x3d76f7['appCount']=_0x9ab5aa[_0x3d76f7['id']]||0x0),{'rows':_0xb1d5fa,'count':_0x114245};}async[_0x10b39e(0xbf)](_0xd1ccbc,_0x43811d,_0x51d58e='id'){const _0x525dd4=_0x10b39e;var _0x52923d;const {page:page=0x1,size:size=0xa,name:_0x2dc03d,status:_0x2bbdfc,catId:_0xb269e2,role:_0x1073b9,modelTypeId:_0x46800f,isGpts:_0x20bad5}=_0x43811d,_0x3df106={};_0x2dc03d&&(_0x3df106[_0x525dd4(0xb3)]=(0x0,typeorm_1[_0x525dd4(0xb0)])('%'+_0x2dc03d+'%')),_0xb269e2&&(_0x3df106[_0x525dd4(0xb7)]=_0xb269e2),_0x1073b9&&(_0x3df106[_0x525dd4(0x72)]=_0x1073b9),_0x46800f&&(_0x3df106['modelTypeId']=_0x46800f),_0x2bbdfc&&(_0x3df106[_0x525dd4(0x9b)]=_0x2bbdfc);typeof _0x20bad5===_0x525dd4(0x9e)&&(_0x20bad5&&(_0x3df106['isGpts']=_0x20bad5));const [_0x204143,_0x4e1e69]=await this[_0x525dd4(0x9f)][_0x525dd4(0xd9)]({'where':_0x3df106,'order':{[_0x51d58e]:'DESC'},'skip':(page-0x1)*size,'take':size}),_0x44d0c6=_0x204143['map'](_0x582bf3=>_0x582bf3[_0x525dd4(0xb7)]),_0x4752d7=await this['appCatsEntity'][_0x525dd4(0xd5)]({'where':{'id':(0x0,typeorm_1['In'])(_0x44d0c6)}});return _0x204143[_0x525dd4(0xac)](_0x2cf5e7=>{const _0x5cb72a=_0x525dd4,_0x2bba70=_0x4752d7[_0x5cb72a(0xd5)](_0x4f4345=>_0x4f4345['id']===_0x2cf5e7[_0x5cb72a(0xb7)]);_0x2cf5e7[_0x5cb72a(0xc0)]=_0x2cf5e7[_0x5cb72a(0xc0)]||_0x2cf5e7[_0x5cb72a(0xb9)],_0x2cf5e7[_0x5cb72a(0xc6)]=_0x2bba70?_0x2bba70[_0x5cb72a(0xb3)]:'',_0x2cf5e7[_0x5cb72a(0xc6)]=_0x2bba70?_0x2bba70[_0x5cb72a(0xb3)]:_0x5cb72a(0x8e);}),((_0x52923d=_0xd1ccbc===null||_0xd1ccbc===void 0x0?void 0x0:_0xd1ccbc[_0x525dd4(0x82)])===null||_0x52923d===void 0x0?void 0x0:_0x52923d[_0x525dd4(0x72)])!==_0x525dd4(0xc3)&&_0x204143[_0x525dd4(0xac)](_0x46f487=>{const _0x251bac=_0x525dd4;delete _0x46f487[_0x251bac(0xdd)];}),{'rows':_0x204143,'count':_0x4e1e69};}async[_0x10b39e(0xaa)](_0x266d8b,_0x13aea3,_0x46921e='id'){const _0x52ef0a=_0x10b39e;var _0x1ab8bc;try{const {page:page=0x1,size:size=0x3e8,name:_0x4e54f5,catId:_0x560908,role:_0x18a4e1}=_0x13aea3,_0x4da7d=[{'userId':(0x0,typeorm_1[_0x52ef0a(0x86)])(0x0),'public':!![],'status':0x5},{'role':_0x52ef0a(0xc4),'status':0x1}],[_0x16a5b6,_0x4be440]=await this['appEntity']['findAndCount']({'where':_0x4da7d,'order':{'order':_0x52ef0a(0x87)},'skip':(page-0x1)*size,'take':size}),_0xfc4ee8=_0x16a5b6[_0x52ef0a(0x7c)](_0x380df6=>_0x380df6['catId']),_0x1868a8=await this[_0x52ef0a(0x92)][_0x52ef0a(0xd5)]({'where':{'id':(0x0,typeorm_1['In'])(_0xfc4ee8)}});return _0x16a5b6['forEach'](_0x30137f=>{const _0x57c8db=_0x52ef0a,_0x3d86fd=_0x1868a8[_0x57c8db(0xd5)](_0x2b7a50=>_0x2b7a50['id']===_0x30137f[_0x57c8db(0xb7)]);_0x30137f['catName']=_0x3d86fd?_0x3d86fd[_0x57c8db(0xb3)]:'';}),((_0x1ab8bc=_0x266d8b===null||_0x266d8b===void 0x0?void 0x0:_0x266d8b[_0x52ef0a(0x82)])===null||_0x1ab8bc===void 0x0?void 0x0:_0x1ab8bc['role'])!==_0x52ef0a(0xc3)&&_0x16a5b6[_0x52ef0a(0xac)](_0x5920a1=>{const _0x4be6f6=_0x52ef0a;delete _0x5920a1[_0x4be6f6(0xdd)],_0x5920a1['coverImg']=_0x5920a1[_0x4be6f6(0xc0)]||_0x5920a1[_0x4be6f6(0xb9)];}),{'rows':_0x16a5b6,'count':_0x4be440};}catch(_0x43430e){console[_0x52ef0a(0xd3)](_0x52ef0a(0x90),_0x43430e);}}async[_0x10b39e(0xdf)](_0x5476bd){const _0x4cdb20=_0x10b39e,{name:_0x5af34a,catId:_0x3f598d}=_0x5476bd;_0x5476bd[_0x4cdb20(0x72)]=_0x4cdb20(0xc4);const _0x1d5c6f=await this[_0x4cdb20(0x9f)]['findOne']({'where':{'name':_0x5af34a}});if(_0x1d5c6f)throw new common_1['HttpException'](_0x4cdb20(0xdb),common_1[_0x4cdb20(0x70)]['BAD_REQUEST']);const _0x3aceb9=await this[_0x4cdb20(0x92)][_0x4cdb20(0xbd)]({'where':{'id':_0x3f598d}});if(!_0x3aceb9)throw new common_1['HttpException'](_0x4cdb20(0x80),common_1['HttpStatus']['BAD_REQUEST']);try{return await this[_0x4cdb20(0x9f)][_0x4cdb20(0x9a)](_0x5476bd);}catch(_0x8545c3){console[_0x4cdb20(0xd3)](_0x4cdb20(0x90),_0x8545c3);throw new common_1[(_0x4cdb20(0xb6))](_0x8545c3['message'],common_1[_0x4cdb20(0x70)][_0x4cdb20(0xe0)]);}}['removeEmoji'](_0x5b70c4){const _0x4dbfb8=_0x10b39e,_0x4fe223=/[\u{1F600}-\u{1F64F}\u{1F300}-\u{1F5FF}\u{1F680}-\u{1F6FF}\u{1F700}-\u{1F77F}\u{1F780}-\u{1F7FF}\u{1F800}-\u{1F8FF}\u{1F900}-\u{1F9FF}\u{1FA00}-\u{1FA6F}\u{1FA70}-\u{1FAFF}\u{2600}-\u{26FF}\u{2700}-\u{27BF}\u{1F1E6}-\u{1F1FF}\u{1F191}-\u{1F251}\u{2B50}]+/gu;return _0x5b70c4[_0x4dbfb8(0x78)](_0x4fe223,'');}async[_0x10b39e(0x9c)](_0x5a226e,_0x32f54c){const _0x3a2e36=_0x10b39e,{gptsId:_0x2d4d95,coverImg:_0x272c06,name:_0x33faad,des:_0x117314,demoData:_0x3e4ea5}=_0x32f54c,_0x4085d0=_0x5a226e[_0x3a2e36(0x82)]['id'],_0x581730=await this[_0x3a2e36(0x9f)][_0x3a2e36(0xbd)]({'where':{'gptsId':_0x2d4d95}});if(_0x581730)return _0x581730;const _0x344cad={'catId':0x0,'name':_0x33faad,'des':_0x117314?_0x117314[_0x3a2e36(0xb1)](0x0,0xf8):'','demoData':_0x3e4ea5,'status':0x5,'gptsImg':_0x272c06,'gptsId':_0x2d4d95,'userId':_0x4085d0,'public':!![],'role':_0x3a2e36(0x82),'isGpts':!![],'order':0x3e8};try{const _0xa8cba=await this[_0x3a2e36(0x9f)]['save'](_0x344cad);return _0xa8cba;}catch(_0x2ef038){console[_0x3a2e36(0xd3)](_0x3a2e36(0x90),_0x2ef038);throw new common_1[(_0x3a2e36(0xb6))](_0x3a2e36(0x81),common_1[_0x3a2e36(0x70)][_0x3a2e36(0xe0)]);}}async['customApp'](_0x4c8f54,_0x5e52e0){const _0x25ada7=_0x10b39e,{id:_0x440e85}=_0x5e52e0['user'],{name:_0x45ef7f,catId:_0x1c9118,des:_0xf0b40b,preset:_0x2fa4f9,coverImg:_0x4fe0f5,demoData:_0x26c360,public:_0x4626c5,appId:_0x362185,modelTypeId:_0x282a5a}=_0x4c8f54;if(_0x362185){const _0x55aacb=await this[_0x25ada7(0x9f)][_0x25ada7(0xbd)]({'where':{'id':_0x362185,'userId':_0x440e85}});if(!_0x55aacb)throw new common_1[(_0x25ada7(0xb6))](_0x25ada7(0xa8),common_1[_0x25ada7(0x70)][_0x25ada7(0xe0)]);const _0x19e49f={'name':_0x45ef7f,'catId':_0x1c9118,'des':_0xf0b40b,'preset':_0x2fa4f9,'coverImg':_0x4fe0f5,'demoData':_0x26c360,'public':_0x4626c5,'status':_0x4626c5?0x3:0x1,'modelTypeId':_0x282a5a},_0x169a2d=await this[_0x25ada7(0x9f)][_0x25ada7(0x9d)]({'id':_0x362185,'userId':_0x440e85},_0x19e49f);if(_0x169a2d[_0x25ada7(0x89)])return _0x25ada7(0xae);else throw new common_1['HttpException'](_0x25ada7(0x79),common_1[_0x25ada7(0x70)][_0x25ada7(0xe0)]);}if(!_0x362185){const _0x4b1719=await this['appCatsEntity'][_0x25ada7(0xbd)]({'where':{'id':_0x1c9118}});if(!_0x4b1719)throw new common_1[(_0x25ada7(0xb6))](_0x25ada7(0x80),common_1['HttpStatus'][_0x25ada7(0xe0)]);const _0x597766=await this['appEntity'][_0x25ada7(0xbd)]({'where':{'name':_0x45ef7f}});if(_0x597766)throw new common_1['HttpException'](_0x25ada7(0xdb),common_1[_0x25ada7(0x70)][_0x25ada7(0xe0)]);const _0x4f2918={'name':_0x45ef7f,'catId':_0x1c9118,'des':_0xf0b40b,'preset':_0x2fa4f9,'coverImg':_0x4fe0f5,'status':_0x4626c5?0x3:0x1,'demoData':_0x26c360,'public':_0x4626c5,'role':_0x25ada7(0x82),'userId':_0x440e85},_0x140884=await this[_0x25ada7(0x9f)][_0x25ada7(0x9a)](_0x4f2918),_0x46077a={'appId':_0x140884['id'],'userId':_0x440e85,'appType':_0x25ada7(0x82),'public':_0x4626c5,'status':_0x4626c5?0x3:0x1,'catId':_0x1c9118};return this[_0x25ada7(0x77)][_0x25ada7(0x9a)](_0x46077a);}}async[_0x10b39e(0x99)](_0x465c63){const _0x3cb901=_0x10b39e;try{const {id:_0x3e61ff,name:_0x1a1618,catId:_0x27cdcc,status:_0x2187b0}=_0x465c63,_0x3f4543=await this['appEntity'][_0x3cb901(0xbd)]({'where':{'name':_0x1a1618,'id':(0x0,typeorm_1[_0x3cb901(0x83)])(_0x3e61ff)}});if(_0x3f4543)throw new common_1['HttpException'](_0x3cb901(0xdb),common_1[_0x3cb901(0x70)]['BAD_REQUEST']);if(_0x27cdcc){const _0xf44ebb=await this['appCatsEntity'][_0x3cb901(0xbd)]({'where':{'id':_0x27cdcc}});if(!_0xf44ebb)throw new common_1[(_0x3cb901(0xb6))](_0x3cb901(0x80),common_1[_0x3cb901(0x70)][_0x3cb901(0xe0)]);}const _0x4650c6=await this['appEntity'][_0x3cb901(0xbd)]({'where':{'id':_0x3e61ff}});_0x4650c6['status']!==_0x465c63[_0x3cb901(0x9b)]&&await this[_0x3cb901(0x77)][_0x3cb901(0x9d)]({'appId':_0x3e61ff},{'status':_0x2187b0});_0x465c63['gptsImg']=_0x465c63[_0x3cb901(0xc0)],_0x465c63['coverImg']=_0x4650c6===null||_0x4650c6===void 0x0?void 0x0:_0x4650c6[_0x3cb901(0xc0)];const _0x3ef47d=await this[_0x3cb901(0x9f)]['update']({'id':_0x3e61ff},_0x465c63);if(_0x3ef47d['affected']>0x0)return'修改App信息成功';throw new common_1[(_0x3cb901(0xb6))](_0x3cb901(0xc2),common_1[_0x3cb901(0x70)]['BAD_REQUEST']);}catch(_0x236ea8){console['log'](_0x3cb901(0x90),_0x236ea8);throw new common_1[(_0x3cb901(0xb6))](_0x3cb901(0xc2),common_1[_0x3cb901(0x70)][_0x3cb901(0xe0)]);}}async[_0x10b39e(0xb4)](_0x49111c){const _0xc0055e=_0x10b39e,{id:_0x465d58}=_0x49111c,_0x42f433=await this['appEntity'][_0xc0055e(0xbd)]({'where':{'id':_0x465d58}});if(!_0x42f433)throw new common_1['HttpException'](_0xc0055e(0x96),common_1[_0xc0055e(0x70)][_0xc0055e(0xe0)]);const _0x35a4e9=await this[_0xc0055e(0x77)]['find']({'where':{'appId':_0x465d58}}),_0x4488ef=_0x35a4e9['map'](_0x310f56=>_0x310f56['id']);_0x35a4e9[_0xc0055e(0x94)]&&await this[_0xc0055e(0x77)][_0xc0055e(0x75)]({'id':(0x0,typeorm_1['In'])(_0x4488ef)});const _0x172156=await this[_0xc0055e(0x9f)][_0xc0055e(0x75)](_0x465d58);if(_0x172156[_0xc0055e(0x89)]>0x0)return _0xc0055e(0xb8);throw new common_1[(_0xc0055e(0xb6))](_0xc0055e(0x71),common_1[_0xc0055e(0x70)]['BAD_REQUEST']);}async[_0x10b39e(0x93)](_0x347e67){const _0x40a0d2=_0x10b39e,{id:_0x45d1d3}=_0x347e67,_0x273384=await this[_0x40a0d2(0x9f)][_0x40a0d2(0xbd)]({'where':{'id':_0x45d1d3,'status':0x3}});if(!_0x273384)throw new common_1['HttpException'](_0x40a0d2(0x96),common_1[_0x40a0d2(0x70)][_0x40a0d2(0xe0)]);return await this['appEntity']['update']({'id':_0x45d1d3},{'status':0x5}),await this['userAppsEntity'][_0x40a0d2(0x9d)]({'appId':_0x45d1d3},{'status':0x5}),_0x40a0d2(0x85);}async['auditFail'](_0x4fae1e){const _0x7e3965=_0x10b39e,{id:_0xb77a}=_0x4fae1e,_0x320abb=await this[_0x7e3965(0x9f)]['findOne']({'where':{'id':_0xb77a,'status':0x3}});if(!_0x320abb)throw new common_1['HttpException'](_0x7e3965(0x96),common_1['HttpStatus']['BAD_REQUEST']);return await this[_0x7e3965(0x9f)][_0x7e3965(0x9d)]({'id':_0xb77a},{'status':0x4}),await this['userAppsEntity'][_0x7e3965(0x9d)]({'appId':_0xb77a},{'status':0x4}),'应用审核拒绝完成';}async[_0x10b39e(0xcb)](_0x356b2c,_0x376e17){const _0x49e211=_0x10b39e,{id:_0x39ab7b}=_0x356b2c,_0x271e6b=await this[_0x49e211(0x9f)]['findOne']({'where':{'id':_0x39ab7b,'userId':_0x376e17[_0x49e211(0x82)]['id']}});if(!_0x271e6b)throw new common_1[(_0x49e211(0xb6))]('您正在操作一个不存在的资源！',common_1[_0x49e211(0x70)][_0x49e211(0xe0)]);return await this[_0x49e211(0x9f)][_0x49e211(0x75)](_0x39ab7b),await this['userAppsEntity'][_0x49e211(0x75)]({'appId':_0x39ab7b,'userId':_0x376e17['user']['id']}),'删除应用成功！';}async[_0x10b39e(0x91)](_0x461a15,_0x601e72){const _0x2e9720=_0x10b39e,{appId:_0x3adc0c}=_0x461a15,{id:_0x5299c6}=_0x601e72[_0x2e9720(0x82)],_0x311b32=await this['userAppsEntity']['findOne']({'where':{'appId':_0x3adc0c,'userId':_0x5299c6}});if(_0x311b32){const _0x397f0a=await this[_0x2e9720(0x77)][_0x2e9720(0x75)]({'appId':_0x3adc0c,'userId':_0x5299c6});if(_0x397f0a[_0x2e9720(0x89)]>0x0)return _0x2e9720(0xd0);else throw new common_1[(_0x2e9720(0xb6))](_0x2e9720(0x8f),common_1[_0x2e9720(0x70)][_0x2e9720(0xe0)]);}const _0x4491c4=await this['appEntity'][_0x2e9720(0xbd)]({'where':{'id':_0x3adc0c}}),{id:_0xd09b83,role:_0x9571f7,catId:_0x1d37df}=_0x4491c4,_0x28a319={'userId':_0x5299c6,'appId':_0xd09b83,'catId':_0x1d37df,'appRole':_0x9571f7,'public':!![],'status':0x1};return await this[_0x2e9720(0x77)]['save'](_0x28a319),_0x2e9720(0xc1);}async['mineApps'](_0x52cb31,_0x1ec188={'page':0x1,'size':0x1e}){const _0x26a14a=_0x10b39e,{id:_0x86f4fa}=_0x52cb31['user'],{page:page=0x1,size:size=0x1e}=_0x1ec188,[_0x1e2f23,_0x193fa5]=await this[_0x26a14a(0x77)][_0x26a14a(0xd9)]({'where':{'userId':_0x86f4fa,'status':(0x0,typeorm_1['In'])([0x1,0x3,0x4,0x5])},'order':{'id':_0x26a14a(0x87)},'skip':(page-0x1)*size,'take':size}),_0x181a24=_0x1e2f23[_0x26a14a(0x7c)](_0x8933cc=>_0x8933cc[_0x26a14a(0xc7)]),_0x180402=await this[_0x26a14a(0x9f)][_0x26a14a(0xd5)]({'where':{'id':(0x0,typeorm_1['In'])(_0x181a24)}});return _0x1e2f23['forEach'](_0x517e6c=>{const _0x5dbc92=_0x26a14a,_0x5ca210=_0x180402[_0x5dbc92(0xd5)](_0x3f81a8=>_0x3f81a8['id']===_0x517e6c['appId']);_0x517e6c[_0x5dbc92(0xbe)]=_0x5ca210?_0x5ca210[_0x5dbc92(0xb3)]:'',_0x517e6c[_0x5dbc92(0xd4)]=_0x5ca210?_0x5ca210['role']:'',_0x517e6c[_0x5dbc92(0xb5)]=_0x5ca210?_0x5ca210[_0x5dbc92(0xc8)]:'',_0x517e6c[_0x5dbc92(0xc0)]=_0x5ca210?_0x5ca210[_0x5dbc92(0xc0)]||_0x5ca210[_0x5dbc92(0xb9)]:'',_0x517e6c['demoData']=_0x5ca210?_0x5ca210['demoData']:'',_0x517e6c[_0x5dbc92(0xdd)]=(_0x5ca210===null||_0x5ca210===void 0x0?void 0x0:_0x5ca210[_0x5dbc92(0x6f)])===_0x86f4fa?_0x5ca210===null||_0x5ca210===void 0x0?void 0x0:_0x5ca210[_0x5dbc92(0xdd)]:'******';}),{'rows':_0x1e2f23,'count':_0x193fa5};}};AppService=__decorate([(0x0,common_1[_0x10b39e(0xde)])(),__param(0x0,(0x0,typeorm_2[_0x10b39e(0x95)])(appCats_entity_1['AppCatsEntity'])),__param(0x1,(0x0,typeorm_2[_0x10b39e(0x95)])(app_entity_1[_0x10b39e(0x73)])),__param(0x2,(0x0,typeorm_2[_0x10b39e(0x95)])(userApps_entity_1[_0x10b39e(0xc9)])),__metadata(_0x10b39e(0x8b),[typeorm_1[_0x10b39e(0xa2)],typeorm_1[_0x10b39e(0xa2)],typeorm_1[_0x10b39e(0xa2)]])],AppService),exports[_0x10b39e(0xdc)]=AppService;