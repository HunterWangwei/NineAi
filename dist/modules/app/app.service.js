'use strict';const _0x226950=_0x138b;(function(_0x3d133e,_0x305353){const _0x57e554=_0x138b,_0x4cd7e1=_0x3d133e();while(!![]){try{const _0x3cf3d6=-parseInt(_0x57e554(0x176))/0x1+-parseInt(_0x57e554(0x172))/0x2+-parseInt(_0x57e554(0x147))/0x3+parseInt(_0x57e554(0x139))/0x4+parseInt(_0x57e554(0x126))/0x5*(-parseInt(_0x57e554(0x157))/0x6)+parseInt(_0x57e554(0x141))/0x7*(-parseInt(_0x57e554(0x17d))/0x8)+-parseInt(_0x57e554(0x116))/0x9*(-parseInt(_0x57e554(0x153))/0xa);if(_0x3cf3d6===_0x305353)break;else _0x4cd7e1['push'](_0x4cd7e1['shift']());}catch(_0x2f9e89){_0x4cd7e1['push'](_0x4cd7e1['shift']());}}}(_0x4124,0x2f4aa));function _0x4124(){const _0x3cac3e=['修改成功','count','__esModule','map','des','updateAppCats','length','./appCats.entity','createAppCat','应用审核拒绝完成','decorate','该应用不存在！','Like','删除失败！','role','549210YYApQy','findAndCount','delApp','coverImg','195069FOaLaT','__decorate','当前应用已被下架或不存在！','design:paramtypes','您正在编辑一个不存在的应用！','appEntity','updateApp','88CbSlzU','删除应用成功！','split','AppCatsEntity','slice','createQueryBuilder','appId','使用此应用失败！','修改App信息成功','RAND()','super','Not','removeEmoji','delAppCat','find','function','45hGQkGu','message','mineApps','HttpStatus','error:\x20','appList','gptsImg','删除App失败！','object','metadata','preset','save','取消收藏成功!','Repository','MoreThan','BAD_REQUEST','949100QVxpkC','findOne','修改失败！','删除成功','userAppsEntity','******','defineProperty','auditFail','appCatsEntity','collect','./userApps.entity','删除App成功','AppEntity','取消收藏失败！','catName','该分类下存在App，不可删除！','getOwnPropertyDescriptor','DESC','修改App信息失败！','769812XWmnLp','该分类不存在！','该分类名称已存在！','createApp','user','__metadata','已将应用加入到我的个人工作台！','HttpException','106491EreMsr','system','includes','delete','log','customApp','841785bfFUBV','InjectRepository','未分类','createGptsFromUser','auditPass','Injectable','isGpts','您正在操作一个不存在的资源！','affected','queryOneCat','update','demoData','2217370euXmtF','应用审核通过','forEach','name','6xzSPNJ','appName','getMany','orderBy','@nestjs/common','UserAppsEntity','random','status','limit','__param','该应用名称已存在！','catId'];_0x4124=function(){return _0x3cac3e;};return _0x4124();}var __decorate=this&&this[_0x226950(0x177)]||function(_0x5864c2,_0x102dff,_0x5528c4,_0x210d03){const _0x188002=_0x226950;var _0x53b2ef=arguments['length'],_0xa8b257=_0x53b2ef<0x3?_0x102dff:_0x210d03===null?_0x210d03=Object[_0x188002(0x136)](_0x102dff,_0x5528c4):_0x210d03,_0x3f675e;if(typeof Reflect===_0x188002(0x11e)&&typeof Reflect[_0x188002(0x16d)]===_0x188002(0x115))_0xa8b257=Reflect['decorate'](_0x5864c2,_0x102dff,_0x5528c4,_0x210d03);else{for(var _0x1b8225=_0x5864c2[_0x188002(0x169)]-0x1;_0x1b8225>=0x0;_0x1b8225--)if(_0x3f675e=_0x5864c2[_0x1b8225])_0xa8b257=(_0x53b2ef<0x3?_0x3f675e(_0xa8b257):_0x53b2ef>0x3?_0x3f675e(_0x102dff,_0x5528c4,_0xa8b257):_0x3f675e(_0x102dff,_0x5528c4))||_0xa8b257;}return _0x53b2ef>0x3&&_0xa8b257&&Object['defineProperty'](_0x102dff,_0x5528c4,_0xa8b257),_0xa8b257;},__metadata=this&&this[_0x226950(0x13e)]||function(_0x50f0c2,_0x598f9d){const _0x12748b=_0x226950;if(typeof Reflect===_0x12748b(0x11e)&&typeof Reflect['metadata']===_0x12748b(0x115))return Reflect[_0x12748b(0x11f)](_0x50f0c2,_0x598f9d);},__param=this&&this[_0x226950(0x160)]||function(_0x14a007,_0x5b9003){return function(_0x26d9a8,_0x2391ae){_0x5b9003(_0x26d9a8,_0x2391ae,_0x14a007);};};Object[_0x226950(0x12c)](exports,_0x226950(0x165),{'value':!![]}),exports['AppService']=void 0x0;function _0x138b(_0x50f6ae,_0x29a1c1){const _0x412479=_0x4124();return _0x138b=function(_0x138be2,_0x269c40){_0x138be2=_0x138be2-0x10a;let _0x6e3c0=_0x412479[_0x138be2];return _0x6e3c0;},_0x138b(_0x50f6ae,_0x29a1c1);}const common_1=require(_0x226950(0x15b)),appCats_entity_1=require(_0x226950(0x16a)),typeorm_1=require('typeorm'),typeorm_2=require('@nestjs/typeorm'),app_entity_1=require('./app.entity'),userApps_entity_1=require(_0x226950(0x130));let AppService=class AppService{constructor(_0x82d70d,_0x553398,_0x496293){const _0x578afd=_0x226950;this[_0x578afd(0x12e)]=_0x82d70d,this[_0x578afd(0x17b)]=_0x553398,this[_0x578afd(0x12a)]=_0x496293;}async[_0x226950(0x16b)](_0x34ac37){const _0x5ab5ef=_0x226950,{name:_0x2e6363}=_0x34ac37,_0xa133b6=await this[_0x5ab5ef(0x12e)][_0x5ab5ef(0x127)]({'where':{'name':_0x2e6363}});if(_0xa133b6)throw new common_1[(_0x5ab5ef(0x140))](_0x5ab5ef(0x13b),common_1['HttpStatus'][_0x5ab5ef(0x125)]);return await this[_0x5ab5ef(0x12e)]['save'](_0x34ac37);}async[_0x226950(0x113)](_0x22e3ef){const _0x3d46e7=_0x226950,{id:_0x2dc463}=_0x22e3ef,_0xfc800f=await this['appCatsEntity'][_0x3d46e7(0x127)]({'where':{'id':_0x2dc463}});if(!_0xfc800f)throw new common_1[(_0x3d46e7(0x140))](_0x3d46e7(0x13a),common_1[_0x3d46e7(0x119)][_0x3d46e7(0x125)]);const _0x53600b=await this[_0x3d46e7(0x17b)][_0x3d46e7(0x164)]({'where':{'catId':_0x2dc463}});if(_0x53600b>0x0)throw new common_1[(_0x3d46e7(0x140))](_0x3d46e7(0x135),common_1[_0x3d46e7(0x119)][_0x3d46e7(0x125)]);const _0x2ff8ec=await this[_0x3d46e7(0x12e)][_0x3d46e7(0x144)](_0x2dc463);if(_0x2ff8ec[_0x3d46e7(0x14f)]>0x0)return _0x3d46e7(0x129);throw new common_1['HttpException'](_0x3d46e7(0x170),common_1[_0x3d46e7(0x119)][_0x3d46e7(0x125)]);}async[_0x226950(0x168)](_0x45c70c){const _0x363111=_0x226950,{id:_0x3163ce,name:_0x58a3ff}=_0x45c70c,_0x36a7e1=await this[_0x363111(0x12e)][_0x363111(0x127)]({'where':{'name':_0x58a3ff,'id':(0x0,typeorm_1[_0x363111(0x111)])(_0x3163ce)}});if(_0x36a7e1)throw new common_1[(_0x363111(0x140))](_0x363111(0x13b),common_1[_0x363111(0x119)]['BAD_REQUEST']);const _0x1e988f=await this[_0x363111(0x12e)][_0x363111(0x151)]({'id':_0x3163ce},_0x45c70c);if(_0x1e988f[_0x363111(0x14f)]>0x0)return _0x363111(0x163);throw new common_1['HttpException']('修改失败！',common_1[_0x363111(0x119)][_0x363111(0x125)]);}async[_0x226950(0x150)](_0x1c5fd6){const _0x2804a4=_0x226950,{id:_0x5d0e8a}=_0x1c5fd6;if(!_0x5d0e8a)throw new common_1[(_0x2804a4(0x140))]('缺失必要参数！',common_1['HttpStatus'][_0x2804a4(0x125)]);const _0x11a146=await this['appEntity'][_0x2804a4(0x127)]({'where':{'id':_0x5d0e8a}});if(!_0x11a146)throw new common_1[(_0x2804a4(0x140))](_0x2804a4(0x178),common_1[_0x2804a4(0x119)][_0x2804a4(0x125)]);const {demoData:_0x2b0874,coverImg:_0x151305,gptsImg:_0x3306d7,des:_0x360807,name:_0xe23607,modelTypeId:_0x3bb0c2}=_0x11a146;return{'demoData':_0x2b0874?_0x2b0874[_0x2804a4(0x17f)]('\x0a'):[],'coverImg':_0x151305||_0x3306d7,'des':_0x360807,'name':_0xe23607,'modelTypeId':_0x3bb0c2};}async[_0x226950(0x15d)](){const _0x112c33=_0x226950,_0x555868=await this[_0x112c33(0x17b)][_0x112c33(0x10b)]()[_0x112c33(0x15a)](_0x112c33(0x10f))[_0x112c33(0x15f)](0x9)[_0x112c33(0x159)](),_0x32e180=[...new Set(_0x555868[_0x112c33(0x166)](_0x1e536f=>_0x1e536f[_0x112c33(0x162)]))],_0x38e01b=await this['appCatsEntity']['find']({'where':{'id':(0x0,typeorm_1['In'])(_0x32e180)}});return _0x555868[_0x112c33(0x155)](_0x1d42b6=>{const _0x51bb6b=_0x112c33;_0x1d42b6[_0x51bb6b(0x175)]=_0x1d42b6['coverImg']||_0x1d42b6[_0x51bb6b(0x11c)];const _0x1c1bd9=_0x38e01b[_0x51bb6b(0x114)](_0x50bfc7=>_0x50bfc7['id']===_0x1d42b6[_0x51bb6b(0x162)]);_0x1d42b6['catInfo']=_0x1c1bd9;}),_0x555868;}async['appCatsList'](_0x4b82f3){const _0x207057=_0x226950,{page:page=0x1,size:size=0xa,name:_0x164a5a,status:_0x4e8e57}=_0x4b82f3,_0x35f066={};_0x164a5a&&(_0x35f066['name']=(0x0,typeorm_1['Like'])('%'+_0x164a5a+'%')),[0x0,0x1,'0','1'][_0x207057(0x143)](_0x4e8e57)&&(_0x35f066['status']=_0x4e8e57);const [_0x5652b6,_0x533ad8]=await this['appCatsEntity'][_0x207057(0x173)]({'where':_0x35f066,'order':{'order':_0x207057(0x137)},'skip':(page-0x1)*size,'take':size}),_0x41622e=_0x5652b6[_0x207057(0x166)](_0x12df94=>_0x12df94['id']),_0x5a74a2=await this[_0x207057(0x17b)]['find']({'where':{'catId':(0x0,typeorm_1['In'])(_0x41622e)}}),_0x3e4386={};return _0x5a74a2[_0x207057(0x155)](_0x238c2e=>{const _0x566cf6=_0x207057;_0x3e4386[_0x238c2e[_0x566cf6(0x162)]]?_0x3e4386[_0x238c2e[_0x566cf6(0x162)]]+=0x1:_0x3e4386[_0x238c2e[_0x566cf6(0x162)]]=0x1;}),_0x5652b6[_0x207057(0x155)](_0x1a75bf=>_0x1a75bf['appCount']=_0x3e4386[_0x1a75bf['id']]||0x0),{'rows':_0x5652b6,'count':_0x533ad8};}async[_0x226950(0x11b)](_0x387908,_0x30a14c,_0x1ba46b='id'){const _0xfd7c75=_0x226950;var _0x2c5ea3;const {page:page=0x1,size:size=0xa,name:_0x4bcc46,status:_0x573a14,catId:_0x6b88cb,role:_0x2c002a,modelTypeId:_0x432a6f,isGpts:_0x4698ee}=_0x30a14c,_0x522518={};_0x4bcc46&&(_0x522518[_0xfd7c75(0x156)]=(0x0,typeorm_1[_0xfd7c75(0x16f)])('%'+_0x4bcc46+'%')),_0x6b88cb&&(_0x522518[_0xfd7c75(0x162)]=_0x6b88cb),_0x2c002a&&(_0x522518[_0xfd7c75(0x171)]=_0x2c002a),_0x432a6f&&(_0x522518['modelTypeId']=_0x432a6f),_0x573a14&&(_0x522518['status']=_0x573a14);typeof _0x4698ee==='boolean'&&(_0x4698ee&&(_0x522518[_0xfd7c75(0x14d)]=_0x4698ee));const [_0x396b79,_0x10124c]=await this[_0xfd7c75(0x17b)][_0xfd7c75(0x173)]({'where':_0x522518,'order':{[_0x1ba46b]:_0xfd7c75(0x137)},'skip':(page-0x1)*size,'take':size}),_0x5492fa=_0x396b79['map'](_0x446b2b=>_0x446b2b[_0xfd7c75(0x162)]),_0x2fff32=await this[_0xfd7c75(0x12e)]['find']({'where':{'id':(0x0,typeorm_1['In'])(_0x5492fa)}});return _0x396b79[_0xfd7c75(0x155)](_0x1eb776=>{const _0x5d3126=_0xfd7c75,_0xcd2b33=_0x2fff32['find'](_0xc75e21=>_0xc75e21['id']===_0x1eb776[_0x5d3126(0x162)]);_0x1eb776['coverImg']=_0x1eb776[_0x5d3126(0x175)]||_0x1eb776['gptsImg'],_0x1eb776[_0x5d3126(0x134)]=_0xcd2b33?_0xcd2b33[_0x5d3126(0x156)]:'',_0x1eb776[_0x5d3126(0x134)]=_0xcd2b33?_0xcd2b33[_0x5d3126(0x156)]:_0x5d3126(0x149);}),((_0x2c5ea3=_0x387908===null||_0x387908===void 0x0?void 0x0:_0x387908[_0xfd7c75(0x13d)])===null||_0x2c5ea3===void 0x0?void 0x0:_0x2c5ea3[_0xfd7c75(0x171)])!==_0xfd7c75(0x110)&&_0x396b79[_0xfd7c75(0x155)](_0x19be6c=>{delete _0x19be6c['preset'];}),{'rows':_0x396b79,'count':_0x10124c};}async['frontAppList'](_0x3b543f,_0x3ecc2b,_0x3332fd='id'){const _0x227ed5=_0x226950;var _0xb77bbc;try{const {page:page=0x1,size:size=0x3e8,name:_0x48c3c1,catId:_0x421627,role:_0x63b246}=_0x3ecc2b,_0x286941=[{'userId':(0x0,typeorm_1[_0x227ed5(0x124)])(0x0),'public':!![],'status':0x5},{'role':_0x227ed5(0x142),'status':0x1}],[_0x5b19aa,_0x24c9ed]=await this['appEntity'][_0x227ed5(0x173)]({'where':_0x286941,'order':{'order':_0x227ed5(0x137)},'skip':(page-0x1)*size,'take':size}),_0x1e3ff5=_0x5b19aa[_0x227ed5(0x166)](_0x1590a5=>_0x1590a5[_0x227ed5(0x162)]),_0x3b16a2=await this[_0x227ed5(0x12e)][_0x227ed5(0x114)]({'where':{'id':(0x0,typeorm_1['In'])(_0x1e3ff5)}});return _0x5b19aa[_0x227ed5(0x155)](_0x1e3268=>{const _0xff9aee=_0x227ed5,_0x1d61ac=_0x3b16a2[_0xff9aee(0x114)](_0x145101=>_0x145101['id']===_0x1e3268[_0xff9aee(0x162)]);_0x1e3268[_0xff9aee(0x134)]=_0x1d61ac?_0x1d61ac[_0xff9aee(0x156)]:'';}),((_0xb77bbc=_0x3b543f===null||_0x3b543f===void 0x0?void 0x0:_0x3b543f[_0x227ed5(0x13d)])===null||_0xb77bbc===void 0x0?void 0x0:_0xb77bbc[_0x227ed5(0x171)])!==_0x227ed5(0x110)&&_0x5b19aa['forEach'](_0xe57f9e=>{const _0x4be404=_0x227ed5;delete _0xe57f9e['preset'],_0xe57f9e[_0x4be404(0x175)]=_0xe57f9e[_0x4be404(0x175)]||_0xe57f9e[_0x4be404(0x11c)];}),{'rows':_0x5b19aa,'count':_0x24c9ed};}catch(_0xcc02da){console[_0x227ed5(0x145)]('error:\x20',_0xcc02da);}}async[_0x226950(0x13c)](_0x19f797){const _0x772b3e=_0x226950,{name:_0x14f18b,catId:_0xac3a35}=_0x19f797;_0x19f797[_0x772b3e(0x171)]=_0x772b3e(0x142);const _0x31759d=await this['appEntity']['findOne']({'where':{'name':_0x14f18b}});if(_0x31759d)throw new common_1[(_0x772b3e(0x140))](_0x772b3e(0x161),common_1[_0x772b3e(0x119)][_0x772b3e(0x125)]);const _0x34c173=await this[_0x772b3e(0x12e)][_0x772b3e(0x127)]({'where':{'id':_0xac3a35}});if(!_0x34c173)throw new common_1['HttpException'](_0x772b3e(0x13a),common_1[_0x772b3e(0x119)][_0x772b3e(0x125)]);try{return await this[_0x772b3e(0x17b)][_0x772b3e(0x121)](_0x19f797);}catch(_0x35b9ab){console[_0x772b3e(0x145)](_0x772b3e(0x11a),_0x35b9ab);throw new common_1[(_0x772b3e(0x140))](_0x35b9ab[_0x772b3e(0x117)],common_1[_0x772b3e(0x119)][_0x772b3e(0x125)]);}}[_0x226950(0x112)](_0x583813){const _0x4858be=/[\u{1F600}-\u{1F64F}\u{1F300}-\u{1F5FF}\u{1F680}-\u{1F6FF}\u{1F700}-\u{1F77F}\u{1F780}-\u{1F7FF}\u{1F800}-\u{1F8FF}\u{1F900}-\u{1F9FF}\u{1FA00}-\u{1FA6F}\u{1FA70}-\u{1FAFF}\u{2600}-\u{26FF}\u{2700}-\u{27BF}\u{1F1E6}-\u{1F1FF}\u{1F191}-\u{1F251}\u{2B50}]+/gu;return _0x583813['replace'](_0x4858be,'');}async[_0x226950(0x14a)](_0x3048c4,_0x131630){const _0x29a76d=_0x226950,{gptsId:_0x4a16a6,coverImg:_0x3db433,name:_0x1bf82a,des:_0xebc452,demoData:_0x2f8859}=_0x131630,_0x2b2eca=_0x3048c4[_0x29a76d(0x13d)]['id'],_0xee22be=await this[_0x29a76d(0x17b)][_0x29a76d(0x127)]({'where':{'gptsId':_0x4a16a6}});if(_0xee22be)return _0xee22be;const _0x4c37c4={'catId':0x0,'name':_0x1bf82a,'des':_0xebc452?_0xebc452[_0x29a76d(0x10a)](0x0,0xf8):'','demoData':_0x2f8859,'status':0x5,'gptsImg':_0x3db433,'gptsId':_0x4a16a6,'userId':_0x2b2eca,'public':!![],'role':_0x29a76d(0x13d),'isGpts':!![],'order':0x3e8};try{const _0x4eb001=await this[_0x29a76d(0x17b)][_0x29a76d(0x121)](_0x4c37c4);return _0x4eb001;}catch(_0x36b042){console['log']('error:\x20',_0x36b042);throw new common_1['HttpException'](_0x29a76d(0x10d),common_1[_0x29a76d(0x119)][_0x29a76d(0x125)]);}}async[_0x226950(0x146)](_0x5d5ab3,_0x2390c0){const _0x505c99=_0x226950,{id:_0x43ebe6}=_0x2390c0[_0x505c99(0x13d)],{name:_0x2fbd06,catId:_0x354653,des:_0x283954,preset:_0xe736e,coverImg:_0x121b31,demoData:_0x3aaba6,public:_0xff9066,appId:_0x1a9ac3,modelTypeId:_0x2bcede}=_0x5d5ab3;if(_0x1a9ac3){const _0x288d3b=await this['appEntity'][_0x505c99(0x127)]({'where':{'id':_0x1a9ac3,'userId':_0x43ebe6}});if(!_0x288d3b)throw new common_1[(_0x505c99(0x140))](_0x505c99(0x17a),common_1[_0x505c99(0x119)][_0x505c99(0x125)]);const _0x2211e2={'name':_0x2fbd06,'catId':_0x354653,'des':_0x283954,'preset':_0xe736e,'coverImg':_0x121b31,'demoData':_0x3aaba6,'public':_0xff9066,'status':_0xff9066?0x3:0x1,'modelTypeId':_0x2bcede},_0x2909c7=await this[_0x505c99(0x17b)][_0x505c99(0x151)]({'id':_0x1a9ac3,'userId':_0x43ebe6},_0x2211e2);if(_0x2909c7[_0x505c99(0x14f)])return _0x505c99(0x163);else throw new common_1[(_0x505c99(0x140))](_0x505c99(0x128),common_1[_0x505c99(0x119)][_0x505c99(0x125)]);}if(!_0x1a9ac3){const _0x4fb905=await this['appCatsEntity']['findOne']({'where':{'id':_0x354653}});if(!_0x4fb905)throw new common_1[(_0x505c99(0x140))](_0x505c99(0x13a),common_1[_0x505c99(0x119)]['BAD_REQUEST']);const _0x1ce2e3=await this[_0x505c99(0x17b)]['findOne']({'where':{'name':_0x2fbd06}});if(_0x1ce2e3)throw new common_1['HttpException'](_0x505c99(0x161),common_1[_0x505c99(0x119)]['BAD_REQUEST']);const _0x5cb792={'name':_0x2fbd06,'catId':_0x354653,'des':_0x283954,'preset':_0xe736e,'coverImg':_0x121b31,'status':_0xff9066?0x3:0x1,'demoData':_0x3aaba6,'public':_0xff9066,'role':_0x505c99(0x13d),'userId':_0x43ebe6},_0x3b3afe=await this['appEntity'][_0x505c99(0x121)](_0x5cb792),_0x4c5328={'appId':_0x3b3afe['id'],'userId':_0x43ebe6,'appType':_0x505c99(0x13d),'public':_0xff9066,'status':_0xff9066?0x3:0x1,'catId':_0x354653};return this[_0x505c99(0x12a)][_0x505c99(0x121)](_0x4c5328);}}async[_0x226950(0x17c)](_0x2588a4){const _0x2ebb06=_0x226950;try{const {id:_0x3ba2ab,name:_0x444e59,catId:_0xc4ebf6,status:_0x3272ea}=_0x2588a4,_0x264a25=await this[_0x2ebb06(0x17b)]['findOne']({'where':{'name':_0x444e59,'id':(0x0,typeorm_1[_0x2ebb06(0x111)])(_0x3ba2ab)}});if(_0x264a25)throw new common_1['HttpException'](_0x2ebb06(0x161),common_1[_0x2ebb06(0x119)][_0x2ebb06(0x125)]);if(_0xc4ebf6){const _0x1c0ec4=await this[_0x2ebb06(0x12e)][_0x2ebb06(0x127)]({'where':{'id':_0xc4ebf6}});if(!_0x1c0ec4)throw new common_1[(_0x2ebb06(0x140))]('该分类不存在！',common_1[_0x2ebb06(0x119)]['BAD_REQUEST']);}const _0x3a5855=await this['appEntity'][_0x2ebb06(0x127)]({'where':{'id':_0x3ba2ab}});_0x3a5855[_0x2ebb06(0x15e)]!==_0x2588a4[_0x2ebb06(0x15e)]&&await this['userAppsEntity'][_0x2ebb06(0x151)]({'appId':_0x3ba2ab},{'status':_0x3272ea});_0x2588a4[_0x2ebb06(0x11c)]=_0x2588a4[_0x2ebb06(0x175)],_0x2588a4['coverImg']=_0x3a5855===null||_0x3a5855===void 0x0?void 0x0:_0x3a5855['coverImg'];const _0x45b6de=await this['appEntity'][_0x2ebb06(0x151)]({'id':_0x3ba2ab},_0x2588a4);if(_0x45b6de['affected']>0x0)return _0x2ebb06(0x10e);throw new common_1['HttpException'](_0x2ebb06(0x138),common_1[_0x2ebb06(0x119)]['BAD_REQUEST']);}catch(_0x2f772a){console[_0x2ebb06(0x145)](_0x2ebb06(0x11a),_0x2f772a);throw new common_1['HttpException'](_0x2ebb06(0x138),common_1[_0x2ebb06(0x119)][_0x2ebb06(0x125)]);}}async[_0x226950(0x174)](_0x3f21a9){const _0x12d4d3=_0x226950,{id:_0x58cf17}=_0x3f21a9,_0x593f95=await this[_0x12d4d3(0x17b)][_0x12d4d3(0x127)]({'where':{'id':_0x58cf17}});if(!_0x593f95)throw new common_1[(_0x12d4d3(0x140))](_0x12d4d3(0x16e),common_1['HttpStatus'][_0x12d4d3(0x125)]);const _0x4d16e8=await this['userAppsEntity'][_0x12d4d3(0x114)]({'where':{'appId':_0x58cf17}}),_0x17d13a=_0x4d16e8['map'](_0x46a7eb=>_0x46a7eb['id']);_0x4d16e8['length']&&await this[_0x12d4d3(0x12a)][_0x12d4d3(0x144)]({'id':(0x0,typeorm_1['In'])(_0x17d13a)});const _0x29535a=await this['appEntity']['delete'](_0x58cf17);if(_0x29535a[_0x12d4d3(0x14f)]>0x0)return _0x12d4d3(0x131);throw new common_1['HttpException'](_0x12d4d3(0x11d),common_1[_0x12d4d3(0x119)][_0x12d4d3(0x125)]);}async[_0x226950(0x14b)](_0x39ba56){const _0x5860ff=_0x226950,{id:_0x3762ea}=_0x39ba56,_0x3d4580=await this[_0x5860ff(0x17b)][_0x5860ff(0x127)]({'where':{'id':_0x3762ea,'status':0x3}});if(!_0x3d4580)throw new common_1[(_0x5860ff(0x140))](_0x5860ff(0x16e),common_1['HttpStatus'][_0x5860ff(0x125)]);return await this[_0x5860ff(0x17b)][_0x5860ff(0x151)]({'id':_0x3762ea},{'status':0x5}),await this[_0x5860ff(0x12a)][_0x5860ff(0x151)]({'appId':_0x3762ea},{'status':0x5}),_0x5860ff(0x154);}async[_0x226950(0x12d)](_0x3b604e){const _0x272e00=_0x226950,{id:_0x46231a}=_0x3b604e,_0x2a05e9=await this[_0x272e00(0x17b)][_0x272e00(0x127)]({'where':{'id':_0x46231a,'status':0x3}});if(!_0x2a05e9)throw new common_1[(_0x272e00(0x140))](_0x272e00(0x16e),common_1[_0x272e00(0x119)][_0x272e00(0x125)]);return await this[_0x272e00(0x17b)][_0x272e00(0x151)]({'id':_0x46231a},{'status':0x4}),await this[_0x272e00(0x12a)][_0x272e00(0x151)]({'appId':_0x46231a},{'status':0x4}),_0x272e00(0x16c);}async['delMineApp'](_0x40973d,_0x461709){const _0x2432e8=_0x226950,{id:_0x16a539}=_0x40973d,_0x425832=await this[_0x2432e8(0x17b)]['findOne']({'where':{'id':_0x16a539,'userId':_0x461709[_0x2432e8(0x13d)]['id']}});if(!_0x425832)throw new common_1[(_0x2432e8(0x140))](_0x2432e8(0x14e),common_1[_0x2432e8(0x119)][_0x2432e8(0x125)]);return await this[_0x2432e8(0x17b)][_0x2432e8(0x144)](_0x16a539),await this[_0x2432e8(0x12a)][_0x2432e8(0x144)]({'appId':_0x16a539,'userId':_0x461709[_0x2432e8(0x13d)]['id']}),_0x2432e8(0x17e);}async[_0x226950(0x12f)](_0x4a91aa,_0x42a500){const _0x5257af=_0x226950,{appId:_0x162cd4}=_0x4a91aa,{id:_0x36dcda}=_0x42a500[_0x5257af(0x13d)],_0x4263eb=await this[_0x5257af(0x12a)][_0x5257af(0x127)]({'where':{'appId':_0x162cd4,'userId':_0x36dcda}});if(_0x4263eb){const _0x3cdd51=await this[_0x5257af(0x12a)][_0x5257af(0x144)]({'appId':_0x162cd4,'userId':_0x36dcda});if(_0x3cdd51[_0x5257af(0x14f)]>0x0)return _0x5257af(0x122);else throw new common_1[(_0x5257af(0x140))](_0x5257af(0x133),common_1[_0x5257af(0x119)][_0x5257af(0x125)]);}const _0x4df66e=await this[_0x5257af(0x17b)]['findOne']({'where':{'id':_0x162cd4}}),{id:_0x48b48f,role:_0x16d05a,catId:_0x189115}=_0x4df66e,_0x2029aa={'userId':_0x36dcda,'appId':_0x48b48f,'catId':_0x189115,'appRole':_0x16d05a,'public':!![],'status':0x1};return await this[_0x5257af(0x12a)][_0x5257af(0x121)](_0x2029aa),_0x5257af(0x13f);}async[_0x226950(0x118)](_0x19dfce,_0x3a4e88={'page':0x1,'size':0x1e}){const _0x9af45e=_0x226950,{id:_0x70a9e2}=_0x19dfce['user'],{page:page=0x1,size:size=0x1e}=_0x3a4e88,[_0x2a9d93,_0x363110]=await this['userAppsEntity'][_0x9af45e(0x173)]({'where':{'userId':_0x70a9e2,'status':(0x0,typeorm_1['In'])([0x1,0x3,0x4,0x5])},'order':{'id':_0x9af45e(0x137)},'skip':(page-0x1)*size,'take':size}),_0x52347a=_0x2a9d93[_0x9af45e(0x166)](_0x2bd98f=>_0x2bd98f[_0x9af45e(0x10c)]),_0x183b93=await this[_0x9af45e(0x17b)][_0x9af45e(0x114)]({'where':{'id':(0x0,typeorm_1['In'])(_0x52347a)}});return _0x2a9d93['forEach'](_0x4b7842=>{const _0x5e4403=_0x9af45e,_0x3bffc9=_0x183b93[_0x5e4403(0x114)](_0x1feadd=>_0x1feadd['id']===_0x4b7842[_0x5e4403(0x10c)]);_0x4b7842[_0x5e4403(0x158)]=_0x3bffc9?_0x3bffc9[_0x5e4403(0x156)]:'',_0x4b7842['appRole']=_0x3bffc9?_0x3bffc9[_0x5e4403(0x171)]:'',_0x4b7842['appDes']=_0x3bffc9?_0x3bffc9[_0x5e4403(0x167)]:'',_0x4b7842[_0x5e4403(0x175)]=_0x3bffc9?_0x3bffc9[_0x5e4403(0x175)]||_0x3bffc9[_0x5e4403(0x11c)]:'',_0x4b7842[_0x5e4403(0x152)]=_0x3bffc9?_0x3bffc9[_0x5e4403(0x152)]:'',_0x4b7842[_0x5e4403(0x120)]=(_0x3bffc9===null||_0x3bffc9===void 0x0?void 0x0:_0x3bffc9['userId'])===_0x70a9e2?_0x3bffc9===null||_0x3bffc9===void 0x0?void 0x0:_0x3bffc9[_0x5e4403(0x120)]:_0x5e4403(0x12b);}),{'rows':_0x2a9d93,'count':_0x363110};}};AppService=__decorate([(0x0,common_1[_0x226950(0x14c)])(),__param(0x0,(0x0,typeorm_2[_0x226950(0x148)])(appCats_entity_1[_0x226950(0x180)])),__param(0x1,(0x0,typeorm_2[_0x226950(0x148)])(app_entity_1[_0x226950(0x132)])),__param(0x2,(0x0,typeorm_2[_0x226950(0x148)])(userApps_entity_1[_0x226950(0x15c)])),__metadata(_0x226950(0x179),[typeorm_1['Repository'],typeorm_1[_0x226950(0x123)],typeorm_1[_0x226950(0x123)]])],AppService),exports['AppService']=AppService;