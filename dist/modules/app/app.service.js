'use strict';const _0x46cd5f=_0x4079;(function(_0x40aae6,_0x2da801){const _0x274d3f=_0x4079,_0x4ea61f=_0x40aae6();while(!![]){try{const _0x192d8d=-parseInt(_0x274d3f(0xf5))/0x1+parseInt(_0x274d3f(0x90))/0x2*(parseInt(_0x274d3f(0xc3))/0x3)+-parseInt(_0x274d3f(0xbb))/0x4+parseInt(_0x274d3f(0xea))/0x5+parseInt(_0x274d3f(0x98))/0x6*(parseInt(_0x274d3f(0x8a))/0x7)+-parseInt(_0x274d3f(0xca))/0x8+-parseInt(_0x274d3f(0xb1))/0x9*(-parseInt(_0x274d3f(0xb2))/0xa);if(_0x192d8d===_0x2da801)break;else _0x4ea61f['push'](_0x4ea61f['shift']());}catch(_0x3530fa){_0x4ea61f['push'](_0x4ea61f['shift']());}}}(_0x5033,0xb1b25));function _0x4079(_0x36f3a8,_0x595384){const _0x503362=_0x5033();return _0x4079=function(_0x4079cf,_0x13ffec){_0x4079cf=_0x4079cf-0x8a;let _0x258f1d=_0x503362[_0x4079cf];return _0x258f1d;},_0x4079(_0x36f3a8,_0x595384);}var __decorate=this&&this[_0x46cd5f(0x8e)]||function(_0x227231,_0x345243,_0x22112f,_0x4bbbad){const _0x2ff8f3=_0x46cd5f;var _0x7c8c53=arguments['length'],_0x25a082=_0x7c8c53<0x3?_0x345243:_0x4bbbad===null?_0x4bbbad=Object[_0x2ff8f3(0xb6)](_0x345243,_0x22112f):_0x4bbbad,_0x4ecda9;if(typeof Reflect==='object'&&typeof Reflect[_0x2ff8f3(0xdc)]===_0x2ff8f3(0xc9))_0x25a082=Reflect[_0x2ff8f3(0xdc)](_0x227231,_0x345243,_0x22112f,_0x4bbbad);else{for(var _0x4c9d54=_0x227231[_0x2ff8f3(0xce)]-0x1;_0x4c9d54>=0x0;_0x4c9d54--)if(_0x4ecda9=_0x227231[_0x4c9d54])_0x25a082=(_0x7c8c53<0x3?_0x4ecda9(_0x25a082):_0x7c8c53>0x3?_0x4ecda9(_0x345243,_0x22112f,_0x25a082):_0x4ecda9(_0x345243,_0x22112f))||_0x25a082;}return _0x7c8c53>0x3&&_0x25a082&&Object[_0x2ff8f3(0xb0)](_0x345243,_0x22112f,_0x25a082),_0x25a082;},__metadata=this&&this[_0x46cd5f(0xe3)]||function(_0x56e4b5,_0x57ecb5){const _0x3fa0b8=_0x46cd5f;if(typeof Reflect===_0x3fa0b8(0xe6)&&typeof Reflect[_0x3fa0b8(0xbf)]===_0x3fa0b8(0xc9))return Reflect[_0x3fa0b8(0xbf)](_0x56e4b5,_0x57ecb5);},__param=this&&this[_0x46cd5f(0xd2)]||function(_0x48a87a,_0x40bcd5){return function(_0x3c5b75,_0x5985e6){_0x40bcd5(_0x3c5b75,_0x5985e6,_0x48a87a);};};Object[_0x46cd5f(0xb0)](exports,'__esModule',{'value':!![]}),exports['AppService']=void 0x0;const common_1=require(_0x46cd5f(0xa8)),appCats_entity_1=require('./appCats.entity'),typeorm_1=require(_0x46cd5f(0xc6)),typeorm_2=require(_0x46cd5f(0xd7)),app_entity_1=require(_0x46cd5f(0xf6)),userApps_entity_1=require('./userApps.entity');function _0x5033(){const _0x5e05eb=['__param','取消收藏失败！','appRole','modelTypeId','findOne','@nestjs/typeorm','find','log','该应用名称已存在！','应用审核拒绝完成','decorate','design:paramtypes','取消收藏成功!','getMany','Not','HttpException','removeEmoji','__metadata','message','appCount','object','orderBy','HttpStatus','appId','604865irlAFN','gptsImg','queryOneCat','DESC','应用审核通过','random','appEntity','该分类名称已存在！','createGptsFromUser','RAND()','UserAppsEntity','207984TaEifx','./app.entity','InjectRepository','coverImg','您正在操作一个不存在的资源！','delete','7WWrjPc','修改App信息成功','preset','split','__decorate','您正在编辑一个不存在的应用！','1182274tELQqC','修改成功','Like','error:\x20','affected','collect','count','save','2790756bzulzB','catName','******','slice','当前应用已被下架或不存在！','catId','缺失必要参数！','修改App信息失败！','mineApps','appCatsEntity','updateApp','super','system','customApp','name','appCatsList','@nestjs/common','appList','该分类不存在！','删除成功','findAndCount','catInfo','该分类下存在App，不可删除！','auditPass','defineProperty','5455377WkRGPG','10ChJjMU','appName','limit','删除应用成功！','getOwnPropertyDescriptor','user','status','role','userAppsEntity','5280356yeVuDj','未分类','boolean','BAD_REQUEST','metadata','map','Repository','已将应用加入到我的个人工作台！','6kmOrbi','demoData','includes','typeorm','des','AppEntity','function','948864xCXNLY','修改失败！','update','该应用不存在！','length','delAppCat','forEach','Injectable'];_0x5033=function(){return _0x5e05eb;};return _0x5033();}let AppService=class AppService{constructor(_0x1ea3ca,_0x219948,_0x29c88e){const _0x3db827=_0x46cd5f;this['appCatsEntity']=_0x1ea3ca,this['appEntity']=_0x219948,this[_0x3db827(0xba)]=_0x29c88e;}async['createAppCat'](_0x40b1ea){const _0x53d130=_0x46cd5f,{name:_0x15b88d}=_0x40b1ea,_0x45e11f=await this[_0x53d130(0xa1)][_0x53d130(0xd6)]({'where':{'name':_0x15b88d}});if(_0x45e11f)throw new common_1[(_0x53d130(0xe1))](_0x53d130(0xf1),common_1[_0x53d130(0xe8)][_0x53d130(0xbe)]);return await this[_0x53d130(0xa1)][_0x53d130(0x97)](_0x40b1ea);}async[_0x46cd5f(0xcf)](_0x28cb92){const _0x39dc3a=_0x46cd5f,{id:_0x54cd07}=_0x28cb92,_0x19f3bd=await this[_0x39dc3a(0xa1)]['findOne']({'where':{'id':_0x54cd07}});if(!_0x19f3bd)throw new common_1[(_0x39dc3a(0xe1))]('该分类不存在！',common_1[_0x39dc3a(0xe8)][_0x39dc3a(0xbe)]);const _0x5a5359=await this[_0x39dc3a(0xf0)][_0x39dc3a(0x96)]({'where':{'catId':_0x54cd07}});if(_0x5a5359>0x0)throw new common_1['HttpException'](_0x39dc3a(0xae),common_1[_0x39dc3a(0xe8)][_0x39dc3a(0xbe)]);const _0x45b534=await this[_0x39dc3a(0xa1)][_0x39dc3a(0xfa)](_0x54cd07);if(_0x45b534[_0x39dc3a(0x94)]>0x0)return _0x39dc3a(0xab);throw new common_1[(_0x39dc3a(0xe1))]('删除失败！',common_1[_0x39dc3a(0xe8)]['BAD_REQUEST']);}async['updateAppCats'](_0x3d9b77){const _0x312429=_0x46cd5f,{id:_0x1ce878,name:_0x439e3c}=_0x3d9b77,_0x3fe421=await this[_0x312429(0xa1)]['findOne']({'where':{'name':_0x439e3c,'id':(0x0,typeorm_1[_0x312429(0xe0)])(_0x1ce878)}});if(_0x3fe421)throw new common_1[(_0x312429(0xe1))](_0x312429(0xf1),common_1[_0x312429(0xe8)]['BAD_REQUEST']);const _0x229496=await this[_0x312429(0xa1)][_0x312429(0xcc)]({'id':_0x1ce878},_0x3d9b77);if(_0x229496[_0x312429(0x94)]>0x0)return _0x312429(0x91);throw new common_1['HttpException'](_0x312429(0xcb),common_1[_0x312429(0xe8)][_0x312429(0xbe)]);}async[_0x46cd5f(0xec)](_0x5c2b02){const _0x51c253=_0x46cd5f,{id:_0x13f142}=_0x5c2b02;if(!_0x13f142)throw new common_1['HttpException'](_0x51c253(0x9e),common_1[_0x51c253(0xe8)][_0x51c253(0xbe)]);const _0x1d3eed=await this[_0x51c253(0xf0)][_0x51c253(0xd6)]({'where':{'id':_0x13f142}});if(!_0x1d3eed)throw new common_1[(_0x51c253(0xe1))](_0x51c253(0x9c),common_1[_0x51c253(0xe8)][_0x51c253(0xbe)]);const {demoData:_0x5503fc,coverImg:_0x5963e7,gptsImg:_0x1364a2,des:_0x2e0252,name:_0x10abde,modelTypeId:_0x2d3e49}=_0x1d3eed;return{'demoData':_0x5503fc?_0x5503fc[_0x51c253(0x8d)]('\x0a'):[],'coverImg':_0x5963e7||_0x1364a2,'des':_0x2e0252,'name':_0x10abde,'modelTypeId':_0x2d3e49};}async[_0x46cd5f(0xef)](){const _0x5270ba=_0x46cd5f,_0x27b658=await this[_0x5270ba(0xf0)]['createQueryBuilder']()[_0x5270ba(0xe7)](_0x5270ba(0xf3))[_0x5270ba(0xb4)](0x9)[_0x5270ba(0xdf)](),_0xabd1d7=[...new Set(_0x27b658['map'](_0x19c7e5=>_0x19c7e5[_0x5270ba(0x9d)]))],_0x370246=await this[_0x5270ba(0xa1)]['find']({'where':{'id':(0x0,typeorm_1['In'])(_0xabd1d7)}});return _0x27b658[_0x5270ba(0xd0)](_0x94aa41=>{const _0x37003d=_0x5270ba;_0x94aa41[_0x37003d(0xf8)]=_0x94aa41[_0x37003d(0xf8)]||_0x94aa41[_0x37003d(0xeb)];const _0x2da76b=_0x370246['find'](_0x6272c=>_0x6272c['id']===_0x94aa41['catId']);_0x94aa41[_0x37003d(0xad)]=_0x2da76b;}),_0x27b658;}async[_0x46cd5f(0xa7)](_0x56a8b1){const _0x461089=_0x46cd5f,{page:page=0x1,size:size=0xa,name:_0x2de422,status:_0x23e4a9}=_0x56a8b1,_0x1ae774={};_0x2de422&&(_0x1ae774[_0x461089(0xa6)]=(0x0,typeorm_1[_0x461089(0x92)])('%'+_0x2de422+'%')),[0x0,0x1,'0','1'][_0x461089(0xc5)](_0x23e4a9)&&(_0x1ae774['status']=_0x23e4a9);const [_0x511168,_0x2abf02]=await this[_0x461089(0xa1)][_0x461089(0xac)]({'where':_0x1ae774,'order':{'order':_0x461089(0xed)},'skip':(page-0x1)*size,'take':size}),_0x3080ca=_0x511168[_0x461089(0xc0)](_0x463874=>_0x463874['id']),_0x305d48=await this['appEntity'][_0x461089(0xd8)]({'where':{'catId':(0x0,typeorm_1['In'])(_0x3080ca)}}),_0xcb5f71={};return _0x305d48['forEach'](_0x3ee947=>{const _0x59cb3c=_0x461089;_0xcb5f71[_0x3ee947[_0x59cb3c(0x9d)]]?_0xcb5f71[_0x3ee947[_0x59cb3c(0x9d)]]+=0x1:_0xcb5f71[_0x3ee947[_0x59cb3c(0x9d)]]=0x1;}),_0x511168[_0x461089(0xd0)](_0x365c7d=>_0x365c7d[_0x461089(0xe5)]=_0xcb5f71[_0x365c7d['id']]||0x0),{'rows':_0x511168,'count':_0x2abf02};}async[_0x46cd5f(0xa9)](_0x4bdc63,_0x36df9c,_0x20314e='id'){const _0x6c800=_0x46cd5f;var _0x5ce242;const {page:page=0x1,size:size=0xa,name:_0x207439,status:_0x23b5da,catId:_0x85540f,role:_0x212d11,modelTypeId:_0x480c86,isGpts:_0x34dbb9}=_0x36df9c,_0x48a1d3={};_0x207439&&(_0x48a1d3['name']=(0x0,typeorm_1['Like'])('%'+_0x207439+'%')),_0x85540f&&(_0x48a1d3[_0x6c800(0x9d)]=_0x85540f),_0x212d11&&(_0x48a1d3[_0x6c800(0xb9)]=_0x212d11),_0x480c86&&(_0x48a1d3[_0x6c800(0xd5)]=_0x480c86),_0x23b5da&&(_0x48a1d3[_0x6c800(0xb8)]=_0x23b5da);typeof _0x34dbb9===_0x6c800(0xbd)&&(_0x34dbb9&&(_0x48a1d3['isGpts']=_0x34dbb9));const [_0x5608f1,_0x2d1e28]=await this[_0x6c800(0xf0)][_0x6c800(0xac)]({'where':_0x48a1d3,'order':{[_0x20314e]:_0x6c800(0xed)},'skip':(page-0x1)*size,'take':size}),_0x43f292=_0x5608f1[_0x6c800(0xc0)](_0x18331a=>_0x18331a[_0x6c800(0x9d)]),_0x9a7d97=await this[_0x6c800(0xa1)][_0x6c800(0xd8)]({'where':{'id':(0x0,typeorm_1['In'])(_0x43f292)}});return _0x5608f1[_0x6c800(0xd0)](_0x26ccb8=>{const _0x18ede1=_0x6c800,_0x52efe8=_0x9a7d97[_0x18ede1(0xd8)](_0x5c89cd=>_0x5c89cd['id']===_0x26ccb8[_0x18ede1(0x9d)]);_0x26ccb8[_0x18ede1(0xf8)]=_0x26ccb8[_0x18ede1(0xf8)]||_0x26ccb8[_0x18ede1(0xeb)],_0x26ccb8[_0x18ede1(0x99)]=_0x52efe8?_0x52efe8['name']:'',_0x26ccb8[_0x18ede1(0x99)]=_0x52efe8?_0x52efe8[_0x18ede1(0xa6)]:_0x18ede1(0xbc);}),((_0x5ce242=_0x4bdc63===null||_0x4bdc63===void 0x0?void 0x0:_0x4bdc63[_0x6c800(0xb7)])===null||_0x5ce242===void 0x0?void 0x0:_0x5ce242[_0x6c800(0xb9)])!==_0x6c800(0xa3)&&_0x5608f1['forEach'](_0x9093e4=>{const _0x36f45d=_0x6c800;delete _0x9093e4[_0x36f45d(0x8c)];}),{'rows':_0x5608f1,'count':_0x2d1e28};}async['frontAppList'](_0xc5dbcd,_0x481b67,_0x4394d3='id'){const _0x464307=_0x46cd5f;var _0x37c737;try{const {page:page=0x1,size:size=0x3e8,name:_0x4b344f,catId:_0x42e3ba,role:_0x5c51fe}=_0x481b67,_0x1fe534=[{'userId':(0x0,typeorm_1['MoreThan'])(0x0),'public':!![],'status':0x5},{'role':_0x464307(0xa4),'status':0x1}],[_0x1c797e,_0x2943b0]=await this['appEntity']['findAndCount']({'where':_0x1fe534,'order':{'order':_0x464307(0xed)},'skip':(page-0x1)*size,'take':size}),_0x3ffe1c=_0x1c797e[_0x464307(0xc0)](_0x294e05=>_0x294e05[_0x464307(0x9d)]),_0x4e03dc=await this[_0x464307(0xa1)][_0x464307(0xd8)]({'where':{'id':(0x0,typeorm_1['In'])(_0x3ffe1c)}});return _0x1c797e[_0x464307(0xd0)](_0x38f937=>{const _0x4aa52b=_0x464307,_0x3417ca=_0x4e03dc[_0x4aa52b(0xd8)](_0xc472b=>_0xc472b['id']===_0x38f937['catId']);_0x38f937[_0x4aa52b(0x99)]=_0x3417ca?_0x3417ca['name']:'';}),((_0x37c737=_0xc5dbcd===null||_0xc5dbcd===void 0x0?void 0x0:_0xc5dbcd[_0x464307(0xb7)])===null||_0x37c737===void 0x0?void 0x0:_0x37c737[_0x464307(0xb9)])!==_0x464307(0xa3)&&_0x1c797e[_0x464307(0xd0)](_0x57bffc=>{const _0x13b729=_0x464307;delete _0x57bffc[_0x13b729(0x8c)],_0x57bffc[_0x13b729(0xf8)]=_0x57bffc[_0x13b729(0xf8)]||_0x57bffc[_0x13b729(0xeb)];}),{'rows':_0x1c797e,'count':_0x2943b0};}catch(_0x1e45b2){console[_0x464307(0xd9)](_0x464307(0x93),_0x1e45b2);}}async['createApp'](_0x54e6c3){const _0x158b5e=_0x46cd5f,{name:_0x4bce83,catId:_0x149edb}=_0x54e6c3;_0x54e6c3[_0x158b5e(0xb9)]=_0x158b5e(0xa4);const _0x43401c=await this[_0x158b5e(0xf0)]['findOne']({'where':{'name':_0x4bce83}});if(_0x43401c)throw new common_1[(_0x158b5e(0xe1))]('该应用名称已存在！',common_1[_0x158b5e(0xe8)][_0x158b5e(0xbe)]);const _0x8d5b23=await this['appCatsEntity'][_0x158b5e(0xd6)]({'where':{'id':_0x149edb}});if(!_0x8d5b23)throw new common_1['HttpException'](_0x158b5e(0xaa),common_1[_0x158b5e(0xe8)][_0x158b5e(0xbe)]);try{return await this[_0x158b5e(0xf0)][_0x158b5e(0x97)](_0x54e6c3);}catch(_0x28eb95){console['log'](_0x158b5e(0x93),_0x28eb95);throw new common_1['HttpException'](_0x28eb95[_0x158b5e(0xe4)],common_1['HttpStatus'][_0x158b5e(0xbe)]);}}[_0x46cd5f(0xe2)](_0x1034f1){const _0x1a6d5a=/[\u{1F600}-\u{1F64F}\u{1F300}-\u{1F5FF}\u{1F680}-\u{1F6FF}\u{1F700}-\u{1F77F}\u{1F780}-\u{1F7FF}\u{1F800}-\u{1F8FF}\u{1F900}-\u{1F9FF}\u{1FA00}-\u{1FA6F}\u{1FA70}-\u{1FAFF}\u{2600}-\u{26FF}\u{2700}-\u{27BF}\u{1F1E6}-\u{1F1FF}\u{1F191}-\u{1F251}\u{2B50}]+/gu;return _0x1034f1['replace'](_0x1a6d5a,'');}async[_0x46cd5f(0xf2)](_0x139546,_0x3ca37f){const _0x59381e=_0x46cd5f,{gptsId:_0x4d4600,coverImg:_0xf77c78,name:_0x1ed501,des:_0x1ad5c6,demoData:_0x34ef95}=_0x3ca37f,_0x4a23d3=_0x139546[_0x59381e(0xb7)]['id'],_0x202982=await this[_0x59381e(0xf0)][_0x59381e(0xd6)]({'where':{'gptsId':_0x4d4600}});if(_0x202982)return _0x202982;const _0x747d60={'catId':0x0,'name':this[_0x59381e(0xe2)](_0x1ed501),'des':this[_0x59381e(0xe2)](_0x1ad5c6)?this[_0x59381e(0xe2)](_0x1ad5c6)[_0x59381e(0x9b)](0x0,0xf8):'','demoData':_0x34ef95,'status':0x5,'gptsImg':_0xf77c78,'gptsId':_0x4d4600,'userId':_0x4a23d3,'public':!![],'role':'user','isGpts':!![],'order':0x3e8};try{const _0xaf4200=await this['appEntity'][_0x59381e(0x97)](_0x747d60);return _0xaf4200;}catch(_0x1a1c8b){console[_0x59381e(0xd9)](_0x59381e(0x93),_0x1a1c8b);throw new common_1[(_0x59381e(0xe1))]('使用此应用失败！',common_1[_0x59381e(0xe8)][_0x59381e(0xbe)]);}}async[_0x46cd5f(0xa5)](_0x2e2c4e,_0x2b5802){const _0x2f9ab8=_0x46cd5f,{id:_0x5f50e2}=_0x2b5802[_0x2f9ab8(0xb7)],{name:_0x136921,catId:_0x39f248,des:_0x585fd9,preset:_0x1f1008,coverImg:_0x4cc37a,demoData:_0x12be0d,public:_0x3a486d,appId:_0x424c52,modelTypeId:_0x5d8370}=_0x2e2c4e;if(_0x424c52){const _0x543000=await this[_0x2f9ab8(0xf0)]['findOne']({'where':{'id':_0x424c52,'userId':_0x5f50e2}});if(!_0x543000)throw new common_1[(_0x2f9ab8(0xe1))](_0x2f9ab8(0x8f),common_1[_0x2f9ab8(0xe8)][_0x2f9ab8(0xbe)]);const _0x3688e9={'name':_0x136921,'catId':_0x39f248,'des':_0x585fd9,'preset':_0x1f1008,'coverImg':_0x4cc37a,'demoData':_0x12be0d,'public':_0x3a486d,'status':_0x3a486d?0x3:0x1,'modelTypeId':_0x5d8370},_0x447313=await this[_0x2f9ab8(0xf0)]['update']({'id':_0x424c52,'userId':_0x5f50e2},_0x3688e9);if(_0x447313[_0x2f9ab8(0x94)])return _0x2f9ab8(0x91);else throw new common_1[(_0x2f9ab8(0xe1))](_0x2f9ab8(0xcb),common_1[_0x2f9ab8(0xe8)]['BAD_REQUEST']);}if(!_0x424c52){const _0x1bc23f=await this[_0x2f9ab8(0xa1)]['findOne']({'where':{'id':_0x39f248}});if(!_0x1bc23f)throw new common_1['HttpException'](_0x2f9ab8(0xaa),common_1['HttpStatus'][_0x2f9ab8(0xbe)]);const _0x29581e=await this[_0x2f9ab8(0xf0)]['findOne']({'where':{'name':_0x136921}});if(_0x29581e)throw new common_1[(_0x2f9ab8(0xe1))](_0x2f9ab8(0xda),common_1[_0x2f9ab8(0xe8)]['BAD_REQUEST']);const _0x41ee9d={'name':_0x136921,'catId':_0x39f248,'des':_0x585fd9,'preset':_0x1f1008,'coverImg':_0x4cc37a,'status':_0x3a486d?0x3:0x1,'demoData':_0x12be0d,'public':_0x3a486d,'role':_0x2f9ab8(0xb7),'userId':_0x5f50e2},_0x54e719=await this[_0x2f9ab8(0xf0)][_0x2f9ab8(0x97)](_0x41ee9d),_0x50b717={'appId':_0x54e719['id'],'userId':_0x5f50e2,'appType':_0x2f9ab8(0xb7),'public':_0x3a486d,'status':_0x3a486d?0x3:0x1,'catId':_0x39f248};return this[_0x2f9ab8(0xba)][_0x2f9ab8(0x97)](_0x50b717);}}async[_0x46cd5f(0xa2)](_0x312243){const _0x1218f6=_0x46cd5f;try{const {id:_0x102f78,name:_0x30ad25,catId:_0xdc5097,status:_0x497ce1}=_0x312243,_0x3d3fed=await this['appEntity']['findOne']({'where':{'name':_0x30ad25,'id':(0x0,typeorm_1[_0x1218f6(0xe0)])(_0x102f78)}});if(_0x3d3fed)throw new common_1[(_0x1218f6(0xe1))](_0x1218f6(0xda),common_1['HttpStatus'][_0x1218f6(0xbe)]);if(_0xdc5097){const _0x3b9d31=await this[_0x1218f6(0xa1)][_0x1218f6(0xd6)]({'where':{'id':_0xdc5097}});if(!_0x3b9d31)throw new common_1[(_0x1218f6(0xe1))](_0x1218f6(0xaa),common_1[_0x1218f6(0xe8)][_0x1218f6(0xbe)]);}const _0x29c3d3=await this[_0x1218f6(0xf0)]['findOne']({'where':{'id':_0x102f78}});_0x29c3d3[_0x1218f6(0xb8)]!==_0x312243[_0x1218f6(0xb8)]&&await this['userAppsEntity'][_0x1218f6(0xcc)]({'appId':_0x102f78},{'status':_0x497ce1});const _0x1546ae=await this['appEntity']['update']({'id':_0x102f78},_0x312243);if(_0x1546ae['affected']>0x0)return _0x1218f6(0x8b);throw new common_1['HttpException'](_0x1218f6(0x9f),common_1[_0x1218f6(0xe8)][_0x1218f6(0xbe)]);}catch(_0x8dcd95){console['log']('error:\x20',_0x8dcd95);throw new common_1[(_0x1218f6(0xe1))](_0x1218f6(0x9f),common_1[_0x1218f6(0xe8)][_0x1218f6(0xbe)]);}}async['delApp'](_0x391866){const _0x23651a=_0x46cd5f,{id:_0x2f95bd}=_0x391866,_0x4de1cd=await this['appEntity'][_0x23651a(0xd6)]({'where':{'id':_0x2f95bd}});if(!_0x4de1cd)throw new common_1[(_0x23651a(0xe1))](_0x23651a(0xcd),common_1[_0x23651a(0xe8)][_0x23651a(0xbe)]);const _0x5d1c35=await this[_0x23651a(0xba)][_0x23651a(0xd8)]({'where':{'appId':_0x2f95bd}}),_0x5b14e8=_0x5d1c35[_0x23651a(0xc0)](_0x26b4de=>_0x26b4de['id']);_0x5d1c35[_0x23651a(0xce)]&&await this[_0x23651a(0xba)]['delete']({'id':(0x0,typeorm_1['In'])(_0x5b14e8)});const _0x31bfbe=await this['appEntity'][_0x23651a(0xfa)](_0x2f95bd);if(_0x31bfbe[_0x23651a(0x94)]>0x0)return'删除App成功';throw new common_1[(_0x23651a(0xe1))]('删除App失败！',common_1[_0x23651a(0xe8)][_0x23651a(0xbe)]);}async[_0x46cd5f(0xaf)](_0x4ef158){const _0x57b46f=_0x46cd5f,{id:_0x20ec34}=_0x4ef158,_0x39bb8c=await this['appEntity'][_0x57b46f(0xd6)]({'where':{'id':_0x20ec34,'status':0x3}});if(!_0x39bb8c)throw new common_1[(_0x57b46f(0xe1))](_0x57b46f(0xcd),common_1['HttpStatus']['BAD_REQUEST']);return await this[_0x57b46f(0xf0)][_0x57b46f(0xcc)]({'id':_0x20ec34},{'status':0x5}),await this[_0x57b46f(0xba)]['update']({'appId':_0x20ec34},{'status':0x5}),_0x57b46f(0xee);}async['auditFail'](_0x7e105c){const _0x1eb8d4=_0x46cd5f,{id:_0x5073c6}=_0x7e105c,_0x46ad00=await this[_0x1eb8d4(0xf0)][_0x1eb8d4(0xd6)]({'where':{'id':_0x5073c6,'status':0x3}});if(!_0x46ad00)throw new common_1['HttpException'](_0x1eb8d4(0xcd),common_1[_0x1eb8d4(0xe8)][_0x1eb8d4(0xbe)]);return await this['appEntity']['update']({'id':_0x5073c6},{'status':0x4}),await this[_0x1eb8d4(0xba)]['update']({'appId':_0x5073c6},{'status':0x4}),_0x1eb8d4(0xdb);}async['delMineApp'](_0x43abde,_0x2705ba){const _0x2ec090=_0x46cd5f,{id:_0x3820af}=_0x43abde,_0x353779=await this[_0x2ec090(0xf0)][_0x2ec090(0xd6)]({'where':{'id':_0x3820af,'userId':_0x2705ba[_0x2ec090(0xb7)]['id']}});if(!_0x353779)throw new common_1['HttpException'](_0x2ec090(0xf9),common_1[_0x2ec090(0xe8)][_0x2ec090(0xbe)]);return await this[_0x2ec090(0xf0)][_0x2ec090(0xfa)](_0x3820af),await this[_0x2ec090(0xba)]['delete']({'appId':_0x3820af,'userId':_0x2705ba['user']['id']}),_0x2ec090(0xb5);}async[_0x46cd5f(0x95)](_0x369dde,_0x315b16){const _0x146a90=_0x46cd5f,{appId:_0x660a74}=_0x369dde,{id:_0x2ff076}=_0x315b16[_0x146a90(0xb7)],_0xc90dbd=await this[_0x146a90(0xba)]['findOne']({'where':{'appId':_0x660a74,'userId':_0x2ff076}});if(_0xc90dbd){const _0x356614=await this[_0x146a90(0xba)][_0x146a90(0xfa)]({'appId':_0x660a74,'userId':_0x2ff076});if(_0x356614['affected']>0x0)return _0x146a90(0xde);else throw new common_1[(_0x146a90(0xe1))](_0x146a90(0xd3),common_1[_0x146a90(0xe8)][_0x146a90(0xbe)]);}const _0x1b6701=await this[_0x146a90(0xf0)][_0x146a90(0xd6)]({'where':{'id':_0x660a74}}),{id:_0x4124ab,role:_0x394bdf,catId:_0x554875}=_0x1b6701,_0x30694e={'userId':_0x2ff076,'appId':_0x4124ab,'catId':_0x554875,'appRole':_0x394bdf,'public':!![],'status':0x1};return await this[_0x146a90(0xba)][_0x146a90(0x97)](_0x30694e),_0x146a90(0xc2);}async[_0x46cd5f(0xa0)](_0x4177f2,_0x2a3818={'page':0x1,'size':0x1e}){const _0x1dd260=_0x46cd5f,{id:_0x29a146}=_0x4177f2[_0x1dd260(0xb7)],{page:page=0x1,size:size=0x1e}=_0x2a3818,[_0x5b59f6,_0x5e6437]=await this[_0x1dd260(0xba)][_0x1dd260(0xac)]({'where':{'userId':_0x29a146,'status':(0x0,typeorm_1['In'])([0x1,0x3,0x4,0x5])},'order':{'id':_0x1dd260(0xed)},'skip':(page-0x1)*size,'take':size}),_0x4592ad=_0x5b59f6[_0x1dd260(0xc0)](_0x35f34d=>_0x35f34d[_0x1dd260(0xe9)]),_0x15b347=await this['appEntity'][_0x1dd260(0xd8)]({'where':{'id':(0x0,typeorm_1['In'])(_0x4592ad)}});return _0x5b59f6[_0x1dd260(0xd0)](_0x21a342=>{const _0x4a65ed=_0x1dd260,_0x713e3a=_0x15b347[_0x4a65ed(0xd8)](_0x51406e=>_0x51406e['id']===_0x21a342['appId']);_0x21a342[_0x4a65ed(0xb3)]=_0x713e3a?_0x713e3a[_0x4a65ed(0xa6)]:'',_0x21a342[_0x4a65ed(0xd4)]=_0x713e3a?_0x713e3a['role']:'',_0x21a342['appDes']=_0x713e3a?_0x713e3a[_0x4a65ed(0xc7)]:'',_0x21a342[_0x4a65ed(0xf8)]=_0x713e3a?_0x713e3a[_0x4a65ed(0xf8)]||_0x713e3a[_0x4a65ed(0xeb)]:'',_0x21a342[_0x4a65ed(0xc4)]=_0x713e3a?_0x713e3a[_0x4a65ed(0xc4)]:'',_0x21a342[_0x4a65ed(0x8c)]=(_0x713e3a===null||_0x713e3a===void 0x0?void 0x0:_0x713e3a['userId'])===_0x29a146?_0x713e3a===null||_0x713e3a===void 0x0?void 0x0:_0x713e3a['preset']:_0x4a65ed(0x9a);}),{'rows':_0x5b59f6,'count':_0x5e6437};}};AppService=__decorate([(0x0,common_1[_0x46cd5f(0xd1)])(),__param(0x0,(0x0,typeorm_2[_0x46cd5f(0xf7)])(appCats_entity_1['AppCatsEntity'])),__param(0x1,(0x0,typeorm_2[_0x46cd5f(0xf7)])(app_entity_1[_0x46cd5f(0xc8)])),__param(0x2,(0x0,typeorm_2['InjectRepository'])(userApps_entity_1[_0x46cd5f(0xf4)])),__metadata(_0x46cd5f(0xdd),[typeorm_1[_0x46cd5f(0xc1)],typeorm_1['Repository'],typeorm_1[_0x46cd5f(0xc1)]])],AppService),exports['AppService']=AppService;