'use strict';function _0x41bf(){var _0x486772=['error','name','Processor','OnQueueError','onQueueError','midjourneyService','logger','length','onQueueResumed','onQueueActive','metadata','object','OnQueueCompleted','design:returntype','onQueuePaused','mjDraw','Logger','defineProperty','CONCURRENCY',':\x20绘画失败\x20','drawFailed','onQueueProgress','2978463QxcbFt','Queue\x20cleaned:\x20','onQueueFailed','@nestjs/common','handleJob','12CwIUQQ','OnQueueProgress','log','1758045dtpyyO','onQueueDrained','\x20jobs\x20of\x20type\x20','队列发生错误','__decorate','OnQueueCleaned','527265vOMEKe','53470xPAyjI','../midjourney/midjourney.service','function','onQueueCompleted','OnQueueResumed','__esModule','569266EaSfvc','design:paramtypes','MJDRAW','env','队列任务的一个回调用于通知当前进度','prototype','684IFrRgp','decorate','9445616MRLYBT','MidjourneyService','3467184UmStnh','design:type','getOwnPropertyDescriptor','onQueueCleaned','@nestjs/bull','4XMDEUC','队列暂停的时候调用','Queue\x20failed:\x20','QueueProcessor','data','队列恢复的时候调用'];_0x41bf=function(){return _0x486772;};return _0x41bf();}var _0x71c5e8=_0x3d41;(function(_0x2be54c,_0x3ac21a){var _0x4c9531=_0x3d41,_0x5b341e=_0x2be54c();while(!![]){try{var _0x109daa=-parseInt(_0x4c9531(0x16a))/0x1+-parseInt(_0x4c9531(0x131))/0x2+-parseInt(_0x4c9531(0x15c))/0x3*(-parseInt(_0x4c9531(0x140))/0x4)+parseInt(_0x4c9531(0x164))/0x5*(-parseInt(_0x4c9531(0x161))/0x6)+parseInt(_0x4c9531(0x13b))/0x7+parseInt(_0x4c9531(0x139))/0x8+parseInt(_0x4c9531(0x137))/0x9*(-parseInt(_0x4c9531(0x16b))/0xa);if(_0x109daa===_0x3ac21a)break;else _0x5b341e['push'](_0x5b341e['shift']());}catch(_0x27e024){_0x5b341e['push'](_0x5b341e['shift']());}}}(_0x41bf,0xb6753));function _0x3d41(_0xeae6b,_0x1f50e5){var _0x41bfdb=_0x41bf();return _0x3d41=function(_0x3d4132,_0xc27a85){_0x3d4132=_0x3d4132-0x12e;var _0x17ee81=_0x41bfdb[_0x3d4132];return _0x17ee81;},_0x3d41(_0xeae6b,_0x1f50e5);}var __decorate=this&&this[_0x71c5e8(0x168)]||function(_0x176bda,_0x442c35,_0x2267d8,_0x41f66b){var _0x520184=_0x71c5e8,_0x47785d=arguments['length'],_0x177ff8=_0x47785d<0x3?_0x442c35:_0x41f66b===null?_0x41f66b=Object[_0x520184(0x13d)](_0x442c35,_0x2267d8):_0x41f66b,_0xb63632;if(typeof Reflect===_0x520184(0x151)&&typeof Reflect['decorate']==='function')_0x177ff8=Reflect[_0x520184(0x138)](_0x176bda,_0x442c35,_0x2267d8,_0x41f66b);else{for(var _0x3624ab=_0x176bda[_0x520184(0x14d)]-0x1;_0x3624ab>=0x0;_0x3624ab--)if(_0xb63632=_0x176bda[_0x3624ab])_0x177ff8=(_0x47785d<0x3?_0xb63632(_0x177ff8):_0x47785d>0x3?_0xb63632(_0x442c35,_0x2267d8,_0x177ff8):_0xb63632(_0x442c35,_0x2267d8))||_0x177ff8;}return _0x47785d>0x3&&_0x177ff8&&Object[_0x520184(0x157)](_0x442c35,_0x2267d8,_0x177ff8),_0x177ff8;},__metadata=this&&this['__metadata']||function(_0x45efaf,_0x1394a7){var _0x21d7bb=_0x71c5e8;if(typeof Reflect===_0x21d7bb(0x151)&&typeof Reflect[_0x21d7bb(0x150)]===_0x21d7bb(0x16d))return Reflect[_0x21d7bb(0x150)](_0x45efaf,_0x1394a7);},QueueProcessor_1;Object[_0x71c5e8(0x157)](exports,_0x71c5e8(0x130),{'value':!![]}),exports[_0x71c5e8(0x143)]=void 0x0;const bull_1=require(_0x71c5e8(0x13f)),common_1=require(_0x71c5e8(0x15f)),midjourney_service_1=require(_0x71c5e8(0x16c));let QueueProcessor=QueueProcessor_1=class QueueProcessor{constructor(_0x4fa9af){var _0x51706b=_0x71c5e8;this[_0x51706b(0x14b)]=_0x4fa9af,this[_0x51706b(0x14c)]=new common_1['Logger'](QueueProcessor_1[_0x51706b(0x147)]);}async[_0x71c5e8(0x160)](_0x322373){var _0x49964c=_0x71c5e8;const _0x391173=await this[_0x49964c(0x14b)]['draw'](_0x322373[_0x49964c(0x144)],_0x322373['id']);return _0x391173;}['onQueueActive'](_0xbe0ac0){}[_0x71c5e8(0x14a)](_0x3784c8){var _0x554ded=_0x71c5e8;console[_0x554ded(0x163)](_0x554ded(0x167),_0x3784c8);}[_0x71c5e8(0x15b)](_0x8e01a5,_0x24f4b9){var _0xf27275=_0x71c5e8;console[_0xf27275(0x163)](_0xf27275(0x135),_0x8e01a5['id'],_0x24f4b9);}[_0x71c5e8(0x12e)](_0x2c0c91,_0xc427c5){}[_0x71c5e8(0x15e)](_0x1edcea,_0x2499f8){var _0x23d436=_0x71c5e8;common_1['Logger'][_0x23d436(0x146)](_0x23d436(0x142)+_0x2499f8['message']+_0x23d436(0x159)+_0x1edcea['id'],_0x23d436(0x143)),this['midjourneyService'][_0x23d436(0x15a)](_0x1edcea[_0x23d436(0x144)]);}[_0x71c5e8(0x154)](){var _0x101e55=_0x71c5e8;console[_0x101e55(0x163)](_0x101e55(0x141));}[_0x71c5e8(0x14e)](){var _0x119107=_0x71c5e8;console[_0x119107(0x163)](_0x119107(0x145));}[_0x71c5e8(0x13e)](_0x580c0c,_0x13b69a){var _0x595d96=_0x71c5e8;common_1[_0x595d96(0x156)][_0x595d96(0x163)](_0x595d96(0x15d)+_0x580c0c['length']+_0x595d96(0x166)+_0x13b69a+'\x20were\x20cleaned.',_0x595d96(0x143));}[_0x71c5e8(0x165)](){}};__decorate([(0x0,bull_1['Process'])({'name':_0x71c5e8(0x155),'concurrency':process['env'][_0x71c5e8(0x158)]?+process[_0x71c5e8(0x134)]['CONCURRENCY']:0x3}),__metadata(_0x71c5e8(0x13c),Function),__metadata('design:paramtypes',[Object]),__metadata(_0x71c5e8(0x153),Promise)],QueueProcessor[_0x71c5e8(0x136)],_0x71c5e8(0x160),null),__decorate([(0x0,bull_1['OnQueueActive'])(),__metadata(_0x71c5e8(0x13c),Function),__metadata(_0x71c5e8(0x132),[Object]),__metadata('design:returntype',void 0x0)],QueueProcessor[_0x71c5e8(0x136)],_0x71c5e8(0x14f),null),__decorate([(0x0,bull_1[_0x71c5e8(0x149)])(),__metadata(_0x71c5e8(0x13c),Function),__metadata(_0x71c5e8(0x132),[Error]),__metadata(_0x71c5e8(0x153),void 0x0)],QueueProcessor['prototype'],'onQueueError',null),__decorate([(0x0,bull_1[_0x71c5e8(0x162)])(),__metadata(_0x71c5e8(0x13c),Function),__metadata('design:paramtypes',[Object,Number]),__metadata(_0x71c5e8(0x153),void 0x0)],QueueProcessor[_0x71c5e8(0x136)],'onQueueProgress',null),__decorate([(0x0,bull_1[_0x71c5e8(0x152)])(),__metadata(_0x71c5e8(0x13c),Function),__metadata(_0x71c5e8(0x132),[Object,Object]),__metadata(_0x71c5e8(0x153),void 0x0)],QueueProcessor[_0x71c5e8(0x136)],'onQueueCompleted',null),__decorate([(0x0,bull_1['OnQueueFailed'])(),__metadata(_0x71c5e8(0x13c),Function),__metadata(_0x71c5e8(0x132),[Object,Error]),__metadata(_0x71c5e8(0x153),void 0x0)],QueueProcessor['prototype'],_0x71c5e8(0x15e),null),__decorate([(0x0,bull_1['OnQueuePaused'])(),__metadata('design:type',Function),__metadata(_0x71c5e8(0x132),[]),__metadata(_0x71c5e8(0x153),void 0x0)],QueueProcessor['prototype'],_0x71c5e8(0x154),null),__decorate([(0x0,bull_1[_0x71c5e8(0x12f)])(),__metadata('design:type',Function),__metadata(_0x71c5e8(0x132),[]),__metadata(_0x71c5e8(0x153),void 0x0)],QueueProcessor['prototype'],'onQueueResumed',null),__decorate([(0x0,bull_1[_0x71c5e8(0x169)])(),__metadata('design:type',Function),__metadata(_0x71c5e8(0x132),[Array,String]),__metadata(_0x71c5e8(0x153),void 0x0)],QueueProcessor[_0x71c5e8(0x136)],_0x71c5e8(0x13e),null),__decorate([(0x0,bull_1['OnQueueDrained'])(),__metadata(_0x71c5e8(0x13c),Function),__metadata(_0x71c5e8(0x132),[]),__metadata(_0x71c5e8(0x153),void 0x0)],QueueProcessor['prototype'],_0x71c5e8(0x165),null),QueueProcessor=QueueProcessor_1=__decorate([(0x0,bull_1[_0x71c5e8(0x148)])(_0x71c5e8(0x133)),__metadata('design:paramtypes',[midjourney_service_1[_0x71c5e8(0x13a)]])],QueueProcessor),exports[_0x71c5e8(0x143)]=QueueProcessor;