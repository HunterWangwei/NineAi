'use strict';function _0x458c(_0x661a9,_0x3011d4){var _0x1c2e53=_0x1c2e();return _0x458c=function(_0x458cdb,_0x1ce1c0){_0x458cdb=_0x458cdb-0x82;var _0xc1e85b=_0x1c2e53[_0x458cdb];return _0xc1e85b;},_0x458c(_0x661a9,_0x3011d4);}var _0x275e2f=_0x458c;(function(_0x1b762c,_0x4af281){var _0xe3a9af=_0x458c,_0x5d0e08=_0x1b762c();while(!![]){try{var _0x4aad5d=parseInt(_0xe3a9af(0x91))/0x1+-parseInt(_0xe3a9af(0xb9))/0x2+parseInt(_0xe3a9af(0x83))/0x3+parseInt(_0xe3a9af(0x88))/0x4*(-parseInt(_0xe3a9af(0xa2))/0x5)+parseInt(_0xe3a9af(0xa3))/0x6*(-parseInt(_0xe3a9af(0x8b))/0x7)+parseInt(_0xe3a9af(0xad))/0x8+parseInt(_0xe3a9af(0xbb))/0x9;if(_0x4aad5d===_0x4af281)break;else _0x5d0e08['push'](_0x5d0e08['shift']());}catch(_0x4aa6cd){_0x5d0e08['push'](_0x5d0e08['shift']());}}}(_0x1c2e,0xbd723));var __decorate=this&&this[_0x275e2f(0xb7)]||function(_0x4766cd,_0x39a722,_0x47c20e,_0x17cc19){var _0x422591=_0x275e2f,_0x5ecce2=arguments[_0x422591(0x90)],_0x7e25b6=_0x5ecce2<0x3?_0x39a722:_0x17cc19===null?_0x17cc19=Object[_0x422591(0xa8)](_0x39a722,_0x47c20e):_0x17cc19,_0x1bbee2;if(typeof Reflect===_0x422591(0x95)&&typeof Reflect[_0x422591(0xa0)]===_0x422591(0x8a))_0x7e25b6=Reflect[_0x422591(0xa0)](_0x4766cd,_0x39a722,_0x47c20e,_0x17cc19);else{for(var _0x3cdff3=_0x4766cd[_0x422591(0x90)]-0x1;_0x3cdff3>=0x0;_0x3cdff3--)if(_0x1bbee2=_0x4766cd[_0x3cdff3])_0x7e25b6=(_0x5ecce2<0x3?_0x1bbee2(_0x7e25b6):_0x5ecce2>0x3?_0x1bbee2(_0x39a722,_0x47c20e,_0x7e25b6):_0x1bbee2(_0x39a722,_0x47c20e))||_0x7e25b6;}return _0x5ecce2>0x3&&_0x7e25b6&&Object[_0x422591(0xa6)](_0x39a722,_0x47c20e,_0x7e25b6),_0x7e25b6;},__metadata=this&&this[_0x275e2f(0x94)]||function(_0x1e5227,_0x2a55e9){var _0x4baee8=_0x275e2f;if(typeof Reflect===_0x4baee8(0x95)&&typeof Reflect[_0x4baee8(0x89)]===_0x4baee8(0x8a))return Reflect[_0x4baee8(0x89)](_0x1e5227,_0x2a55e9);},QueueProcessor_1;function _0x1c2e(){var _0x3cff33=['mjDraw','3872628twMoDT','message','handleJob','OnQueueFailed','@nestjs/bull','2235628qUcJKC','metadata','function','2506GAcJEN','onQueueProgress','prototype','env','Queue\x20failed:\x20','length','686530YgrKui','data','onQueueCompleted','__metadata','object','onQueueCleaned','onQueueError','OnQueueError','OnQueueCompleted','design:type','onQueueActive','OnQueueDrained','Process','\x20jobs\x20of\x20type\x20','draw','decorate','design:paramtypes','5xyGIqD','21174ZfoXNH','drawFailed','Queue\x20cleaned:\x20','defineProperty','\x20were\x20cleaned.','getOwnPropertyDescriptor','QueueProcessor','logger','../midjourney/midjourney.service','midjourneyService','1515928HyFRXG','队列恢复的时候调用','队列发生错误','onQueueResumed','CONCURRENCY','MidjourneyService','队列暂停的时候调用','onQueueDrained','队列任务的一个回调用于通知当前进度','onQueuePaused','__decorate','onQueueFailed','1531112Fjifez','design:returntype','10772271pqJdlb',':\x20绘画失败\x20','log','OnQueuePaused','__esModule','OnQueueActive'];_0x1c2e=function(){return _0x3cff33;};return _0x1c2e();}Object[_0x275e2f(0xa6)](exports,_0x275e2f(0xbf),{'value':!![]}),exports[_0x275e2f(0xa9)]=void 0x0;const bull_1=require(_0x275e2f(0x87)),common_1=require('@nestjs/common'),midjourney_service_1=require(_0x275e2f(0xab));let QueueProcessor=QueueProcessor_1=class QueueProcessor{constructor(_0x9bc43a){var _0x5d3f93=_0x275e2f;this[_0x5d3f93(0xac)]=_0x9bc43a,this[_0x5d3f93(0xaa)]=new common_1['Logger'](QueueProcessor_1['name']);}async['handleJob'](_0x590a7c){var _0x1662eb=_0x275e2f;const _0x3e2a53=await this[_0x1662eb(0xac)][_0x1662eb(0x9f)](_0x590a7c[_0x1662eb(0x92)],_0x590a7c['id']);return _0x3e2a53;}[_0x275e2f(0x9b)](_0x162871){}[_0x275e2f(0x97)](_0x7d50d6){var _0xfe72bd=_0x275e2f;console['log'](_0xfe72bd(0xaf),_0x7d50d6);}[_0x275e2f(0x8c)](_0x2055d8,_0x1bfa4d){var _0x3176aa=_0x275e2f;console[_0x3176aa(0xbd)](_0x3176aa(0xb5),_0x2055d8['id'],_0x1bfa4d);}[_0x275e2f(0x93)](_0x44207f,_0x2d9ad3){}[_0x275e2f(0xb8)](_0x209d28,_0x3ce128){var _0x3197db=_0x275e2f;common_1['Logger']['error'](_0x3197db(0x8f)+_0x3ce128[_0x3197db(0x84)]+_0x3197db(0xbc)+_0x209d28['id'],_0x3197db(0xa9)),this['midjourneyService'][_0x3197db(0xa4)](_0x209d28[_0x3197db(0x92)]);}['onQueuePaused'](){var _0x2ab5fe=_0x275e2f;console[_0x2ab5fe(0xbd)](_0x2ab5fe(0xb3));}[_0x275e2f(0xb0)](){var _0x337cd9=_0x275e2f;console[_0x337cd9(0xbd)](_0x337cd9(0xae));}['onQueueCleaned'](_0x20b46e,_0x302c37){var _0x2e4a9d=_0x275e2f;common_1['Logger'][_0x2e4a9d(0xbd)](_0x2e4a9d(0xa5)+_0x20b46e[_0x2e4a9d(0x90)]+_0x2e4a9d(0x9e)+_0x302c37+_0x2e4a9d(0xa7),'QueueProcessor');}[_0x275e2f(0xb4)](){}};__decorate([(0x0,bull_1[_0x275e2f(0x9d)])({'name':_0x275e2f(0x82),'concurrency':process[_0x275e2f(0x8e)]['CONCURRENCY']?+process[_0x275e2f(0x8e)][_0x275e2f(0xb1)]:0x3}),__metadata('design:type',Function),__metadata(_0x275e2f(0xa1),[Object]),__metadata(_0x275e2f(0xba),Promise)],QueueProcessor[_0x275e2f(0x8d)],_0x275e2f(0x85),null),__decorate([(0x0,bull_1[_0x275e2f(0xc0)])(),__metadata(_0x275e2f(0x9a),Function),__metadata(_0x275e2f(0xa1),[Object]),__metadata(_0x275e2f(0xba),void 0x0)],QueueProcessor[_0x275e2f(0x8d)],_0x275e2f(0x9b),null),__decorate([(0x0,bull_1[_0x275e2f(0x98)])(),__metadata('design:type',Function),__metadata(_0x275e2f(0xa1),[Error]),__metadata(_0x275e2f(0xba),void 0x0)],QueueProcessor[_0x275e2f(0x8d)],_0x275e2f(0x97),null),__decorate([(0x0,bull_1['OnQueueProgress'])(),__metadata(_0x275e2f(0x9a),Function),__metadata('design:paramtypes',[Object,Number]),__metadata(_0x275e2f(0xba),void 0x0)],QueueProcessor[_0x275e2f(0x8d)],_0x275e2f(0x8c),null),__decorate([(0x0,bull_1[_0x275e2f(0x99)])(),__metadata('design:type',Function),__metadata(_0x275e2f(0xa1),[Object,Object]),__metadata('design:returntype',void 0x0)],QueueProcessor['prototype'],_0x275e2f(0x93),null),__decorate([(0x0,bull_1[_0x275e2f(0x86)])(),__metadata('design:type',Function),__metadata(_0x275e2f(0xa1),[Object,Error]),__metadata(_0x275e2f(0xba),void 0x0)],QueueProcessor['prototype'],'onQueueFailed',null),__decorate([(0x0,bull_1[_0x275e2f(0xbe)])(),__metadata(_0x275e2f(0x9a),Function),__metadata(_0x275e2f(0xa1),[]),__metadata(_0x275e2f(0xba),void 0x0)],QueueProcessor['prototype'],_0x275e2f(0xb6),null),__decorate([(0x0,bull_1['OnQueueResumed'])(),__metadata(_0x275e2f(0x9a),Function),__metadata('design:paramtypes',[]),__metadata(_0x275e2f(0xba),void 0x0)],QueueProcessor['prototype'],_0x275e2f(0xb0),null),__decorate([(0x0,bull_1['OnQueueCleaned'])(),__metadata(_0x275e2f(0x9a),Function),__metadata('design:paramtypes',[Array,String]),__metadata('design:returntype',void 0x0)],QueueProcessor[_0x275e2f(0x8d)],_0x275e2f(0x96),null),__decorate([(0x0,bull_1[_0x275e2f(0x9c)])(),__metadata(_0x275e2f(0x9a),Function),__metadata(_0x275e2f(0xa1),[]),__metadata(_0x275e2f(0xba),void 0x0)],QueueProcessor[_0x275e2f(0x8d)],_0x275e2f(0xb4),null),QueueProcessor=QueueProcessor_1=__decorate([(0x0,bull_1['Processor'])('MJDRAW'),__metadata(_0x275e2f(0xa1),[midjourney_service_1[_0x275e2f(0xb2)]])],QueueProcessor),exports[_0x275e2f(0xa9)]=QueueProcessor;