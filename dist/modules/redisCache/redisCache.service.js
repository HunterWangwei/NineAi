'use strict';function _0xd11f(){const _0x3f9262=['4481092HHfOXd','tokens:','BAD_REQUEST','172lWMZEP','getOwnPropertyDescriptor','REDIS_CLIENT','token:','31969611FKWDkJ','length','decorate','UNAUTHORIZED','invalidateTokens','function','30xOVATI','38414UqCudZ','forEach','HttpStatus','user','super','redisClient','metadata','defineProperty','visitor','@nestjs/common','__metadata','aaa','includes','set','zRange','3120660nEaLWq','982056lprrXN','del','Inject','__decorate','10wGnMRQ','expire','ttl','test','onModuleInit','object','__esModule','2478670zNkbVB','saveToken','您已在其他设备覆盖登录、请您重新登录！','get','HttpException','62097hyZDKs'];_0xd11f=function(){return _0x3f9262;};return _0xd11f();}const _0x2bdf9e=_0xc471;(function(_0x85f03,_0x491e88){const _0x2023a8=_0xc471,_0x23e3cd=_0x85f03();while(!![]){try{const _0x141885=parseInt(_0x2023a8(0x183))/0x1*(-parseInt(_0x2023a8(0x184))/0x2)+parseInt(_0x2023a8(0x1a4))/0x3*(-parseInt(_0x2023a8(0x1a8))/0x4)+-parseInt(_0x2023a8(0x19f))/0x5+-parseInt(_0x2023a8(0x193))/0x6+-parseInt(_0x2023a8(0x1a5))/0x7+parseInt(_0x2023a8(0x194))/0x8+-parseInt(_0x2023a8(0x17d))/0x9*(-parseInt(_0x2023a8(0x198))/0xa);if(_0x141885===_0x491e88)break;else _0x23e3cd['push'](_0x23e3cd['shift']());}catch(_0x2eeb37){_0x23e3cd['push'](_0x23e3cd['shift']());}}}(_0xd11f,0x86edd));var __decorate=this&&this[_0x2bdf9e(0x197)]||function(_0x1a6bd9,_0x1a9921,_0x1d2b2f,_0x16bd54){const _0x43c499=_0x2bdf9e;var _0x23b3ce=arguments[_0x43c499(0x17e)],_0x12ff55=_0x23b3ce<0x3?_0x1a9921:_0x16bd54===null?_0x16bd54=Object[_0x43c499(0x17a)](_0x1a9921,_0x1d2b2f):_0x16bd54,_0xfd8103;if(typeof Reflect===_0x43c499(0x19d)&&typeof Reflect[_0x43c499(0x17f)]==='function')_0x12ff55=Reflect[_0x43c499(0x17f)](_0x1a6bd9,_0x1a9921,_0x1d2b2f,_0x16bd54);else{for(var _0x1fd26c=_0x1a6bd9[_0x43c499(0x17e)]-0x1;_0x1fd26c>=0x0;_0x1fd26c--)if(_0xfd8103=_0x1a6bd9[_0x1fd26c])_0x12ff55=(_0x23b3ce<0x3?_0xfd8103(_0x12ff55):_0x23b3ce>0x3?_0xfd8103(_0x1a9921,_0x1d2b2f,_0x12ff55):_0xfd8103(_0x1a9921,_0x1d2b2f))||_0x12ff55;}return _0x23b3ce>0x3&&_0x12ff55&&Object[_0x43c499(0x18b)](_0x1a9921,_0x1d2b2f,_0x12ff55),_0x12ff55;},__metadata=this&&this[_0x2bdf9e(0x18e)]||function(_0x5a02ee,_0x2f038a){const _0x37f310=_0x2bdf9e;if(typeof Reflect===_0x37f310(0x19d)&&typeof Reflect[_0x37f310(0x18a)]===_0x37f310(0x182))return Reflect['metadata'](_0x5a02ee,_0x2f038a);},__param=this&&this['__param']||function(_0x244042,_0x41b0bf){return function(_0x3da471,_0x5663bf){_0x41b0bf(_0x3da471,_0x5663bf,_0x244042);};};Object[_0x2bdf9e(0x18b)](exports,_0x2bdf9e(0x19e),{'value':!![]}),exports['RedisCacheService']=void 0x0;function _0xc471(_0x1085c9,_0x294d7e){const _0xd11f5a=_0xd11f();return _0xc471=function(_0xc47168,_0x4f9ae5){_0xc47168=_0xc47168-0x17a;let _0x5c59da=_0xd11f5a[_0xc47168];return _0x5c59da;},_0xc471(_0x1085c9,_0x294d7e);}const common_1=require(_0x2bdf9e(0x18d));let RedisCacheService=class RedisCacheService{constructor(_0x3442af){const _0x4933ca=_0x2bdf9e;this[_0x4933ca(0x189)]=_0x3442af;}async[_0x2bdf9e(0x19c)](){}[_0x2bdf9e(0x19b)](){const _0x57900c=_0x2bdf9e;return this['redisClient']['set'](_0x57900c(0x18f),0x6f),0x1;}async[_0x2bdf9e(0x1a2)](_0x346c12){const _0x483948=_0x2bdf9e,{key:_0x41fc81}=_0x346c12,_0x37d84c=await this['redisClient'][_0x483948(0x1a2)](_0x41fc81);return await this['redisClient'][_0x483948(0x1a2)](_0x41fc81);}async[_0x2bdf9e(0x191)](_0x2b3283,_0x4d4c4f){const _0x32bdff=_0x2bdf9e;try{const {key:_0x139a40,val:_0x29dd94}=_0x2b3283;await this[_0x32bdff(0x189)][_0x32bdff(0x191)](_0x139a40,_0x29dd94),_0x4d4c4f&&await this['redisClient'][_0x32bdff(0x199)](_0x139a40,_0x4d4c4f);return;}catch(_0x799476){throw new common_1[(_0x32bdff(0x1a3))](_0x799476,common_1[_0x32bdff(0x186)][_0x32bdff(0x1a7)]);}}async[_0x2bdf9e(0x19a)](_0x1316c4){const _0x220935=_0x2bdf9e;return await this[_0x220935(0x189)][_0x220935(0x19a)](_0x1316c4);}async['del'](_0x2ab66a){const _0x27730c=_0x2bdf9e,{key:_0x33714d}=_0x2ab66a;await this[_0x27730c(0x189)][_0x27730c(0x195)](_0x33714d);return;}async[_0x2bdf9e(0x1a0)](_0xaa4b4a,_0x47e410){const _0x511c31=_0x2bdf9e,_0x5cbd05=await this[_0x511c31(0x189)][_0x511c31(0x192)](_0x511c31(0x1a6)+_0xaa4b4a,0x0,-0x1);await this['invalidateTokens'](_0xaa4b4a,_0x5cbd05),this['redisClient'][_0x511c31(0x191)](_0x511c31(0x17c)+_0xaa4b4a,_0x47e410);}async[_0x2bdf9e(0x181)](_0x2469d5,_0x2c7f1f){const _0x4e1ed2=_0x2bdf9e;_0x2c7f1f[_0x4e1ed2(0x185)](_0x59ab88=>{const _0x3398c7=_0x4e1ed2;this[_0x3398c7(0x189)]['del'](_0x3398c7(0x17c)+_0x2469d5+':'+_0x59ab88);});}async['checkTokenAuth'](_0x235a78,_0x3f71c6){const _0x35f70e=_0x2bdf9e,{id:_0x5c7262,role:_0x35b78f}=_0x3f71c6[_0x35f70e(0x187)];if(_0x35b78f===_0x35f70e(0x18c))return!![];const _0x3da147=await this['redisClient'][_0x35f70e(0x1a2)](_0x35f70e(0x17c)+_0x5c7262);if(_0x3da147===null)return await this['redisClient'][_0x35f70e(0x191)](_0x35f70e(0x17c)+_0x5c7262,_0x235a78),!![];if(_0x3da147!==_0x235a78){if([_0x35f70e(0x188),'admin'][_0x35f70e(0x190)](_0x35b78f))return!![];throw new common_1[(_0x35f70e(0x1a3))](_0x35f70e(0x1a1),common_1[_0x35f70e(0x186)][_0x35f70e(0x180)]);}}};RedisCacheService=__decorate([(0x0,common_1['Injectable'])(),__param(0x0,(0x0,common_1[_0x2bdf9e(0x196)])(_0x2bdf9e(0x17b))),__metadata('design:paramtypes',[Object])],RedisCacheService),exports['RedisCacheService']=RedisCacheService;