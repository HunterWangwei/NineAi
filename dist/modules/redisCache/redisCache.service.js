'use strict';const _0x4e72f5=_0x256d;(function(_0x1302d3,_0x446c59){const _0x5b0330=_0x256d,_0x3e5d62=_0x1302d3();while(!![]){try{const _0x1e05b8=-parseInt(_0x5b0330(0xc4))/0x1*(parseInt(_0x5b0330(0xc1))/0x2)+-parseInt(_0x5b0330(0xa0))/0x3*(-parseInt(_0x5b0330(0xa8))/0x4)+-parseInt(_0x5b0330(0xb0))/0x5+-parseInt(_0x5b0330(0xc2))/0x6*(parseInt(_0x5b0330(0xa6))/0x7)+parseInt(_0x5b0330(0xa5))/0x8+-parseInt(_0x5b0330(0x9f))/0x9*(parseInt(_0x5b0330(0xb5))/0xa)+parseInt(_0x5b0330(0xa4))/0xb;if(_0x1e05b8===_0x446c59)break;else _0x3e5d62['push'](_0x3e5d62['shift']());}catch(_0x2eeb07){_0x3e5d62['push'](_0x3e5d62['shift']());}}}(_0x375e,0xa4618));function _0x256d(_0x8e0305,_0x3b4d1d){const _0x375e98=_0x375e();return _0x256d=function(_0x256dbf,_0x3a8182){_0x256dbf=_0x256dbf-0x97;let _0x55aaf6=_0x375e98[_0x256dbf];return _0x55aaf6;},_0x256d(_0x8e0305,_0x3b4d1d);}function _0x375e(){const _0x44b782=['40520RozdqE','6MzbkDx','defineProperty','65ukSBLK','visitor','redisClient','set','__param','checkTokenAuth','metadata','forEach','decorate','18CkvNyg','547521eNgAcg','get','Inject','token:','31841810oJbxcW','161536HzQYBy','672574fgZoeo','您已在其他设备覆盖登录、请您重新登录！','12xKJRCg','invalidateTokens','RedisCacheService','ttl','design:paramtypes','UNAUTHORIZED','includes','del','2113855SZgPRU','BAD_REQUEST','HttpException','HttpStatus','__esModule','4766830JcvbbC','onModuleInit','getOwnPropertyDescriptor','REDIS_CLIENT','tokens:','aaa','Injectable','function','length','saveToken','__metadata','expire'];_0x375e=function(){return _0x44b782;};return _0x375e();}var __decorate=this&&this['__decorate']||function(_0x1bc1a1,_0xc9bf7a,_0xda94f8,_0x53bd7c){const _0x167401=_0x256d;var _0x3591db=arguments['length'],_0x2970ba=_0x3591db<0x3?_0xc9bf7a:_0x53bd7c===null?_0x53bd7c=Object[_0x167401(0xb7)](_0xc9bf7a,_0xda94f8):_0x53bd7c,_0x3a661b;if(typeof Reflect==='object'&&typeof Reflect[_0x167401(0x9e)]===_0x167401(0xbc))_0x2970ba=Reflect[_0x167401(0x9e)](_0x1bc1a1,_0xc9bf7a,_0xda94f8,_0x53bd7c);else{for(var _0x65b970=_0x1bc1a1[_0x167401(0xbd)]-0x1;_0x65b970>=0x0;_0x65b970--)if(_0x3a661b=_0x1bc1a1[_0x65b970])_0x2970ba=(_0x3591db<0x3?_0x3a661b(_0x2970ba):_0x3591db>0x3?_0x3a661b(_0xc9bf7a,_0xda94f8,_0x2970ba):_0x3a661b(_0xc9bf7a,_0xda94f8))||_0x2970ba;}return _0x3591db>0x3&&_0x2970ba&&Object[_0x167401(0xc3)](_0xc9bf7a,_0xda94f8,_0x2970ba),_0x2970ba;},__metadata=this&&this[_0x4e72f5(0xbf)]||function(_0x5a919e,_0x5de6ed){const _0x4db953=_0x4e72f5;if(typeof Reflect==='object'&&typeof Reflect[_0x4db953(0x9c)]===_0x4db953(0xbc))return Reflect[_0x4db953(0x9c)](_0x5a919e,_0x5de6ed);},__param=this&&this[_0x4e72f5(0x9a)]||function(_0x3cf979,_0x3d5f3f){return function(_0x216766,_0x3cda88){_0x3d5f3f(_0x216766,_0x3cda88,_0x3cf979);};};Object[_0x4e72f5(0xc3)](exports,_0x4e72f5(0xb4),{'value':!![]}),exports[_0x4e72f5(0xaa)]=void 0x0;const common_1=require('@nestjs/common');let RedisCacheService=class RedisCacheService{constructor(_0x2d15f1){const _0x10a9ca=_0x4e72f5;this[_0x10a9ca(0x98)]=_0x2d15f1;}async[_0x4e72f5(0xb6)](){}['test'](){const _0x17a47f=_0x4e72f5;return this['redisClient'][_0x17a47f(0x99)](_0x17a47f(0xba),0x6f),0x1;}async[_0x4e72f5(0xa1)](_0x1464b9){const _0x758655=_0x4e72f5,{key:_0x4f4aec}=_0x1464b9,_0x554204=await this[_0x758655(0x98)][_0x758655(0xa1)](_0x4f4aec);return await this[_0x758655(0x98)][_0x758655(0xa1)](_0x4f4aec);}async[_0x4e72f5(0x99)](_0x23d894,_0xb17d09){const _0x469464=_0x4e72f5;try{const {key:_0xdae2ef,val:_0x4b3725}=_0x23d894;await this['redisClient'][_0x469464(0x99)](_0xdae2ef,_0x4b3725),_0xb17d09&&await this[_0x469464(0x98)][_0x469464(0xc0)](_0xdae2ef,_0xb17d09);return;}catch(_0xe7dff1){throw new common_1[(_0x469464(0xb2))](_0xe7dff1,common_1[_0x469464(0xb3)][_0x469464(0xb1)]);}}async[_0x4e72f5(0xab)](_0x499e13){const _0x44b55b=_0x4e72f5;return await this[_0x44b55b(0x98)]['ttl'](_0x499e13);}async[_0x4e72f5(0xaf)](_0x20ba53){const _0x419f28=_0x4e72f5,{key:_0x2a8b63}=_0x20ba53;await this[_0x419f28(0x98)][_0x419f28(0xaf)](_0x2a8b63);return;}async[_0x4e72f5(0xbe)](_0x39ccf3,_0x332477){const _0x163e10=_0x4e72f5,_0xc70e8=await this[_0x163e10(0x98)]['zRange'](_0x163e10(0xb9)+_0x39ccf3,0x0,-0x1);await this['invalidateTokens'](_0x39ccf3,_0xc70e8),this[_0x163e10(0x98)]['set'](_0x163e10(0xa3)+_0x39ccf3,_0x332477);}async[_0x4e72f5(0xa9)](_0x53e7a6,_0x1cf6af){const _0xa10fde=_0x4e72f5;_0x1cf6af[_0xa10fde(0x9d)](_0x54748b=>{const _0x1ef63=_0xa10fde;this[_0x1ef63(0x98)][_0x1ef63(0xaf)](_0x1ef63(0xa3)+_0x53e7a6+':'+_0x54748b);});}async[_0x4e72f5(0x9b)](_0x5a5b17,_0x5320d2){const _0x436081=_0x4e72f5,{id:_0x210438,role:_0x5d8321}=_0x5320d2['user'];if(_0x5d8321===_0x436081(0x97))return!![];const _0x1bfbe0=await this['redisClient'][_0x436081(0xa1)](_0x436081(0xa3)+_0x210438);if(_0x1bfbe0===null)return await this[_0x436081(0x98)][_0x436081(0x99)](_0x436081(0xa3)+_0x210438,_0x5a5b17),!![];if(_0x1bfbe0!==_0x5a5b17){if(['super','admin'][_0x436081(0xae)](_0x5d8321))return!![];throw new common_1[(_0x436081(0xb2))](_0x436081(0xa7),common_1[_0x436081(0xb3)][_0x436081(0xad)]);}}};RedisCacheService=__decorate([(0x0,common_1[_0x4e72f5(0xbb)])(),__param(0x0,(0x0,common_1[_0x4e72f5(0xa2)])(_0x4e72f5(0xb8))),__metadata(_0x4e72f5(0xac),[Object])],RedisCacheService),exports[_0x4e72f5(0xaa)]=RedisCacheService;