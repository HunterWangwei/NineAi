'use strict';const _0x1942ea=_0x5644;(function(_0x3e7f5e,_0x4e6592){const _0x2c7345=_0x5644,_0x20b585=_0x3e7f5e();while(!![]){try{const _0x5ef02f=-parseInt(_0x2c7345(0x161))/0x1*(-parseInt(_0x2c7345(0x163))/0x2)+parseInt(_0x2c7345(0x16b))/0x3+parseInt(_0x2c7345(0x14f))/0x4+parseInt(_0x2c7345(0x156))/0x5*(-parseInt(_0x2c7345(0x15e))/0x6)+-parseInt(_0x2c7345(0x169))/0x7+-parseInt(_0x2c7345(0x16e))/0x8*(-parseInt(_0x2c7345(0x17a))/0x9)+parseInt(_0x2c7345(0x159))/0xa;if(_0x5ef02f===_0x4e6592)break;else _0x20b585['push'](_0x20b585['shift']());}catch(_0x4042d0){_0x20b585['push'](_0x20b585['shift']());}}}(_0xddf6,0x8271f));Object['defineProperty'](exports,_0x1942ea(0x14d),{'value':!![]}),exports[_0x1942ea(0x15a)]=exports['compilerStream']=exports['compilerMetaJsonStr']=exports[_0x1942ea(0x167)]=void 0x0;function _0x5644(_0x491be1,_0x117d30){const _0xddf6a9=_0xddf6();return _0x5644=function(_0x5644a6,_0x1b0024){_0x5644a6=_0x5644a6-0x14d;let _0x54c73d=_0xddf6a9[_0x5644a6];return _0x54c73d;},_0x5644(_0x491be1,_0x117d30);}const axios=require(_0x1942ea(0x172)),jwt=require(_0x1942ea(0x177));function generateToken(_0x479fbc,_0x1f95f4=0x3e8*0x3c*0x3c*0x18*0x168){const _0x495c6d=_0x1942ea,[_0x5a8a64,_0x413545]=_0x479fbc[_0x495c6d(0x157)]('.'),_0x1ce220={'api_key':_0x5a8a64,'exp':Math[_0x495c6d(0x178)](Date[_0x495c6d(0x158)]())+_0x1f95f4*0x3e8,'timestamp':Math[_0x495c6d(0x178)](Date[_0x495c6d(0x158)]())};return jwt[_0x495c6d(0x160)](_0x1ce220,_0x413545,{'algorithm':_0x495c6d(0x16d),'header':{'alg':_0x495c6d(0x16d),'sign_type':_0x495c6d(0x155)}});}exports[_0x1942ea(0x167)]=generateToken;function _0xddf6(){const _0x13f855=['SIGN','8275JwSAhK','split','now','467950cJpwSs','sendMessageFromZhipu','toString','then','data:','3750ZXSTPy','https://open.bigmodel.cn/api/paas/v3/model-api/','sign','1gNucNS','meta:','1851054RLjtWj','compilerMetaJsonStr','usage','length','generateToken','compilerStream','2741543ISqtpk','data','1226046LtuKMp','trim','HS256','24bGQhbO','error:\x20','application/json','text','axios','id:','parse','stream','error','jsonwebtoken','round','replace','1430361uzqETs','__esModule','event:','410144Jalnja','is_end','log','json\x20parse\x20error\x20from\x20zhipu!','POST','/sse-invoke'];_0xddf6=function(){return _0x13f855;};return _0xddf6();}function compilerMetaJsonStr(_0x2a1444){const _0x2463ce=_0x1942ea;let _0x775417={};try{_0x775417=JSON[_0x2463ce(0x174)](_0x2a1444);}catch(_0x280cbb){_0x775417={'usage':{'completion_tokens':0x31,'prompt_tokens':0x14d,'total_tokens':0x18f}},console[_0x2463ce(0x176)](_0x2463ce(0x152),_0x2a1444);}return _0x775417;}exports[_0x1942ea(0x164)]=compilerMetaJsonStr;function compilerStream(_0x624395){const _0x405a2e=_0x1942ea;var _0x1f69b6;if(_0x624395['length']===0x3)return{'event':_0x624395[0x0][_0x405a2e(0x179)](_0x405a2e(0x14e),''),'id':_0x624395[0x1]['replace'](_0x405a2e(0x173),''),'is_end':![],'result':_0x624395[0x2]['replace'](_0x405a2e(0x15d),'')['trim']()};if(_0x624395[_0x405a2e(0x166)]===0x4)return{'event':_0x624395[0x0][_0x405a2e(0x179)](_0x405a2e(0x14e),''),'id':_0x624395[0x1][_0x405a2e(0x179)](_0x405a2e(0x173),''),'result':_0x624395[0x2]['replace'](_0x405a2e(0x15d),'')[_0x405a2e(0x16c)](),'is_end':!![],'usage':(_0x1f69b6=compilerMetaJsonStr(_0x624395[0x3][_0x405a2e(0x179)](_0x405a2e(0x162),'')))===null||_0x1f69b6===void 0x0?void 0x0:_0x1f69b6[_0x405a2e(0x165)]};}exports[_0x1942ea(0x168)]=compilerStream;async function sendMessageFromZhipu(_0x500195,{onProgress:_0x28c7bb,key:_0x525cd1,model:_0x110d49,temperature:temperature=0.95}){const _0x27d639=await generateToken(_0x525cd1);return new Promise((_0x21b091,_0x42e7cb)=>{const _0x5cd63e=_0x5644,_0x4c4214=_0x5cd63e(0x15f)+_0x110d49+_0x5cd63e(0x154),_0x4876c9={'method':_0x5cd63e(0x153),'url':_0x4c4214,'responseType':_0x5cd63e(0x175),'headers':{'Content-Type':_0x5cd63e(0x170),'Authorization':_0x27d639},'data':{'prompt':_0x500195,'temperature':temperature}};axios(_0x4876c9)[_0x5cd63e(0x15c)](_0x4789e1=>{const _0x2e5c58=_0x5cd63e,_0x334df2=_0x4789e1['data'];let _0x3d9e97,_0x5d4e34='';_0x334df2['on'](_0x2e5c58(0x16a),_0x1a9a4b=>{const _0x3ca092=_0x2e5c58,_0x41c1e2=_0x1a9a4b[_0x3ca092(0x15b)]()[_0x3ca092(0x157)]('\x0a')['filter'](_0x5dff49=>_0x5dff49[_0x3ca092(0x16c)]()!==''),_0x38dd62=compilerStream(_0x41c1e2);if(!_0x38dd62)return;const {id:_0x24ff4e,result:_0x315415,is_end:_0x5de4a9}=_0x38dd62;_0x315415&&(_0x5d4e34+=_0x315415['trim']()),_0x5de4a9&&(_0x38dd62[_0x3ca092(0x150)]=![],_0x3d9e97=_0x38dd62,_0x3d9e97[_0x3ca092(0x171)]=_0x5d4e34),_0x28c7bb(_0x38dd62);}),_0x334df2['on']('end',()=>{_0x21b091(_0x3d9e97),_0x5d4e34='';});})['catch'](_0xee2211=>{const _0x3dd886=_0x5cd63e;console[_0x3dd886(0x151)](_0x3dd886(0x16f),_0xee2211);});});}exports[_0x1942ea(0x15a)]=sendMessageFromZhipu;