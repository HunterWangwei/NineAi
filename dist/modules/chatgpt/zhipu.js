'use strict';const _0xa3c1fb=_0x3a9e;(function(_0x23f480,_0x7589e1){const _0x42fd6b=_0x3a9e,_0x85aba1=_0x23f480();while(!![]){try{const _0x4b024c=parseInt(_0x42fd6b(0xda))/0x1*(parseInt(_0x42fd6b(0xe6))/0x2)+parseInt(_0x42fd6b(0xf4))/0x3+parseInt(_0x42fd6b(0xee))/0x4+-parseInt(_0x42fd6b(0xe2))/0x5+-parseInt(_0x42fd6b(0xd5))/0x6*(parseInt(_0x42fd6b(0xf9))/0x7)+-parseInt(_0x42fd6b(0xf6))/0x8*(-parseInt(_0x42fd6b(0xd9))/0x9)+-parseInt(_0x42fd6b(0xdc))/0xa;if(_0x4b024c===_0x7589e1)break;else _0x85aba1['push'](_0x85aba1['shift']());}catch(_0x22ae0d){_0x85aba1['push'](_0x85aba1['shift']());}}}(_0x28ab,0x891b8));Object[_0xa3c1fb(0xe1)](exports,_0xa3c1fb(0xf0),{'value':!![]}),exports[_0xa3c1fb(0xd2)]=exports[_0xa3c1fb(0xd6)]=exports[_0xa3c1fb(0xfa)]=exports[_0xa3c1fb(0xf8)]=void 0x0;const axios=require(_0xa3c1fb(0xd8)),jwt=require(_0xa3c1fb(0xe0));function generateToken(_0x2ee9ce,_0x3263bf=0x3e8*0x3c*0x3c*0x18*0x168){const _0x31ea35=_0xa3c1fb,[_0x1fdaa8,_0x3eba3f]=_0x2ee9ce[_0x31ea35(0xec)]('.'),_0x437c03={'api_key':_0x1fdaa8,'exp':Math[_0x31ea35(0xed)](Date[_0x31ea35(0xea)]())+_0x3263bf*0x3e8,'timestamp':Math[_0x31ea35(0xed)](Date[_0x31ea35(0xea)]())};return jwt[_0x31ea35(0xef)](_0x437c03,_0x3eba3f,{'algorithm':_0x31ea35(0xf7),'header':{'alg':_0x31ea35(0xf7),'sign_type':_0x31ea35(0xdf)}});}function _0x28ab(){const _0x5429ad=['sign','__esModule','event:','error','https://open.bigmodel.cn/api/paas/v3/model-api/','3264168GQLvQS','replace','665360lPPEZs','HS256','generateToken','7LaMJtR','compilerMetaJsonStr','text','meta:','end','then','id:','sendMessageFromZhipu','json\x20parse\x20error\x20from\x20zhipu!','stream','4396386dBaRgx','compilerStream','is_end','axios','90rEmASV','559948luapwh','/sse-invoke','16403070IobAQZ','catch','data','SIGN','jsonwebtoken','defineProperty','1374895beLljo','error:\x20','application/json','trim','2vnJcLe','toString','usage','data:','now','parse','split','round','2919620IBQZMT'];_0x28ab=function(){return _0x5429ad;};return _0x28ab();}exports[_0xa3c1fb(0xf8)]=generateToken;function _0x3a9e(_0x441681,_0x504002){const _0x28ab1a=_0x28ab();return _0x3a9e=function(_0x3a9ea0,_0x3b4066){_0x3a9ea0=_0x3a9ea0-0xcd;let _0x54feba=_0x28ab1a[_0x3a9ea0];return _0x54feba;},_0x3a9e(_0x441681,_0x504002);}function compilerMetaJsonStr(_0x3a6018){const _0x571767=_0xa3c1fb;let _0x4e9cc3={};try{_0x4e9cc3=JSON[_0x571767(0xeb)](_0x3a6018);}catch(_0x36ccd8){_0x4e9cc3={'usage':{'completion_tokens':0x31,'prompt_tokens':0x14d,'total_tokens':0x18f}},console[_0x571767(0xf2)](_0x571767(0xd3),_0x3a6018);}return _0x4e9cc3;}exports[_0xa3c1fb(0xfa)]=compilerMetaJsonStr;function compilerStream(_0x4f9931){const _0x102958=_0xa3c1fb;var _0x38aa5e;if(_0x4f9931['length']===0x3)return{'event':_0x4f9931[0x0][_0x102958(0xf5)]('event:',''),'id':_0x4f9931[0x1][_0x102958(0xf5)]('id:',''),'is_end':![],'result':_0x4f9931[0x2][_0x102958(0xf5)](_0x102958(0xe9),'')['trim']()};if(_0x4f9931['length']===0x4)return{'event':_0x4f9931[0x0][_0x102958(0xf5)](_0x102958(0xf1),''),'id':_0x4f9931[0x1]['replace'](_0x102958(0xd1),''),'result':_0x4f9931[0x2][_0x102958(0xf5)]('data:','')[_0x102958(0xe5)](),'is_end':!![],'usage':(_0x38aa5e=compilerMetaJsonStr(_0x4f9931[0x3][_0x102958(0xf5)](_0x102958(0xce),'')))===null||_0x38aa5e===void 0x0?void 0x0:_0x38aa5e[_0x102958(0xe8)]};}exports[_0xa3c1fb(0xd6)]=compilerStream;async function sendMessageFromZhipu(_0x353ec5,{onProgress:_0x5f086d,key:_0x5ca108,model:_0x470ca2,temperature:temperature=0.95}){const _0x2dbec8=await generateToken(_0x5ca108);return new Promise((_0x2bfd7e,_0x4c0cf6)=>{const _0x479f21=_0x3a9e,_0x4a28f1=_0x479f21(0xf3)+_0x470ca2+_0x479f21(0xdb),_0x50417c={'method':'POST','url':_0x4a28f1,'responseType':_0x479f21(0xd4),'headers':{'Content-Type':_0x479f21(0xe4),'Authorization':_0x2dbec8},'data':{'prompt':_0x353ec5,'temperature':temperature}};axios(_0x50417c)[_0x479f21(0xd0)](_0x4573d1=>{const _0x1bd038=_0x479f21,_0xe9a23d=_0x4573d1['data'];let _0x289eb9,_0x4128ff='';_0xe9a23d['on'](_0x1bd038(0xde),_0x6a110c=>{const _0x209c7e=_0x1bd038,_0x1f5604=_0x6a110c[_0x209c7e(0xe7)]()[_0x209c7e(0xec)]('\x0a')['filter'](_0x1209ed=>_0x1209ed[_0x209c7e(0xe5)]()!==''),_0x5361fb=compilerStream(_0x1f5604);if(!_0x5361fb)return;const {id:_0x23012f,result:_0x47ad8e,is_end:_0x855d09}=_0x5361fb;_0x47ad8e&&(_0x4128ff+=_0x47ad8e[_0x209c7e(0xe5)]()),_0x855d09&&(_0x5361fb[_0x209c7e(0xd7)]=![],_0x289eb9=_0x5361fb,_0x289eb9[_0x209c7e(0xcd)]=_0x4128ff),_0x5f086d(_0x5361fb);}),_0xe9a23d['on'](_0x1bd038(0xcf),()=>{_0x2bfd7e(_0x289eb9),_0x4128ff='';});})[_0x479f21(0xdd)](_0x1ca487=>{const _0x101ac0=_0x479f21;console['log'](_0x101ac0(0xe3),_0x1ca487);});});}exports['sendMessageFromZhipu']=sendMessageFromZhipu;