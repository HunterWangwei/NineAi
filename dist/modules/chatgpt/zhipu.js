'use strict';const _0xcab8ed=_0x33d9;(function(_0x1a093d,_0x164c63){const _0x7033b7=_0x33d9,_0x399fbe=_0x1a093d();while(!![]){try{const _0x1a01b7=parseInt(_0x7033b7(0x1a5))/0x1+parseInt(_0x7033b7(0x192))/0x2*(parseInt(_0x7033b7(0x18f))/0x3)+-parseInt(_0x7033b7(0x18a))/0x4*(-parseInt(_0x7033b7(0x194))/0x5)+parseInt(_0x7033b7(0x19b))/0x6*(parseInt(_0x7033b7(0x19d))/0x7)+parseInt(_0x7033b7(0x198))/0x8*(-parseInt(_0x7033b7(0x1a6))/0x9)+parseInt(_0x7033b7(0x18e))/0xa*(parseInt(_0x7033b7(0x1ac))/0xb)+-parseInt(_0x7033b7(0x1a2))/0xc;if(_0x1a01b7===_0x164c63)break;else _0x399fbe['push'](_0x399fbe['shift']());}catch(_0x322c07){_0x399fbe['push'](_0x399fbe['shift']());}}}(_0x46b8,0x606b0));Object['defineProperty'](exports,_0xcab8ed(0x1a8),{'value':!![]}),exports['sendMessageFromZhipu']=exports[_0xcab8ed(0x19e)]=exports[_0xcab8ed(0x1ae)]=exports[_0xcab8ed(0x19a)]=void 0x0;function _0x33d9(_0x454d23,_0x24616c){const _0x46b8b4=_0x46b8();return _0x33d9=function(_0x33d976,_0x289f7c){_0x33d976=_0x33d976-0x18a;let _0x42cc81=_0x46b8b4[_0x33d976];return _0x42cc81;},_0x33d9(_0x454d23,_0x24616c);}const axios=require(_0xcab8ed(0x1b2)),jwt=require(_0xcab8ed(0x193));function generateToken(_0x50e3c5,_0x4c8dcd=0x3e8*0x3c*0x3c*0x18*0x168){const _0x15e82f=_0xcab8ed,[_0x716516,_0x55f494]=_0x50e3c5[_0x15e82f(0x18c)]('.'),_0x19b14d={'api_key':_0x716516,'exp':Math[_0x15e82f(0x190)](Date[_0x15e82f(0x1a9)]())+_0x4c8dcd*0x3e8,'timestamp':Math[_0x15e82f(0x190)](Date[_0x15e82f(0x1a9)]())};return jwt['sign'](_0x19b14d,_0x55f494,{'algorithm':'HS256','header':{'alg':'HS256','sign_type':'SIGN'}});}function _0x46b8(){const _0x828483=['jsonwebtoken','12950uuyhNM','trim','data','/sse-invoke','328GzZQEb','error','generateToken','24594fcOOUq','error:\x20','1022PEeMmE','compilerStream','event:','end','meta:','16071288lVTHcq','filter','then','299565Vpfpgg','9549ifRdge','replace','__esModule','now','text','is_end','560153kksOxA','application/json','compilerMetaJsonStr','length','https://open.bigmodel.cn/api/paas/v3/model-api/','usage','axios','sendMessageFromZhipu','1028MzvFsE','stream','split','json\x20parse\x20error\x20from\x20zhipu!','20VUflYG','3huEMqH','round','log','224416jxVdMJ'];_0x46b8=function(){return _0x828483;};return _0x46b8();}exports[_0xcab8ed(0x19a)]=generateToken;function compilerMetaJsonStr(_0x37656d){const _0x1fcdbb=_0xcab8ed;let _0x43826c={};try{_0x43826c=JSON['parse'](_0x37656d);}catch(_0x5d25c3){_0x43826c={'usage':{'completion_tokens':0x31,'prompt_tokens':0x14d,'total_tokens':0x18f}},console[_0x1fcdbb(0x199)](_0x1fcdbb(0x18d),_0x37656d);}return _0x43826c;}exports[_0xcab8ed(0x1ae)]=compilerMetaJsonStr;function compilerStream(_0x51e8e1){const _0x17cc71=_0xcab8ed;var _0x3f95ca;if(_0x51e8e1[_0x17cc71(0x1af)]===0x3)return{'event':_0x51e8e1[0x0]['replace'](_0x17cc71(0x19f),''),'id':_0x51e8e1[0x1]['replace']('id:',''),'is_end':![],'result':_0x51e8e1[0x2][_0x17cc71(0x1a7)]('data:','')[_0x17cc71(0x195)]()};if(_0x51e8e1[_0x17cc71(0x1af)]===0x4)return{'event':_0x51e8e1[0x0][_0x17cc71(0x1a7)](_0x17cc71(0x19f),''),'id':_0x51e8e1[0x1][_0x17cc71(0x1a7)]('id:',''),'result':_0x51e8e1[0x2][_0x17cc71(0x1a7)]('data:','')[_0x17cc71(0x195)](),'is_end':!![],'usage':(_0x3f95ca=compilerMetaJsonStr(_0x51e8e1[0x3][_0x17cc71(0x1a7)](_0x17cc71(0x1a1),'')))===null||_0x3f95ca===void 0x0?void 0x0:_0x3f95ca[_0x17cc71(0x1b1)]};}exports[_0xcab8ed(0x19e)]=compilerStream;async function sendMessageFromZhipu(_0x174984,{onProgress:_0xa253b2,key:_0x149ff8,model:_0x132786,temperature:temperature=0.95}){const _0x134fc2=await generateToken(_0x149ff8);return new Promise((_0x144928,_0x513802)=>{const _0x29474c=_0x33d9,_0x9b286a=_0x29474c(0x1b0)+_0x132786+_0x29474c(0x197),_0x5b8592={'method':'POST','url':_0x9b286a,'responseType':_0x29474c(0x18b),'headers':{'Content-Type':_0x29474c(0x1ad),'Authorization':_0x134fc2},'data':{'prompt':_0x174984,'temperature':temperature}};axios(_0x5b8592)[_0x29474c(0x1a4)](_0x2afceb=>{const _0x5a707a=_0x29474c,_0x6fa0ae=_0x2afceb['data'];let _0x57308f,_0x4678c2='';_0x6fa0ae['on'](_0x5a707a(0x196),_0xf5b203=>{const _0x200e8c=_0x5a707a,_0xf0a152=_0xf5b203['toString']()[_0x200e8c(0x18c)]('\x0a')[_0x200e8c(0x1a3)](_0x1483b5=>_0x1483b5['trim']()!==''),_0x58d960=compilerStream(_0xf0a152);if(!_0x58d960)return;const {id:_0x3a379f,result:_0x3cd0bf,is_end:_0x3ecc47}=_0x58d960;_0x3cd0bf&&(_0x4678c2+=_0x3cd0bf[_0x200e8c(0x195)]()),_0x3ecc47&&(_0x58d960[_0x200e8c(0x1ab)]=![],_0x57308f=_0x58d960,_0x57308f[_0x200e8c(0x1aa)]=_0x4678c2),_0xa253b2(_0x58d960);}),_0x6fa0ae['on'](_0x5a707a(0x1a0),()=>{_0x144928(_0x57308f),_0x4678c2='';});})['catch'](_0x149251=>{const _0xc24e1c=_0x29474c;console[_0xc24e1c(0x191)](_0xc24e1c(0x19c),_0x149251);});});}exports[_0xcab8ed(0x1b3)]=sendMessageFromZhipu;