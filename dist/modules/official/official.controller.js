'use strict';const _0x4135bf=_0x4342;(function(_0xbd3c8e,_0x18c94a){const _0x43e2b4=_0x4342,_0x50dbf9=_0xbd3c8e();while(!![]){try{const _0x2152ef=parseInt(_0x43e2b4(0x104))/0x1*(-parseInt(_0x43e2b4(0xd1))/0x2)+parseInt(_0x43e2b4(0xc2))/0x3*(parseInt(_0x43e2b4(0xfb))/0x4)+parseInt(_0x43e2b4(0xe0))/0x5*(parseInt(_0x43e2b4(0xb9))/0x6)+parseInt(_0x43e2b4(0xc9))/0x7+parseInt(_0x43e2b4(0x10b))/0x8+parseInt(_0x43e2b4(0xfc))/0x9+parseInt(_0x43e2b4(0xc1))/0xa*(-parseInt(_0x43e2b4(0xf5))/0xb);if(_0x2152ef===_0x18c94a)break;else _0x50dbf9['push'](_0x50dbf9['shift']());}catch(_0x27b7d9){_0x50dbf9['push'](_0x50dbf9['shift']());}}}(_0x1950,0x1b758));function _0x4342(_0x33bc32,_0x5a9bfe){const _0x195004=_0x1950();return _0x4342=function(_0x4342d9,_0x3b4ee0){_0x4342d9=_0x4342d9-0xb7;let _0x5ae6e1=_0x195004[_0x4342d9];return _0x5ae6e1;},_0x4342(_0x33bc32,_0x5a9bfe);}function _0x1950(){const _0x49b7dc=['1071952CvILSz','aotoPlay','公众号通知接口GET','loginBySceneStr','./official.service','https://mp.weixin.qq.com/cgi-bin/showqrcode?ticket=','metadata','officialSubscribeText','@nestjs/common','design:paramtypes','qrscene_','genXmlMsgByConfig','@nestjs/swagger','object','Get','bindWxBySceneStr','__esModule','OfficialController','获取登录跳转地址','2232vIfPPK','getQRCode','getQRSceneStrByBind','TRUE','__metadata','JwtAuthGuard','获取绑定二维码的sceneStr','function','650570klTqfP','3SFLlRU','__param','ISDEV','code','CLICK','content','length','1463945dprdqp','officialBindAccountText','subscribe','get\x20通知>>>','getQRCodeTicket','env','Res','officialService','165176WFlSpG','decorate','getJsapiTicket','获取注册配置','GetQrCodeDto','VIEW','getQRSceneStr','SCAN','includes','GetQrSceneStrDto','prototype','unsubscribe','Controller','nonce','xml:\x20','20ZBPPGf','design:type','event','./dto/getQrSceneStr.dto','UseGuards','scan','ApiOperation','genXmlMsg','ApiTags','defineProperty','sceneStr','log','getOwnPropertyDescriptor','notify','Post','split','url','Query','../../common/auth/jwtAuth.guard','getRedirectUrl','eventkey','77YgFaaq','Body','fromusername','Req','__decorate','send','624744GJQMSr','1346904oaUvDD','msgtype','status','timestamp','OfficialService','扫码登录轮询查询','公众号通知接口POST','./dto/getQrCode.dto','1CGGdVv','sceneStr:\x20','design:returntype','获取二维码','loginByCode','scanBindWx','echostr'];_0x1950=function(){return _0x49b7dc;};return _0x1950();}var __decorate=this&&this[_0x4135bf(0xf9)]||function(_0x4adffb,_0x538459,_0x5b45b9,_0x55f7c8){const _0x5cb88c=_0x4135bf;var _0x3babd0=arguments[_0x5cb88c(0xc8)],_0x55ec19=_0x3babd0<0x3?_0x538459:_0x55f7c8===null?_0x55f7c8=Object[_0x5cb88c(0xec)](_0x538459,_0x5b45b9):_0x55f7c8,_0x4affb4;if(typeof Reflect==='object'&&typeof Reflect[_0x5cb88c(0xd2)]===_0x5cb88c(0xc0))_0x55ec19=Reflect['decorate'](_0x4adffb,_0x538459,_0x5b45b9,_0x55f7c8);else{for(var _0x30174b=_0x4adffb['length']-0x1;_0x30174b>=0x0;_0x30174b--)if(_0x4affb4=_0x4adffb[_0x30174b])_0x55ec19=(_0x3babd0<0x3?_0x4affb4(_0x55ec19):_0x3babd0>0x3?_0x4affb4(_0x538459,_0x5b45b9,_0x55ec19):_0x4affb4(_0x538459,_0x5b45b9))||_0x55ec19;}return _0x3babd0>0x3&&_0x55ec19&&Object['defineProperty'](_0x538459,_0x5b45b9,_0x55ec19),_0x55ec19;},__metadata=this&&this[_0x4135bf(0xbd)]||function(_0x4e542b,_0x290dc7){const _0x273e8a=_0x4135bf;if(typeof Reflect===_0x273e8a(0x118)&&typeof Reflect[_0x273e8a(0x111)]==='function')return Reflect[_0x273e8a(0x111)](_0x4e542b,_0x290dc7);},__param=this&&this[_0x4135bf(0xc3)]||function(_0xc394c4,_0x2b7f72){return function(_0x109897,_0x43cfcc){_0x2b7f72(_0x109897,_0x43cfcc,_0xc394c4);};};Object[_0x4135bf(0xe9)](exports,_0x4135bf(0x11b),{'value':!![]}),exports[_0x4135bf(0xb7)]=void 0x0;const common_1=require(_0x4135bf(0x113)),swagger_1=require(_0x4135bf(0x117)),jwtAuth_guard_1=require(_0x4135bf(0xf2)),official_service_1=require(_0x4135bf(0x10f)),getQrCode_dto_1=require(_0x4135bf(0x103)),getQrSceneStr_dto_1=require(_0x4135bf(0xe3));let OfficialController=class OfficialController{constructor(_0x6f214b){this['officialService']=_0x6f214b;}async[_0x4135bf(0xed)](_0xcb088b,_0x40cd1c,_0xcce1e5){const _0x421c31=_0x4135bf;console[_0x421c31(0xeb)](_0x421c31(0xcc),_0x40cd1c,_0xcce1e5);const _0x225539=await this[_0x421c31(0xd0)]['verify'](_0x40cd1c['signature'],_0x40cd1c[_0x421c31(0xde)],_0x40cd1c[_0x421c31(0xff)]);return _0x225539?_0x40cd1c[_0x421c31(0x10a)]:'';}async['notifyPost'](_0x23d9c9,_0x4d1805,_0x37fcaf,_0x12e1b0){const _0x26d3da=_0x4135bf,{xml:_0x586027}=_0x37fcaf;console['log'](_0x26d3da(0xdf),_0x586027);if(_0x586027[_0x26d3da(0xfd)][0x0]==_0x26d3da(0xe2)){if(_0x586027[_0x26d3da(0xe2)][0x0]==_0x26d3da(0xd6)||_0x586027[_0x26d3da(0xe2)][0x0]==_0x26d3da(0xc6))return _0x12e1b0[_0x26d3da(0xfe)](0xc8)[_0x26d3da(0xfa)]('');if(_0x586027['event'][0x0]==_0x26d3da(0xd8)){console['log']('扫码');const _0x55bd62=_0x586027[_0x26d3da(0xf4)][0x0];if(_0x55bd62[_0x26d3da(0xd9)]('/')){this[_0x26d3da(0xd0)][_0x26d3da(0x109)](_0x586027['fromusername'][0x0],_0x55bd62);const _0x553b51=await this[_0x26d3da(0xd0)][_0x26d3da(0x116)](_0x586027,_0x26d3da(0xca));return _0x12e1b0[_0x26d3da(0xfe)](0xc8)['send'](_0x553b51);}this[_0x26d3da(0xd0)][_0x26d3da(0xe5)](_0x586027[_0x26d3da(0xf7)][0x0],_0x55bd62);const _0x17d8d3=await this['officialService'][_0x26d3da(0x116)](_0x586027,'officialScanLoginText');return _0x12e1b0['status'](0xc8)[_0x26d3da(0xfa)](_0x17d8d3);}if(_0x586027[_0x26d3da(0xe2)][0x0]==_0x26d3da(0xcb)){console[_0x26d3da(0xeb)]('订阅',_0x586027[_0x26d3da(0xf4)][0x0]);const _0x319a22=_0x586027[_0x26d3da(0xf4)][0x0][_0x26d3da(0xef)](_0x26d3da(0x115))[0x1];console['log'](_0x26d3da(0x105),_0x319a22);if(!_0x319a22){const _0x5931bd=await this[_0x26d3da(0xd0)][_0x26d3da(0x116)](_0x586027,_0x26d3da(0x112));return _0x12e1b0['status'](0xc8)[_0x26d3da(0xfa)](_0x5931bd);}if(_0x319a22[_0x26d3da(0xd9)]('/')){this[_0x26d3da(0xd0)]['scanBindWx'](_0x586027[_0x26d3da(0xf7)][0x0],_0x319a22);const _0x3f77f9=await this[_0x26d3da(0xd0)]['genXmlMsgByConfig'](_0x586027,'officialBindAccountText');return _0x12e1b0[_0x26d3da(0xfe)](0xc8)[_0x26d3da(0xfa)](_0x3f77f9);}this[_0x26d3da(0xd0)][_0x26d3da(0xe5)](_0x586027[_0x26d3da(0xf7)][0x0],_0x319a22);const _0x5bb80d=await this[_0x26d3da(0xd0)][_0x26d3da(0x116)](_0x586027,_0x26d3da(0x112));return _0x12e1b0[_0x26d3da(0xfe)](0xc8)[_0x26d3da(0xfa)](_0x5bb80d);}if(_0x586027['event'][0x0]==_0x26d3da(0xdc))return _0x12e1b0[_0x26d3da(0xfe)](0xc8)[_0x26d3da(0xfa)]('');}if(_0x586027[_0x26d3da(0xfd)][0x0]=='text'){const _0x2cf8fe=await this['officialService'][_0x26d3da(0x10c)](_0x586027[_0x26d3da(0xc7)][0x0]),_0x36344a=await this['officialService'][_0x26d3da(0xe7)](_0x586027,_0x2cf8fe);return _0x12e1b0['status'](0xc8)['send'](_0x36344a);}return'success';}async['getQRSceneStr'](_0x30c4f6){const _0x46fdc4=_0x4135bf;return this[_0x46fdc4(0xd0)]['getQRSceneStr'](_0x30c4f6);}async['getQRSceneStrByBind'](_0x44ac5a){const _0x59a01f=_0x4135bf;return this[_0x59a01f(0xd0)][_0x59a01f(0xbb)](_0x44ac5a);}async[_0x4135bf(0xba)](_0x1b7276){const _0x5eef95=_0x4135bf;if(process[_0x5eef95(0xce)][_0x5eef95(0xc4)]===_0x5eef95(0xbc))return'';const _0x1d344e=await this[_0x5eef95(0xd0)][_0x5eef95(0xcd)](_0x1b7276[_0x5eef95(0xea)]);return _0x5eef95(0x110)+encodeURIComponent(_0x1d344e);}async['loginBySceneStr'](_0x5014fd,_0x529d4d){const _0x142148=_0x4135bf;return this[_0x142148(0xd0)][_0x142148(0x10e)](_0x5014fd,_0x529d4d[_0x142148(0xea)]);}async[_0x4135bf(0x11a)](_0x224aac,_0x2327e3){const _0x5d9e34=_0x4135bf;return this[_0x5d9e34(0xd0)][_0x5d9e34(0x11a)](_0x224aac,_0x2327e3['sceneStr']);}async[_0x4135bf(0xf3)](_0x102376){const _0x8f4da7=_0x4135bf;return this['officialService'][_0x8f4da7(0xf3)](_0x102376[_0x8f4da7(0xf0)]);}async[_0x4135bf(0xd3)](_0x50cd6c){const _0x4037a0=_0x4135bf;return this[_0x4037a0(0xd0)]['getJsapiTicket'](_0x50cd6c['url']);}async[_0x4135bf(0x108)](_0x272440,_0xd71ec8){const _0x2b55d2=_0x4135bf;return this[_0x2b55d2(0xd0)][_0x2b55d2(0x108)](_0x272440,_0xd71ec8[_0x2b55d2(0xc5)]);}};__decorate([(0x0,common_1[_0x4135bf(0x119)])(_0x4135bf(0xed)),(0x0,swagger_1[_0x4135bf(0xe6)])({'summary':_0x4135bf(0x10d)}),__param(0x0,(0x0,common_1[_0x4135bf(0xf8)])()),__param(0x1,(0x0,common_1[_0x4135bf(0xf1)])()),__param(0x2,(0x0,common_1[_0x4135bf(0xf6)])()),__metadata('design:type',Function),__metadata(_0x4135bf(0x114),[Object,Object,Object]),__metadata(_0x4135bf(0x106),Promise)],OfficialController['prototype'],_0x4135bf(0xed),null),__decorate([(0x0,common_1[_0x4135bf(0xee)])(_0x4135bf(0xed)),(0x0,swagger_1[_0x4135bf(0xe6)])({'summary':_0x4135bf(0x102)}),__param(0x0,(0x0,common_1[_0x4135bf(0xf8)])()),__param(0x1,(0x0,common_1[_0x4135bf(0xf1)])()),__param(0x2,(0x0,common_1[_0x4135bf(0xf6)])()),__param(0x3,(0x0,common_1[_0x4135bf(0xcf)])()),__metadata('design:type',Function),__metadata(_0x4135bf(0x114),[Object,Object,Object,Object]),__metadata('design:returntype',Promise)],OfficialController[_0x4135bf(0xdb)],'notifyPost',null),__decorate([(0x0,common_1[_0x4135bf(0xee)])('getQRSceneStr'),(0x0,swagger_1['ApiOperation'])({'summary':'获取登录二维码sceneStr'}),__param(0x0,(0x0,common_1[_0x4135bf(0xf6)])()),__metadata(_0x4135bf(0xe1),Function),__metadata(_0x4135bf(0x114),[getQrSceneStr_dto_1[_0x4135bf(0xda)]]),__metadata(_0x4135bf(0x106),Promise)],OfficialController[_0x4135bf(0xdb)],_0x4135bf(0xd7),null),__decorate([(0x0,common_1['Post'])(_0x4135bf(0xbb)),(0x0,swagger_1[_0x4135bf(0xe6)])({'summary':_0x4135bf(0xbf)}),(0x0,common_1['UseGuards'])(jwtAuth_guard_1[_0x4135bf(0xbe)]),__param(0x0,(0x0,common_1[_0x4135bf(0xf8)])()),__metadata(_0x4135bf(0xe1),Function),__metadata('design:paramtypes',[Object]),__metadata(_0x4135bf(0x106),Promise)],OfficialController[_0x4135bf(0xdb)],'getQRSceneStrByBind',null),__decorate([(0x0,common_1[_0x4135bf(0x119)])(_0x4135bf(0xba)),(0x0,swagger_1[_0x4135bf(0xe6)])({'summary':_0x4135bf(0x107)}),__param(0x0,(0x0,common_1['Query'])()),__metadata(_0x4135bf(0xe1),Function),__metadata(_0x4135bf(0x114),[getQrCode_dto_1['GetQrCodeDto']]),__metadata(_0x4135bf(0x106),Promise)],OfficialController[_0x4135bf(0xdb)],_0x4135bf(0xba),null),__decorate([(0x0,common_1['Post'])('loginBySceneStr'),(0x0,swagger_1['ApiOperation'])({'summary':_0x4135bf(0x101)}),__param(0x0,(0x0,common_1[_0x4135bf(0xf8)])()),__param(0x1,(0x0,common_1[_0x4135bf(0xf6)])()),__metadata(_0x4135bf(0xe1),Function),__metadata(_0x4135bf(0x114),[Object,getQrCode_dto_1[_0x4135bf(0xd5)]]),__metadata(_0x4135bf(0x106),Promise)],OfficialController[_0x4135bf(0xdb)],_0x4135bf(0x10e),null),__decorate([(0x0,common_1[_0x4135bf(0xee)])(_0x4135bf(0x11a)),(0x0,swagger_1['ApiOperation'])({'summary':'扫码绑定轮询查询'}),(0x0,common_1[_0x4135bf(0xe4)])(jwtAuth_guard_1['JwtAuthGuard']),__param(0x0,(0x0,common_1['Req'])()),__param(0x1,(0x0,common_1['Body'])()),__metadata(_0x4135bf(0xe1),Function),__metadata(_0x4135bf(0x114),[Object,getQrCode_dto_1['GetQrCodeDto']]),__metadata(_0x4135bf(0x106),Promise)],OfficialController['prototype'],_0x4135bf(0x11a),null),__decorate([(0x0,common_1[_0x4135bf(0xee)])(_0x4135bf(0xf3)),(0x0,swagger_1[_0x4135bf(0xe6)])({'summary':_0x4135bf(0xb8)}),__param(0x0,(0x0,common_1[_0x4135bf(0xf6)])()),__metadata(_0x4135bf(0xe1),Function),__metadata(_0x4135bf(0x114),[Object]),__metadata(_0x4135bf(0x106),Promise)],OfficialController[_0x4135bf(0xdb)],_0x4135bf(0xf3),null),__decorate([(0x0,common_1[_0x4135bf(0xee)])(_0x4135bf(0xd3)),(0x0,swagger_1[_0x4135bf(0xe6)])({'summary':_0x4135bf(0xd4)}),__param(0x0,(0x0,common_1[_0x4135bf(0xf6)])()),__metadata(_0x4135bf(0xe1),Function),__metadata('design:paramtypes',[Object]),__metadata(_0x4135bf(0x106),Promise)],OfficialController[_0x4135bf(0xdb)],_0x4135bf(0xd3),null),__decorate([(0x0,common_1[_0x4135bf(0xee)])('loginByCode'),(0x0,swagger_1[_0x4135bf(0xe6)])({'summary':'公众号静默登录'}),__param(0x0,(0x0,common_1[_0x4135bf(0xf8)])()),__param(0x1,(0x0,common_1[_0x4135bf(0xf6)])()),__metadata(_0x4135bf(0xe1),Function),__metadata('design:paramtypes',[Object,Object]),__metadata(_0x4135bf(0x106),Promise)],OfficialController[_0x4135bf(0xdb)],'loginByCode',null),OfficialController=__decorate([(0x0,swagger_1[_0x4135bf(0xe8)])('official'),(0x0,common_1[_0x4135bf(0xdd)])('official'),__metadata(_0x4135bf(0x114),[official_service_1[_0x4135bf(0x100)]])],OfficialController),exports[_0x4135bf(0xb7)]=OfficialController;