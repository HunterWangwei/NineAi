'use strict';const _0x5deebb=_0x50e9;function _0x50e9(_0x1cb635,_0x1fda66){const _0x18944b=_0x1894();return _0x50e9=function(_0x50e990,_0x27948b){_0x50e990=_0x50e990-0x11c;let _0x33bd74=_0x18944b[_0x50e990];return _0x33bd74;},_0x50e9(_0x1cb635,_0x1fda66);}function _0x1894(){const _0x4cd2b5=['Get','getQRSceneStr','loginByCode','10nwpgQd','扫码绑定轮询查询','officialSubscribeText','get\x20通知>>>','获取绑定二维码的sceneStr','xml:\x20','content','loginBySceneStr','officialScanLoginText','公众号通知接口GET','bindWxBySceneStr','genXmlMsg','@nestjs/swagger','1479558IXapWM','getJsapiTicket','363781sOualt','aotoPlay','289366odponz','official','subscribe','scan','defineProperty','genXmlMsgByConfig','Req','1813653MDdRjK','../../common/auth/jwtAuth.guard','JwtAuthGuard','1365CIflFb','GetQrCodeDto','echostr','notify','timestamp','qrscene_','5ePwkiY','ApiOperation','GetQrSceneStrDto','Res','text','31040mHXqyi','getRedirectUrl','ISDEV','status','split','function','nonce','scanBindWx','./dto/getQrCode.dto','signature','verify','__metadata','TRUE','code','includes','ApiTags','2519982uIafqe','获取注册配置','4532036YBVFGQ','__esModule','公众号静默登录','getQRCode','SCAN','design:returntype','log','success','notifyPost','OfficialController','prototype','CLICK','officialBindAccountText','Body','Post','unsubscribe','7CmoiER','officialService','getQRCodeTicket','fromusername','获取登录跳转地址','sceneStr','eventkey','Query','event','Controller','design:paramtypes','send','object','sceneStr:\x20','decorate','length','UseGuards','url','./official.service','env','扫码登录轮询查询','design:type'];_0x1894=function(){return _0x4cd2b5;};return _0x1894();}(function(_0x563897,_0x508672){const _0x4aaac9=_0x50e9,_0x5ebf2b=_0x563897();while(!![]){try{const _0x37e4ed=parseInt(_0x4aaac9(0x156))/0x1*(-parseInt(_0x4aaac9(0x11f))/0x2)+-parseInt(_0x4aaac9(0x17c))/0x3+parseInt(_0x4aaac9(0x146))/0x4+parseInt(_0x4aaac9(0x12f))/0x5*(parseInt(_0x4aaac9(0x144))/0x6)+-parseInt(_0x4aaac9(0x129))/0x7*(-parseInt(_0x4aaac9(0x134))/0x8)+-parseInt(_0x4aaac9(0x126))/0x9+-parseInt(_0x4aaac9(0x16f))/0xa*(parseInt(_0x4aaac9(0x11d))/0xb);if(_0x37e4ed===_0x508672)break;else _0x5ebf2b['push'](_0x5ebf2b['shift']());}catch(_0x3ad050){_0x5ebf2b['push'](_0x5ebf2b['shift']());}}}(_0x1894,0x8aedb));var __decorate=this&&this['__decorate']||function(_0x206ca8,_0x25fa54,_0x448a47,_0x40ac13){const _0x45fe16=_0x50e9;var _0xf438c7=arguments[_0x45fe16(0x165)],_0x3bd46a=_0xf438c7<0x3?_0x25fa54:_0x40ac13===null?_0x40ac13=Object['getOwnPropertyDescriptor'](_0x25fa54,_0x448a47):_0x40ac13,_0x1ff01b;if(typeof Reflect===_0x45fe16(0x162)&&typeof Reflect[_0x45fe16(0x164)]===_0x45fe16(0x139))_0x3bd46a=Reflect['decorate'](_0x206ca8,_0x25fa54,_0x448a47,_0x40ac13);else{for(var _0x2dca9f=_0x206ca8[_0x45fe16(0x165)]-0x1;_0x2dca9f>=0x0;_0x2dca9f--)if(_0x1ff01b=_0x206ca8[_0x2dca9f])_0x3bd46a=(_0xf438c7<0x3?_0x1ff01b(_0x3bd46a):_0xf438c7>0x3?_0x1ff01b(_0x25fa54,_0x448a47,_0x3bd46a):_0x1ff01b(_0x25fa54,_0x448a47))||_0x3bd46a;}return _0xf438c7>0x3&&_0x3bd46a&&Object[_0x45fe16(0x123)](_0x25fa54,_0x448a47,_0x3bd46a),_0x3bd46a;},__metadata=this&&this[_0x5deebb(0x13f)]||function(_0x3faec3,_0xc3b9a3){const _0x1224c2=_0x5deebb;if(typeof Reflect===_0x1224c2(0x162)&&typeof Reflect['metadata']===_0x1224c2(0x139))return Reflect['metadata'](_0x3faec3,_0xc3b9a3);},__param=this&&this['__param']||function(_0x5da219,_0x4cd847){return function(_0x506f7f,_0x345542){_0x4cd847(_0x506f7f,_0x345542,_0x5da219);};};Object[_0x5deebb(0x123)](exports,_0x5deebb(0x147),{'value':!![]}),exports[_0x5deebb(0x14f)]=void 0x0;const common_1=require('@nestjs/common'),swagger_1=require(_0x5deebb(0x17b)),jwtAuth_guard_1=require(_0x5deebb(0x127)),official_service_1=require(_0x5deebb(0x168)),getQrCode_dto_1=require(_0x5deebb(0x13c)),getQrSceneStr_dto_1=require('./dto/getQrSceneStr.dto');let OfficialController=class OfficialController{constructor(_0x4906ca){const _0x124c27=_0x5deebb;this[_0x124c27(0x157)]=_0x4906ca;}async[_0x5deebb(0x12c)](_0x1ec435,_0x289c03,_0x4182da){const _0x1fdb12=_0x5deebb;console[_0x1fdb12(0x14c)](_0x1fdb12(0x172),_0x289c03,_0x4182da);const _0x2afd5e=await this[_0x1fdb12(0x157)][_0x1fdb12(0x13e)](_0x289c03[_0x1fdb12(0x13d)],_0x289c03[_0x1fdb12(0x13a)],_0x289c03[_0x1fdb12(0x12d)]);return _0x2afd5e?_0x289c03[_0x1fdb12(0x12b)]:'';}async[_0x5deebb(0x14e)](_0x4fbf36,_0x77b052,_0x47b131,_0x5c8d30){const _0x3b2cb5=_0x5deebb,{xml:_0x118377}=_0x47b131;console[_0x3b2cb5(0x14c)](_0x3b2cb5(0x174),_0x118377);if(_0x118377['msgtype'][0x0]==_0x3b2cb5(0x15e)){if(_0x118377['event'][0x0]=='VIEW'||_0x118377['event'][0x0]==_0x3b2cb5(0x151))return _0x5c8d30[_0x3b2cb5(0x137)](0xc8)[_0x3b2cb5(0x161)]('');if(_0x118377[_0x3b2cb5(0x15e)][0x0]==_0x3b2cb5(0x14a)){console[_0x3b2cb5(0x14c)]('扫码');const _0x47f16c=_0x118377['eventkey'][0x0];if(_0x47f16c[_0x3b2cb5(0x142)]('/')){this[_0x3b2cb5(0x157)][_0x3b2cb5(0x13b)](_0x118377[_0x3b2cb5(0x159)][0x0],_0x47f16c);const _0x38939f=await this[_0x3b2cb5(0x157)][_0x3b2cb5(0x124)](_0x118377,_0x3b2cb5(0x152));return _0x5c8d30[_0x3b2cb5(0x137)](0xc8)[_0x3b2cb5(0x161)](_0x38939f);}this[_0x3b2cb5(0x157)][_0x3b2cb5(0x122)](_0x118377[_0x3b2cb5(0x159)][0x0],_0x47f16c);const _0x156f20=await this[_0x3b2cb5(0x157)]['genXmlMsgByConfig'](_0x118377,_0x3b2cb5(0x177));return _0x5c8d30[_0x3b2cb5(0x137)](0xc8)['send'](_0x156f20);}if(_0x118377[_0x3b2cb5(0x15e)][0x0]==_0x3b2cb5(0x121)){console[_0x3b2cb5(0x14c)]('订阅',_0x118377['eventkey'][0x0]);const _0xc2d768=_0x118377[_0x3b2cb5(0x15c)][0x0][_0x3b2cb5(0x138)](_0x3b2cb5(0x12e))[0x1];console[_0x3b2cb5(0x14c)](_0x3b2cb5(0x163),_0xc2d768);if(!_0xc2d768){const _0x22bac5=await this[_0x3b2cb5(0x157)][_0x3b2cb5(0x124)](_0x118377,_0x3b2cb5(0x171));return _0x5c8d30[_0x3b2cb5(0x137)](0xc8)['send'](_0x22bac5);}if(_0xc2d768['includes']('/')){this[_0x3b2cb5(0x157)]['scanBindWx'](_0x118377[_0x3b2cb5(0x159)][0x0],_0xc2d768);const _0x5cd240=await this['officialService'][_0x3b2cb5(0x124)](_0x118377,_0x3b2cb5(0x152));return _0x5c8d30[_0x3b2cb5(0x137)](0xc8)[_0x3b2cb5(0x161)](_0x5cd240);}this[_0x3b2cb5(0x157)]['scan'](_0x118377[_0x3b2cb5(0x159)][0x0],_0xc2d768);const _0x5a71e3=await this['officialService'][_0x3b2cb5(0x124)](_0x118377,'officialSubscribeText');return _0x5c8d30[_0x3b2cb5(0x137)](0xc8)[_0x3b2cb5(0x161)](_0x5a71e3);}if(_0x118377[_0x3b2cb5(0x15e)][0x0]==_0x3b2cb5(0x155))return _0x5c8d30[_0x3b2cb5(0x137)](0xc8)[_0x3b2cb5(0x161)]('');}if(_0x118377['msgtype'][0x0]==_0x3b2cb5(0x133)){const _0x2e6283=await this[_0x3b2cb5(0x157)][_0x3b2cb5(0x11e)](_0x118377[_0x3b2cb5(0x175)][0x0]),_0x1da549=await this[_0x3b2cb5(0x157)][_0x3b2cb5(0x17a)](_0x118377,_0x2e6283);return _0x5c8d30[_0x3b2cb5(0x137)](0xc8)[_0x3b2cb5(0x161)](_0x1da549);}return _0x3b2cb5(0x14d);}async['getQRSceneStr'](_0x3345fd){const _0x315c68=_0x5deebb;return this[_0x315c68(0x157)]['getQRSceneStr'](_0x3345fd);}async['getQRSceneStrByBind'](_0x11cc54){const _0x26a4c6=_0x5deebb;return this[_0x26a4c6(0x157)]['getQRSceneStrByBind'](_0x11cc54);}async[_0x5deebb(0x149)](_0x5e0ec0){const _0x4343bf=_0x5deebb;if(process[_0x4343bf(0x169)][_0x4343bf(0x136)]===_0x4343bf(0x140))return'';const _0x429359=await this['officialService'][_0x4343bf(0x158)](_0x5e0ec0['sceneStr']);return'https://mp.weixin.qq.com/cgi-bin/showqrcode?ticket='+encodeURIComponent(_0x429359);}async['loginBySceneStr'](_0xdbcfc2,_0xe903df){return this['officialService']['loginBySceneStr'](_0xdbcfc2,_0xe903df['sceneStr']);}async['bindWxBySceneStr'](_0x3f5ecb,_0x3531a2){const _0x2c101f=_0x5deebb;return this[_0x2c101f(0x157)][_0x2c101f(0x179)](_0x3f5ecb,_0x3531a2[_0x2c101f(0x15b)]);}async['getRedirectUrl'](_0x1db81e){const _0x27990b=_0x5deebb;return this['officialService'][_0x27990b(0x135)](_0x1db81e['url']);}async[_0x5deebb(0x11c)](_0xdf2738){const _0x5cd322=_0x5deebb;return this['officialService']['getJsapiTicket'](_0xdf2738[_0x5cd322(0x167)]);}async['loginByCode'](_0x23ff09,_0x2ec3a0){const _0x47522e=_0x5deebb;return this[_0x47522e(0x157)][_0x47522e(0x16e)](_0x23ff09,_0x2ec3a0[_0x47522e(0x141)]);}};__decorate([(0x0,common_1[_0x5deebb(0x16c)])('notify'),(0x0,swagger_1[_0x5deebb(0x130)])({'summary':_0x5deebb(0x178)}),__param(0x0,(0x0,common_1[_0x5deebb(0x125)])()),__param(0x1,(0x0,common_1[_0x5deebb(0x15d)])()),__param(0x2,(0x0,common_1[_0x5deebb(0x153)])()),__metadata('design:type',Function),__metadata(_0x5deebb(0x160),[Object,Object,Object]),__metadata(_0x5deebb(0x14b),Promise)],OfficialController[_0x5deebb(0x150)],'notify',null),__decorate([(0x0,common_1[_0x5deebb(0x154)])(_0x5deebb(0x12c)),(0x0,swagger_1[_0x5deebb(0x130)])({'summary':'公众号通知接口POST'}),__param(0x0,(0x0,common_1[_0x5deebb(0x125)])()),__param(0x1,(0x0,common_1[_0x5deebb(0x15d)])()),__param(0x2,(0x0,common_1[_0x5deebb(0x153)])()),__param(0x3,(0x0,common_1[_0x5deebb(0x132)])()),__metadata(_0x5deebb(0x16b),Function),__metadata(_0x5deebb(0x160),[Object,Object,Object,Object]),__metadata(_0x5deebb(0x14b),Promise)],OfficialController[_0x5deebb(0x150)],'notifyPost',null),__decorate([(0x0,common_1[_0x5deebb(0x154)])(_0x5deebb(0x16d)),(0x0,swagger_1[_0x5deebb(0x130)])({'summary':'获取登录二维码sceneStr'}),__param(0x0,(0x0,common_1[_0x5deebb(0x153)])()),__metadata('design:type',Function),__metadata(_0x5deebb(0x160),[getQrSceneStr_dto_1[_0x5deebb(0x131)]]),__metadata(_0x5deebb(0x14b),Promise)],OfficialController[_0x5deebb(0x150)],_0x5deebb(0x16d),null),__decorate([(0x0,common_1[_0x5deebb(0x154)])('getQRSceneStrByBind'),(0x0,swagger_1[_0x5deebb(0x130)])({'summary':_0x5deebb(0x173)}),(0x0,common_1[_0x5deebb(0x166)])(jwtAuth_guard_1[_0x5deebb(0x128)]),__param(0x0,(0x0,common_1['Req'])()),__metadata(_0x5deebb(0x16b),Function),__metadata(_0x5deebb(0x160),[Object]),__metadata('design:returntype',Promise)],OfficialController[_0x5deebb(0x150)],'getQRSceneStrByBind',null),__decorate([(0x0,common_1[_0x5deebb(0x16c)])('getQRCode'),(0x0,swagger_1[_0x5deebb(0x130)])({'summary':'获取二维码'}),__param(0x0,(0x0,common_1[_0x5deebb(0x15d)])()),__metadata('design:type',Function),__metadata(_0x5deebb(0x160),[getQrCode_dto_1[_0x5deebb(0x12a)]]),__metadata(_0x5deebb(0x14b),Promise)],OfficialController[_0x5deebb(0x150)],_0x5deebb(0x149),null),__decorate([(0x0,common_1['Post'])(_0x5deebb(0x176)),(0x0,swagger_1['ApiOperation'])({'summary':_0x5deebb(0x16a)}),__param(0x0,(0x0,common_1[_0x5deebb(0x125)])()),__param(0x1,(0x0,common_1[_0x5deebb(0x153)])()),__metadata(_0x5deebb(0x16b),Function),__metadata('design:paramtypes',[Object,getQrCode_dto_1[_0x5deebb(0x12a)]]),__metadata(_0x5deebb(0x14b),Promise)],OfficialController[_0x5deebb(0x150)],'loginBySceneStr',null),__decorate([(0x0,common_1[_0x5deebb(0x154)])(_0x5deebb(0x179)),(0x0,swagger_1['ApiOperation'])({'summary':_0x5deebb(0x170)}),(0x0,common_1[_0x5deebb(0x166)])(jwtAuth_guard_1[_0x5deebb(0x128)]),__param(0x0,(0x0,common_1['Req'])()),__param(0x1,(0x0,common_1[_0x5deebb(0x153)])()),__metadata(_0x5deebb(0x16b),Function),__metadata('design:paramtypes',[Object,getQrCode_dto_1[_0x5deebb(0x12a)]]),__metadata(_0x5deebb(0x14b),Promise)],OfficialController[_0x5deebb(0x150)],_0x5deebb(0x179),null),__decorate([(0x0,common_1['Post'])(_0x5deebb(0x135)),(0x0,swagger_1['ApiOperation'])({'summary':_0x5deebb(0x15a)}),__param(0x0,(0x0,common_1[_0x5deebb(0x153)])()),__metadata(_0x5deebb(0x16b),Function),__metadata('design:paramtypes',[Object]),__metadata(_0x5deebb(0x14b),Promise)],OfficialController[_0x5deebb(0x150)],_0x5deebb(0x135),null),__decorate([(0x0,common_1['Post'])(_0x5deebb(0x11c)),(0x0,swagger_1[_0x5deebb(0x130)])({'summary':_0x5deebb(0x145)}),__param(0x0,(0x0,common_1['Body'])()),__metadata(_0x5deebb(0x16b),Function),__metadata(_0x5deebb(0x160),[Object]),__metadata(_0x5deebb(0x14b),Promise)],OfficialController[_0x5deebb(0x150)],_0x5deebb(0x11c),null),__decorate([(0x0,common_1[_0x5deebb(0x154)])(_0x5deebb(0x16e)),(0x0,swagger_1[_0x5deebb(0x130)])({'summary':_0x5deebb(0x148)}),__param(0x0,(0x0,common_1[_0x5deebb(0x125)])()),__param(0x1,(0x0,common_1[_0x5deebb(0x153)])()),__metadata(_0x5deebb(0x16b),Function),__metadata('design:paramtypes',[Object,Object]),__metadata(_0x5deebb(0x14b),Promise)],OfficialController[_0x5deebb(0x150)],_0x5deebb(0x16e),null),OfficialController=__decorate([(0x0,swagger_1[_0x5deebb(0x143)])(_0x5deebb(0x120)),(0x0,common_1[_0x5deebb(0x15f)])(_0x5deebb(0x120)),__metadata(_0x5deebb(0x160),[official_service_1['OfficialService']])],OfficialController),exports[_0x5deebb(0x14f)]=OfficialController;