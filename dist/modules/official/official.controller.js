'use strict';const _0x2e0a9a=_0x3cc2;(function(_0x2a38c3,_0x258134){const _0x13214f=_0x3cc2,_0x5b4a87=_0x2a38c3();while(!![]){try{const _0x2dce15=parseInt(_0x13214f(0xe8))/0x1+parseInt(_0x13214f(0xed))/0x2+parseInt(_0x13214f(0xdc))/0x3*(-parseInt(_0x13214f(0xc6))/0x4)+parseInt(_0x13214f(0xaf))/0x5*(-parseInt(_0x13214f(0xc4))/0x6)+parseInt(_0x13214f(0xeb))/0x7+-parseInt(_0x13214f(0x107))/0x8+-parseInt(_0x13214f(0xe6))/0x9*(-parseInt(_0x13214f(0xf0))/0xa);if(_0x2dce15===_0x258134)break;else _0x5b4a87['push'](_0x5b4a87['shift']());}catch(_0x176401){_0x5b4a87['push'](_0x5b4a87['shift']());}}}(_0x53fc,0x21c3f));var __decorate=this&&this[_0x2e0a9a(0xda)]||function(_0x2e40d0,_0x14078c,_0x6e343c,_0x28fe2f){const _0x4eaab4=_0x2e0a9a;var _0x182dd9=arguments[_0x4eaab4(0x10a)],_0x558950=_0x182dd9<0x3?_0x14078c:_0x28fe2f===null?_0x28fe2f=Object[_0x4eaab4(0xe1)](_0x14078c,_0x6e343c):_0x28fe2f,_0x11c8ef;if(typeof Reflect==='object'&&typeof Reflect[_0x4eaab4(0xca)]===_0x4eaab4(0xff))_0x558950=Reflect[_0x4eaab4(0xca)](_0x2e40d0,_0x14078c,_0x6e343c,_0x28fe2f);else{for(var _0x203719=_0x2e40d0[_0x4eaab4(0x10a)]-0x1;_0x203719>=0x0;_0x203719--)if(_0x11c8ef=_0x2e40d0[_0x203719])_0x558950=(_0x182dd9<0x3?_0x11c8ef(_0x558950):_0x182dd9>0x3?_0x11c8ef(_0x14078c,_0x6e343c,_0x558950):_0x11c8ef(_0x14078c,_0x6e343c))||_0x558950;}return _0x182dd9>0x3&&_0x558950&&Object[_0x4eaab4(0xd5)](_0x14078c,_0x6e343c,_0x558950),_0x558950;},__metadata=this&&this[_0x2e0a9a(0xf5)]||function(_0x52f87b,_0x193701){const _0x229767=_0x2e0a9a;if(typeof Reflect===_0x229767(0xcc)&&typeof Reflect['metadata']===_0x229767(0xff))return Reflect['metadata'](_0x52f87b,_0x193701);},__param=this&&this[_0x2e0a9a(0xfa)]||function(_0x344277,_0x3526de){return function(_0xafc339,_0x5826c3){_0x3526de(_0xafc339,_0x5826c3,_0x344277);};};function _0x3cc2(_0x4ea74c,_0x219da5){const _0x53fc6d=_0x53fc();return _0x3cc2=function(_0x3cc2b4,_0x3f98e5){_0x3cc2b4=_0x3cc2b4-0xaf;let _0x16c810=_0x53fc6d[_0x3cc2b4];return _0x16c810;},_0x3cc2(_0x4ea74c,_0x219da5);}Object[_0x2e0a9a(0xd5)](exports,'__esModule',{'value':!![]}),exports[_0x2e0a9a(0xb6)]=void 0x0;const common_1=require(_0x2e0a9a(0x105)),swagger_1=require(_0x2e0a9a(0xb9)),jwtAuth_guard_1=require('../../common/auth/jwtAuth.guard'),official_service_1=require(_0x2e0a9a(0xc9)),getQrCode_dto_1=require(_0x2e0a9a(0xb8)),getQrSceneStr_dto_1=require(_0x2e0a9a(0xf7));let OfficialController=class OfficialController{constructor(_0x4b4b99){this['officialService']=_0x4b4b99;}async[_0x2e0a9a(0x100)](_0x33b9bf,_0x32ae36,_0x30a0dd){const _0x1669d1=_0x2e0a9a;console[_0x1669d1(0xb7)](_0x1669d1(0xee),_0x32ae36,_0x30a0dd);const _0xadb82e=await this['officialService'][_0x1669d1(0xc0)](_0x32ae36[_0x1669d1(0xe3)],_0x32ae36[_0x1669d1(0xbb)],_0x32ae36['timestamp']);return _0xadb82e?_0x32ae36[_0x1669d1(0xcd)]:'';}async[_0x2e0a9a(0xd1)](_0x3ea1cf,_0x12ee17,_0x4857b5,_0x4cd38f){const _0x529bc8=_0x2e0a9a,{xml:_0x3fdc3a}=_0x4857b5;console[_0x529bc8(0xb7)](_0x529bc8(0x102),_0x3fdc3a);if(_0x3fdc3a[_0x529bc8(0x104)][0x0]==_0x529bc8(0xe2)){if(_0x3fdc3a['event'][0x0]=='VIEW'||_0x3fdc3a[_0x529bc8(0xe2)][0x0]=='CLICK')return _0x4cd38f[_0x529bc8(0xe5)](0xc8)['send']('');if(_0x3fdc3a[_0x529bc8(0xe2)][0x0]==_0x529bc8(0xc8)){console[_0x529bc8(0xb7)]('扫码');const _0x529741=_0x3fdc3a['eventkey'][0x0];if(_0x529741['includes']('/')){this[_0x529bc8(0xcf)]['scanBindWx'](_0x3fdc3a[_0x529bc8(0xb1)][0x0],_0x529741);const _0x4cc033=await this['officialService'][_0x529bc8(0xfd)](_0x3fdc3a,'officialBindAccountText');return _0x4cd38f[_0x529bc8(0xe5)](0xc8)['send'](_0x4cc033);}this[_0x529bc8(0xcf)][_0x529bc8(0xd0)](_0x3fdc3a[_0x529bc8(0xb1)][0x0],_0x529741);const _0x3d0b58=await this['officialService'][_0x529bc8(0xfd)](_0x3fdc3a,_0x529bc8(0x101));return _0x4cd38f[_0x529bc8(0xe5)](0xc8)[_0x529bc8(0xe9)](_0x3d0b58);}if(_0x3fdc3a['event'][0x0]==_0x529bc8(0xdb)){console[_0x529bc8(0xb7)]('订阅',_0x3fdc3a[_0x529bc8(0xe7)][0x0]);const _0x41f037=_0x3fdc3a['eventkey'][0x0][_0x529bc8(0xf2)](_0x529bc8(0xf3))[0x1];console['log'](_0x529bc8(0xd8),_0x41f037);if(!_0x41f037){const _0x134fe0=await this[_0x529bc8(0xcf)][_0x529bc8(0xfd)](_0x3fdc3a,_0x529bc8(0xb2));return _0x4cd38f[_0x529bc8(0xe5)](0xc8)[_0x529bc8(0xe9)](_0x134fe0);}if(_0x41f037['includes']('/')){this[_0x529bc8(0xcf)][_0x529bc8(0xea)](_0x3fdc3a[_0x529bc8(0xb1)][0x0],_0x41f037);const _0x136a13=await this[_0x529bc8(0xcf)][_0x529bc8(0xfd)](_0x3fdc3a,_0x529bc8(0xf8));return _0x4cd38f[_0x529bc8(0xe5)](0xc8)['send'](_0x136a13);}this[_0x529bc8(0xcf)][_0x529bc8(0xd0)](_0x3fdc3a['fromusername'][0x0],_0x41f037);const _0x22072c=await this[_0x529bc8(0xcf)][_0x529bc8(0xfd)](_0x3fdc3a,_0x529bc8(0xb2));return _0x4cd38f[_0x529bc8(0xe5)](0xc8)[_0x529bc8(0xe9)](_0x22072c);}if(_0x3fdc3a[_0x529bc8(0xe2)][0x0]==_0x529bc8(0xef))return _0x4cd38f['status'](0xc8)[_0x529bc8(0xe9)]('');}if(_0x3fdc3a[_0x529bc8(0x104)][0x0]==_0x529bc8(0xf9)){const _0x406454=await this[_0x529bc8(0xcf)]['aotoPlay'](_0x3fdc3a[_0x529bc8(0xba)][0x0]),_0x5619b1=await this[_0x529bc8(0xcf)]['genXmlMsg'](_0x3fdc3a,_0x406454);return _0x4cd38f[_0x529bc8(0xe5)](0xc8)[_0x529bc8(0xe9)](_0x5619b1);}return'success';}async[_0x2e0a9a(0xce)](_0x342fe7){const _0xf73103=_0x2e0a9a;return this[_0xf73103(0xcf)][_0xf73103(0xce)](_0x342fe7);}async['getQRSceneStrByBind'](_0x458580){const _0x4cbaa8=_0x2e0a9a;return this['officialService'][_0x4cbaa8(0xbc)](_0x458580);}async['getQRCode'](_0x33b629){const _0x510475=_0x2e0a9a;if(process[_0x510475(0x103)]['ISDEV']===_0x510475(0xfb))return'';const _0xce5234=await this['officialService'][_0x510475(0x108)](_0x33b629[_0x510475(0xc5)]);return _0x510475(0xd3)+encodeURIComponent(_0xce5234);}async[_0x2e0a9a(0xd9)](_0x20438b,_0x8bf4c5){const _0x3d2b9f=_0x2e0a9a;return this[_0x3d2b9f(0xcf)][_0x3d2b9f(0xd9)](_0x20438b,_0x8bf4c5['sceneStr']);}async['bindWxBySceneStr'](_0xbd199,_0x429d9d){const _0x2d4486=_0x2e0a9a;return this[_0x2d4486(0xcf)][_0x2d4486(0xe4)](_0xbd199,_0x429d9d[_0x2d4486(0xc5)]);}async[_0x2e0a9a(0xb5)](_0x12f965){const _0x2b5225=_0x2e0a9a;return this[_0x2b5225(0xcf)]['getRedirectUrl'](_0x12f965[_0x2b5225(0xc2)]);}async['getJsapiTicket'](_0x7a9898){return this['officialService']['getJsapiTicket'](_0x7a9898['url']);}async[_0x2e0a9a(0xc7)](_0xa4d23a,_0x1cc7a2){const _0x5553a6=_0x2e0a9a;return this[_0x5553a6(0xcf)]['loginByCode'](_0xa4d23a,_0x1cc7a2['code']);}};function _0x53fc(){const _0x461686=['xml:\x20','env','msgtype','@nestjs/common','公众号静默登录','1255384MLKDIN','getQRCodeTicket','ApiOperation','length','获取绑定二维码的sceneStr','30PcTSXa','Post','fromusername','officialSubscribeText','Res','Req','getRedirectUrl','OfficialController','log','./dto/getQrCode.dto','@nestjs/swagger','content','nonce','getQRSceneStrByBind','UseGuards','design:type','获取登录二维码sceneStr','verify','Body','url','获取二维码','74748qWAabo','sceneStr','278948KxZJVJ','loginByCode','SCAN','./official.service','decorate','getQRCode','object','echostr','getQRSceneStr','officialService','scan','notifyPost','扫码绑定轮询查询','https://mp.weixin.qq.com/cgi-bin/showqrcode?ticket=','扫码登录轮询查询','defineProperty','design:returntype','获取注册配置','sceneStr:\x20','loginBySceneStr','__decorate','subscribe','6OpaRuW','prototype','design:paramtypes','GetQrSceneStrDto','Query','getOwnPropertyDescriptor','event','signature','bindWxBySceneStr','status','1494fvGSds','eventkey','216497ssbEwY','send','scanBindWx','216377sgtDYj','公众号通知接口POST','338160KBuIiM','get\x20通知>>>','unsubscribe','5600LhhAJD','official','split','qrscene_','getJsapiTicket','__metadata','获取登录跳转地址','./dto/getQrSceneStr.dto','officialBindAccountText','text','__param','TRUE','JwtAuthGuard','genXmlMsgByConfig','GetQrCodeDto','function','notify','officialScanLoginText'];_0x53fc=function(){return _0x461686;};return _0x53fc();}__decorate([(0x0,common_1['Get'])(_0x2e0a9a(0x100)),(0x0,swagger_1[_0x2e0a9a(0x109)])({'summary':'公众号通知接口GET'}),__param(0x0,(0x0,common_1[_0x2e0a9a(0xb4)])()),__param(0x1,(0x0,common_1[_0x2e0a9a(0xe0)])()),__param(0x2,(0x0,common_1[_0x2e0a9a(0xc1)])()),__metadata('design:type',Function),__metadata(_0x2e0a9a(0xde),[Object,Object,Object]),__metadata(_0x2e0a9a(0xd6),Promise)],OfficialController['prototype'],_0x2e0a9a(0x100),null),__decorate([(0x0,common_1[_0x2e0a9a(0xb0)])('notify'),(0x0,swagger_1[_0x2e0a9a(0x109)])({'summary':_0x2e0a9a(0xec)}),__param(0x0,(0x0,common_1[_0x2e0a9a(0xb4)])()),__param(0x1,(0x0,common_1[_0x2e0a9a(0xe0)])()),__param(0x2,(0x0,common_1['Body'])()),__param(0x3,(0x0,common_1[_0x2e0a9a(0xb3)])()),__metadata(_0x2e0a9a(0xbe),Function),__metadata(_0x2e0a9a(0xde),[Object,Object,Object,Object]),__metadata(_0x2e0a9a(0xd6),Promise)],OfficialController['prototype'],'notifyPost',null),__decorate([(0x0,common_1[_0x2e0a9a(0xb0)])('getQRSceneStr'),(0x0,swagger_1['ApiOperation'])({'summary':_0x2e0a9a(0xbf)}),__param(0x0,(0x0,common_1[_0x2e0a9a(0xc1)])()),__metadata(_0x2e0a9a(0xbe),Function),__metadata(_0x2e0a9a(0xde),[getQrSceneStr_dto_1[_0x2e0a9a(0xdf)]]),__metadata('design:returntype',Promise)],OfficialController[_0x2e0a9a(0xdd)],_0x2e0a9a(0xce),null),__decorate([(0x0,common_1[_0x2e0a9a(0xb0)])(_0x2e0a9a(0xbc)),(0x0,swagger_1[_0x2e0a9a(0x109)])({'summary':_0x2e0a9a(0x10b)}),(0x0,common_1[_0x2e0a9a(0xbd)])(jwtAuth_guard_1[_0x2e0a9a(0xfc)]),__param(0x0,(0x0,common_1[_0x2e0a9a(0xb4)])()),__metadata(_0x2e0a9a(0xbe),Function),__metadata('design:paramtypes',[Object]),__metadata(_0x2e0a9a(0xd6),Promise)],OfficialController['prototype'],'getQRSceneStrByBind',null),__decorate([(0x0,common_1['Get'])(_0x2e0a9a(0xcb)),(0x0,swagger_1[_0x2e0a9a(0x109)])({'summary':_0x2e0a9a(0xc3)}),__param(0x0,(0x0,common_1[_0x2e0a9a(0xe0)])()),__metadata(_0x2e0a9a(0xbe),Function),__metadata(_0x2e0a9a(0xde),[getQrCode_dto_1[_0x2e0a9a(0xfe)]]),__metadata(_0x2e0a9a(0xd6),Promise)],OfficialController['prototype'],_0x2e0a9a(0xcb),null),__decorate([(0x0,common_1[_0x2e0a9a(0xb0)])('loginBySceneStr'),(0x0,swagger_1[_0x2e0a9a(0x109)])({'summary':_0x2e0a9a(0xd4)}),__param(0x0,(0x0,common_1[_0x2e0a9a(0xb4)])()),__param(0x1,(0x0,common_1['Body'])()),__metadata(_0x2e0a9a(0xbe),Function),__metadata(_0x2e0a9a(0xde),[Object,getQrCode_dto_1[_0x2e0a9a(0xfe)]]),__metadata(_0x2e0a9a(0xd6),Promise)],OfficialController[_0x2e0a9a(0xdd)],_0x2e0a9a(0xd9),null),__decorate([(0x0,common_1['Post'])(_0x2e0a9a(0xe4)),(0x0,swagger_1['ApiOperation'])({'summary':_0x2e0a9a(0xd2)}),(0x0,common_1[_0x2e0a9a(0xbd)])(jwtAuth_guard_1[_0x2e0a9a(0xfc)]),__param(0x0,(0x0,common_1[_0x2e0a9a(0xb4)])()),__param(0x1,(0x0,common_1[_0x2e0a9a(0xc1)])()),__metadata(_0x2e0a9a(0xbe),Function),__metadata(_0x2e0a9a(0xde),[Object,getQrCode_dto_1[_0x2e0a9a(0xfe)]]),__metadata('design:returntype',Promise)],OfficialController[_0x2e0a9a(0xdd)],'bindWxBySceneStr',null),__decorate([(0x0,common_1[_0x2e0a9a(0xb0)])(_0x2e0a9a(0xb5)),(0x0,swagger_1[_0x2e0a9a(0x109)])({'summary':_0x2e0a9a(0xf6)}),__param(0x0,(0x0,common_1[_0x2e0a9a(0xc1)])()),__metadata(_0x2e0a9a(0xbe),Function),__metadata(_0x2e0a9a(0xde),[Object]),__metadata('design:returntype',Promise)],OfficialController['prototype'],_0x2e0a9a(0xb5),null),__decorate([(0x0,common_1[_0x2e0a9a(0xb0)])(_0x2e0a9a(0xf4)),(0x0,swagger_1[_0x2e0a9a(0x109)])({'summary':_0x2e0a9a(0xd7)}),__param(0x0,(0x0,common_1['Body'])()),__metadata(_0x2e0a9a(0xbe),Function),__metadata('design:paramtypes',[Object]),__metadata(_0x2e0a9a(0xd6),Promise)],OfficialController[_0x2e0a9a(0xdd)],_0x2e0a9a(0xf4),null),__decorate([(0x0,common_1[_0x2e0a9a(0xb0)])(_0x2e0a9a(0xc7)),(0x0,swagger_1['ApiOperation'])({'summary':_0x2e0a9a(0x106)}),__param(0x0,(0x0,common_1[_0x2e0a9a(0xb4)])()),__param(0x1,(0x0,common_1[_0x2e0a9a(0xc1)])()),__metadata('design:type',Function),__metadata('design:paramtypes',[Object,Object]),__metadata('design:returntype',Promise)],OfficialController[_0x2e0a9a(0xdd)],'loginByCode',null),OfficialController=__decorate([(0x0,swagger_1['ApiTags'])('official'),(0x0,common_1['Controller'])(_0x2e0a9a(0xf1)),__metadata(_0x2e0a9a(0xde),[official_service_1['OfficialService']])],OfficialController),exports['OfficialController']=OfficialController;