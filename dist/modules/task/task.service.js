'use strict';function _0x3e23(_0x15a1e9,_0x167a83){const _0x1f7f7b=_0x1f7f();return _0x3e23=function(_0x3e23e0,_0x56949e){_0x3e23e0=_0x3e23e0-0xf9;let _0x2e97cd=_0x1f7f7b[_0x3e23e0];return _0x2e97cd;},_0x3e23(_0x15a1e9,_0x167a83);}const _0x2c9396=_0x3e23;(function(_0x2e9687,_0x311160){const _0xadf0b7=_0x3e23,_0x3b5ea8=_0x2e9687();while(!![]){try{const _0xdd678e=parseInt(_0xadf0b7(0x123))/0x1+parseInt(_0xadf0b7(0x103))/0x2+parseInt(_0xadf0b7(0x11d))/0x3*(parseInt(_0xadf0b7(0x129))/0x4)+parseInt(_0xadf0b7(0x12c))/0x5+parseInt(_0xadf0b7(0xfa))/0x6+-parseInt(_0xadf0b7(0x118))/0x7*(parseInt(_0xadf0b7(0x12b))/0x8)+parseInt(_0xadf0b7(0x11a))/0x9*(-parseInt(_0xadf0b7(0x11b))/0xa);if(_0xdd678e===_0x311160)break;else _0x3b5ea8['push'](_0x3b5ea8['shift']());}catch(_0x3aa783){_0x3b5ea8['push'](_0x3b5ea8['shift']());}}}(_0x1f7f,0x93692));function _0x1f7f(){const _0xd6373e=['design:paramtypes','@nestjs/common','drawService','debug','@nestjs/schedule','4956162kmQHes','EVERY_2_HOURS','checkauth','getConfigWithFrontEnd','forEach','typeorm','uplog','getOwnPropertyDescriptor','object','2023188tSWPqh','Logger','refreshBaiduAccesstoken','0\x200\x20*/5\x20*\x20*','Cron','userBalanceEntity','design:type','__decorate','LessThanOrEqual','__esModule','Repository','metadata','defineProperty','length','EVERY_HOUR','taskCroppingThumbUrl','@nestjs/typeorm','decorate','CronExpression','design:returntype','find','7HvqEfq','./../globalConfig/globalConfig.service','378KxXOsQ','699320HOkinL','../userBalance/userBalance.entity','3cXLwjU','TaskService','globalConfigService','InjectRepository','DrawService','EVERY_5_MINUTES','1042152qCyQkr','0\x200\x20*\x20*\x20*','handleCron','prototype','function','__metadata','4730308cMDYoZ','ModelsService','8965240uRDfqK','2996215DjBfit','modelsService','__param','会员已到期、清空所有余额并移除会员身份！','checkUserMemerExpire','UserBalanceEntity'];_0x1f7f=function(){return _0xd6373e;};return _0x1f7f();}var __decorate=this&&this[_0x2c9396(0x10a)]||function(_0x4a0bd6,_0x4b33c9,_0x2750b9,_0x54782f){const _0x33db2b=_0x2c9396;var _0xc1f052=arguments[_0x33db2b(0x110)],_0x18fe32=_0xc1f052<0x3?_0x4b33c9:_0x54782f===null?_0x54782f=Object[_0x33db2b(0x101)](_0x4b33c9,_0x2750b9):_0x54782f,_0x508892;if(typeof Reflect===_0x33db2b(0x102)&&typeof Reflect['decorate']===_0x33db2b(0x127))_0x18fe32=Reflect[_0x33db2b(0x114)](_0x4a0bd6,_0x4b33c9,_0x2750b9,_0x54782f);else{for(var _0x3a12d5=_0x4a0bd6['length']-0x1;_0x3a12d5>=0x0;_0x3a12d5--)if(_0x508892=_0x4a0bd6[_0x3a12d5])_0x18fe32=(_0xc1f052<0x3?_0x508892(_0x18fe32):_0xc1f052>0x3?_0x508892(_0x4b33c9,_0x2750b9,_0x18fe32):_0x508892(_0x4b33c9,_0x2750b9))||_0x18fe32;}return _0xc1f052>0x3&&_0x18fe32&&Object[_0x33db2b(0x10f)](_0x4b33c9,_0x2750b9,_0x18fe32),_0x18fe32;},__metadata=this&&this[_0x2c9396(0x128)]||function(_0x5ac80d,_0x395aa5){const _0x17b68a=_0x2c9396;if(typeof Reflect===_0x17b68a(0x102)&&typeof Reflect[_0x17b68a(0x10e)]===_0x17b68a(0x127))return Reflect['metadata'](_0x5ac80d,_0x395aa5);},__param=this&&this[_0x2c9396(0x12e)]||function(_0x460111,_0x141794){return function(_0x184458,_0x2d6d1f){_0x141794(_0x184458,_0x2d6d1f,_0x460111);};};Object[_0x2c9396(0x10f)](exports,_0x2c9396(0x10c),{'value':!![]}),exports[_0x2c9396(0x11e)]=void 0x0;const globalConfig_service_1=require(_0x2c9396(0x119)),common_1=require(_0x2c9396(0x133)),schedule_1=require(_0x2c9396(0xf9)),userBalance_entity_1=require(_0x2c9396(0x11c)),typeorm_1=require(_0x2c9396(0x113)),typeorm_2=require(_0x2c9396(0xff)),models_service_1=require('../models/models.service'),draw_service_1=require('../draw/draw.service');let TaskService=class TaskService{constructor(_0xbcc5db,_0x5b1004,_0x2ac40a,_0x449ecc){const _0x1e91af=_0x2c9396;this[_0x1e91af(0x108)]=_0xbcc5db,this['globalConfigService']=_0x5b1004,this[_0x1e91af(0x12d)]=_0x2ac40a,this[_0x1e91af(0x134)]=_0x449ecc;}[_0x2c9396(0x125)](){const _0x424012=_0x2c9396;common_1[_0x424012(0x104)][_0x424012(0x135)]('Automatically\x20refresh\x20WeChat\x20access\x20every\x20hour\x20Token',_0x424012(0x11e)),this[_0x424012(0x11f)]['getWechatAccessToken']();}['checkauth'](){}[_0x2c9396(0x100)](){const _0x393e09=_0x2c9396;this[_0x393e09(0x11f)][_0x393e09(0xfd)]();}async[_0x2c9396(0x130)](){const _0x2e18cf=_0x2c9396,_0x369c12=await this['userBalanceEntity'][_0x2e18cf(0x117)]({'where':{'expirationTime':(0x0,typeorm_2[_0x2e18cf(0x10b)])(new Date())}});if(!_0x369c12||!_0x369c12['length'])return;_0x369c12[_0x2e18cf(0xfe)](_0x34c68c=>{const _0x57b5b0=_0x2e18cf;this[_0x57b5b0(0x108)]['update']({'id':_0x34c68c['id']},{'expirationTime':null,'packageId':0x0,'memberModel3Count':0x0,'memberModel4Count':0x0,'memberDrawMjCount':0x0})['then'](_0x5cc366=>{const _0x528148=_0x57b5b0;common_1[_0x528148(0x104)]['debug'](_0x34c68c['id']+_0x528148(0x12f),_0x528148(0x11e));});});}['refreshBaiduAccesstoken'](){const _0x18a101=_0x2c9396;this[_0x18a101(0x12d)][_0x18a101(0x105)]();}[_0x2c9396(0x112)](){const _0x6c3b89=_0x2c9396;this[_0x6c3b89(0x134)][_0x6c3b89(0x112)]();}};__decorate([(0x0,schedule_1[_0x2c9396(0x107)])(schedule_1[_0x2c9396(0x115)][_0x2c9396(0x111)]),__metadata(_0x2c9396(0x109),Function),__metadata(_0x2c9396(0x132),[]),__metadata(_0x2c9396(0x116),void 0x0)],TaskService['prototype'],_0x2c9396(0x125),null),__decorate([(0x0,schedule_1[_0x2c9396(0x107)])(schedule_1[_0x2c9396(0x115)][_0x2c9396(0x111)]),__metadata(_0x2c9396(0x109),Function),__metadata(_0x2c9396(0x132),[]),__metadata(_0x2c9396(0x116),void 0x0)],TaskService[_0x2c9396(0x126)],_0x2c9396(0xfc),null),__decorate([(0x0,schedule_1[_0x2c9396(0x107)])(schedule_1['CronExpression'][_0x2c9396(0xfb)]),__metadata(_0x2c9396(0x109),Function),__metadata(_0x2c9396(0x132),[]),__metadata('design:returntype',void 0x0)],TaskService[_0x2c9396(0x126)],_0x2c9396(0x100),null),__decorate([(0x0,schedule_1[_0x2c9396(0x107)])(schedule_1['CronExpression'][_0x2c9396(0x122)]),__metadata(_0x2c9396(0x109),Function),__metadata('design:paramtypes',[]),__metadata('design:returntype',Promise)],TaskService['prototype'],'checkUserMemerExpire',null),__decorate([(0x0,schedule_1[_0x2c9396(0x107)])(_0x2c9396(0x106)),__metadata(_0x2c9396(0x109),Function),__metadata(_0x2c9396(0x132),[]),__metadata(_0x2c9396(0x116),void 0x0)],TaskService[_0x2c9396(0x126)],'refreshBaiduAccesstoken',null),__decorate([(0x0,schedule_1[_0x2c9396(0x107)])(_0x2c9396(0x124)),__metadata(_0x2c9396(0x109),Function),__metadata('design:paramtypes',[]),__metadata(_0x2c9396(0x116),void 0x0)],TaskService[_0x2c9396(0x126)],_0x2c9396(0x112),null),TaskService=__decorate([(0x0,common_1['Injectable'])(),__param(0x0,(0x0,typeorm_1[_0x2c9396(0x120)])(userBalance_entity_1[_0x2c9396(0x131)])),__metadata(_0x2c9396(0x132),[typeorm_2[_0x2c9396(0x10d)],globalConfig_service_1['GlobalConfigService'],models_service_1[_0x2c9396(0x12a)],draw_service_1[_0x2c9396(0x121)]])],TaskService),exports['TaskService']=TaskService;