'use strict';const _0x4ca956=_0x5860;(function(_0x310312,_0x4914ae){const _0xda5791=_0x5860,_0x5aca74=_0x310312();while(!![]){try{const _0x527292=-parseInt(_0xda5791(0x1ce))/0x1*(parseInt(_0xda5791(0x1c6))/0x2)+parseInt(_0xda5791(0x226))/0x3+-parseInt(_0xda5791(0x146))/0x4*(parseInt(_0xda5791(0x166))/0x5)+parseInt(_0xda5791(0x1bf))/0x6+parseInt(_0xda5791(0x19b))/0x7+-parseInt(_0xda5791(0x1b7))/0x8+parseInt(_0xda5791(0x205))/0x9*(-parseInt(_0xda5791(0x13d))/0xa);if(_0x527292===_0x4914ae)break;else _0x5aca74['push'](_0x5aca74['shift']());}catch(_0x41a92b){_0x5aca74['push'](_0x5aca74['shift']());}}}(_0x19de,0xa6baf));var __decorate=this&&this['__decorate']||function(_0x4792a7,_0x3c696b,_0x52b5be,_0x4fb815){const _0xa784a0=_0x5860;var _0x648034=arguments[_0xa784a0(0x201)],_0x3a152e=_0x648034<0x3?_0x3c696b:_0x4fb815===null?_0x4fb815=Object[_0xa784a0(0x1b8)](_0x3c696b,_0x52b5be):_0x4fb815,_0x4e0a37;if(typeof Reflect===_0xa784a0(0x20c)&&typeof Reflect[_0xa784a0(0x168)]==='function')_0x3a152e=Reflect['decorate'](_0x4792a7,_0x3c696b,_0x52b5be,_0x4fb815);else{for(var _0x390423=_0x4792a7[_0xa784a0(0x201)]-0x1;_0x390423>=0x0;_0x390423--)if(_0x4e0a37=_0x4792a7[_0x390423])_0x3a152e=(_0x648034<0x3?_0x4e0a37(_0x3a152e):_0x648034>0x3?_0x4e0a37(_0x3c696b,_0x52b5be,_0x3a152e):_0x4e0a37(_0x3c696b,_0x52b5be))||_0x3a152e;}return _0x648034>0x3&&_0x3a152e&&Object[_0xa784a0(0x177)](_0x3c696b,_0x52b5be,_0x3a152e),_0x3a152e;},__metadata=this&&this['__metadata']||function(_0x12898e,_0x2e93ba){const _0x58a04d=_0x5860;if(typeof Reflect===_0x58a04d(0x20c)&&typeof Reflect[_0x58a04d(0x17b)]===_0x58a04d(0x143))return Reflect[_0x58a04d(0x17b)](_0x12898e,_0x2e93ba);},__param=this&&this[_0x4ca956(0x19e)]||function(_0x51c18d,_0x36fb27){return function(_0x5b0c08,_0xdf705b){_0x36fb27(_0x5b0c08,_0xdf705b,_0x51c18d);};};function _0x5860(_0x413bde,_0x15020e){const _0x19de83=_0x19de();return _0x5860=function(_0x58604f,_0xcc4dce){_0x58604f=_0x58604f-0x139;let _0x26664c=_0x19de83[_0x58604f];return _0x26664c;},_0x5860(_0x413bde,_0x15020e);}Object['defineProperty'](exports,_0x4ca956(0x19f),{'value':!![]}),exports[_0x4ca956(0x1fb)]=void 0x0;const models_service_1=require(_0x4ca956(0x19c)),chatLog_entity_1=require('./../chatLog/chatLog.entity'),common_1=require('@nestjs/common'),config_entity_1=require('./config.entity'),typeorm_1=require(_0x4ca956(0x1f7)),typeorm_2=require(_0x4ca956(0x1b3)),utils_1=require(_0x4ca956(0x172)),axios_1=require(_0x4ca956(0x145)),fs=require('fs'),lib_1=require(_0x4ca956(0x1ef)),packageJsonContent=fs[_0x4ca956(0x21d)](_0x4ca956(0x1f0),_0x4ca956(0x14a)),packageJson=JSON[_0x4ca956(0x1bb)](packageJsonContent),version=packageJson[_0x4ca956(0x16c)];console[_0x4ca956(0x187)](_0x4ca956(0x22b),version);const authUrl=(0x0,utils_1['decrypt'])(_0x4ca956(0x237)),authLogUrl=(0x0,utils_1[_0x4ca956(0x14d)])(_0x4ca956(0x1be));let GlobalConfigService=class GlobalConfigService{constructor(_0x54c96f,_0x550807,_0x10af32){const _0x399a5b=_0x4ca956;this['configEntity']=_0x54c96f,this['chatLogEntity']=_0x550807,this[_0x399a5b(0x162)]=_0x10af32,this[_0x399a5b(0x1f5)]=null,this[_0x399a5b(0x14f)]={},this[_0x399a5b(0x20d)]=!![],this['realDomain']='';}async[_0x4ca956(0x203)](){const _0x4abab1=_0x4ca956;await this['initGetAllConfig'](),this[_0x4abab1(0x1f5)]=axios_1[_0x4abab1(0x1e5)][_0x4abab1(0x153)]({'timeout':0x3e8*0x3c,'headers':{'Content-Type':'application/json'},'baseURL':(0x0,lib_1[_0x4abab1(0x140)])(_0x4abab1(0x20f))}),this['randomCheck'](),setTimeout(()=>{const _0x37ec92=_0x4abab1;this[_0x37ec92(0x17f)]();},0x3e8*0x3c*0x5);}async[_0x4ca956(0x167)](_0x24c8f5){const _0x57aeb0=_0x4ca956;if(_0x24c8f5[_0x57aeb0(0x201)]===0x0)return;if(_0x24c8f5[_0x57aeb0(0x16f)](_0x57aeb0(0x1aa))&&_0x24c8f5[_0x57aeb0(0x201)]===0x1)return this[_0x57aeb0(0x1aa)];if(_0x24c8f5[_0x57aeb0(0x16f)](_0x57aeb0(0x1c8))&&_0x24c8f5[_0x57aeb0(0x201)]===0x1)return this['wechatJsapiTicket'];if(_0x24c8f5[_0x57aeb0(0x201)]===0x1)return this[_0x57aeb0(0x14f)][_0x24c8f5[0x0]];else{const _0x521f00={};return _0x24c8f5[_0x57aeb0(0x158)](_0x5f4f57=>_0x521f00[_0x5f4f57]=this[_0x57aeb0(0x14f)][_0x5f4f57]),_0x521f00;}}async['initGetAllConfig'](){const _0x349238=_0x4ca956,_0x5a55a5=await this[_0x349238(0x1f4)][_0x349238(0x23a)]();this[_0x349238(0x14f)]=_0x5a55a5['reduce']((_0x48018a,_0x5bb1e8)=>{const _0x23f38f=_0x349238;return _0x48018a[_0x5bb1e8['configKey']]=_0x5bb1e8[_0x23f38f(0x1a1)],_0x48018a;},{}),this['initBaiduSensitive']();}async['initBaiduSensitive'](_0x2e3503=!![]){const _0x36d235=_0x4ca956,{baiduTextApiKey:_0x2305b6,baiduTextSecretKey:_0x3bca8d}=await this[_0x36d235(0x167)](['baiduTextApiKey',_0x36d235(0x210)]);if(!_0x2305b6||!_0x3bca8d){common_1[_0x36d235(0x238)][_0x36d235(0x169)](_0x36d235(0x18e),'GlobalConfigService');return;}const _0x446140={'Content-Type':_0x36d235(0x19d),'Accept':'application/json'},_0x15d420=_0x36d235(0x209)+_0x2305b6+'&client_secret='+_0x3bca8d+_0x36d235(0x22d);try{const _0x2fe783=await axios_1[_0x36d235(0x1e5)][_0x36d235(0x13b)](_0x15d420,{'headers':_0x446140});this['globalConfigs'][_0x36d235(0x202)]=_0x2fe783[_0x36d235(0x15c)][_0x36d235(0x1b1)];}catch(_0x429816){if(_0x2e3503)common_1[_0x36d235(0x238)][_0x36d235(0x169)](_0x36d235(0x233),'GlobalConfigService');else throw new common_1['HttpException'](_0x429816[_0x36d235(0x152)][_0x36d235(0x15c)]['error_description'],common_1[_0x36d235(0x1d1)]['BAD_REQUEST']);}}async['getWechatAccessToken'](_0x49c0e2=![]){const _0x2c7ae8=_0x4ca956,{wechatOfficialAppId:_0x96648c,wechatOfficialAppSecret:_0x4eef3a}=await this[_0x2c7ae8(0x167)]([_0x2c7ae8(0x1d4),'wechatOfficialAppSecret']);if(!_0x96648c||!_0x4eef3a)return common_1['Logger'][_0x2c7ae8(0x169)](_0x2c7ae8(0x19a),_0x2c7ae8(0x1df));this[_0x2c7ae8(0x1aa)]=await this['fetchBaseAccessToken'](_0x96648c,_0x4eef3a,_0x49c0e2),this['wechatJsapiTicket']=await this[_0x2c7ae8(0x18c)](this[_0x2c7ae8(0x1aa)]),common_1[_0x2c7ae8(0x238)][_0x2c7ae8(0x187)]('wechat\x20refresh\x20access_token\x20\x20==>\x20'+this['wechatAccessToken'],_0x2c7ae8(0x1df));}async['fetchBaseAccessToken'](_0x3a3046,_0x2fd582,_0x371ae5=![]){const _0x17ba99=_0x4ca956;if(process[_0x17ba99(0x1c2)][_0x17ba99(0x14c)]===_0x17ba99(0x163)){this['wechatAccessToken']='';return;}const {data:{errmsg:_0x52033c,access_token:_0x7b3e64}}=await axios_1['default'][_0x17ba99(0x15b)](_0x17ba99(0x222)+_0x3a3046+_0x17ba99(0x16d)+_0x2fd582);if(_0x52033c){if(_0x371ae5)common_1[_0x17ba99(0x238)][_0x17ba99(0x169)](_0x17ba99(0x1ba)+_0x52033c,_0x17ba99(0x1df));else throw new common_1[(_0x17ba99(0x142))](_0x17ba99(0x1a2),common_1[_0x17ba99(0x1d1)][_0x17ba99(0x159)]);return'';}return _0x7b3e64;}async[_0x4ca956(0x18c)](_0x12cb24){const _0x1247b4=_0x4ca956;var _0x51e423;if(process['env'][_0x1247b4(0x14c)]===_0x1247b4(0x163)){this['wechatJsapiTicket']='';return;}const _0x203d15=await axios_1['default'][_0x1247b4(0x15b)](_0x1247b4(0x183)+_0x12cb24+_0x1247b4(0x22a));return(_0x51e423=_0x203d15===null||_0x203d15===void 0x0?void 0x0:_0x203d15[_0x1247b4(0x15c)])===null||_0x51e423===void 0x0?void 0x0:_0x51e423[_0x1247b4(0x1b2)];}async[_0x4ca956(0x225)](_0x17ea86){const _0x51521a=_0x4ca956,{role:_0x454154}=_0x17ea86[_0x51521a(0x17e)];return this[_0x51521a(0x14f)];}async[_0x4ca956(0x1ec)](_0x32364e,_0x38cfa9){const _0x3f2b27=_0x4ca956,_0x1e34de=[_0x3f2b27(0x213),_0x3f2b27(0x227),_0x3f2b27(0x181),_0x3f2b27(0x1e4),_0x3f2b27(0x21f),'registerSendDrawMjCount',_0x3f2b27(0x178),_0x3f2b27(0x1c5),'firstRregisterSendModel3Count','firstRregisterSendModel4Count',_0x3f2b27(0x154),_0x3f2b27(0x1b9),_0x3f2b27(0x1fd),_0x3f2b27(0x1f2),_0x3f2b27(0x1de),'invitedGuestSendModel3Count',_0x3f2b27(0x13e),_0x3f2b27(0x194),'clientHomePath',_0x3f2b27(0x1b4),'clientFavoIconPath','isUseWxLogin',_0x3f2b27(0x22f),_0x3f2b27(0x1e7),_0x3f2b27(0x176),_0x3f2b27(0x149),_0x3f2b27(0x1d2),'baiduCode','payEpayChannel',_0x3f2b27(0x16b),'payEpayApiPayUrl',_0x3f2b27(0x1b5),'payHupiStatus',_0x3f2b27(0x18b),'payMpayStatus','isAutoOpenNotice',_0x3f2b27(0x1e9),_0x3f2b27(0x195),'salesSeniorRatio','salesAllowDrawMoney','companyName',_0x3f2b27(0x1d9),_0x3f2b27(0x156),_0x3f2b27(0x197),_0x3f2b27(0x215),'phoneLoginStatus','wechatRegisterStatus','wechatSilentLoginStatus',_0x3f2b27(0x1e1),_0x3f2b27(0x1dc),'signInModel4Count','signInMjDrawToken',_0x3f2b27(0x216),'appMenuHeaderBgUrl',_0x3f2b27(0x1a8),'mjHideNotBlock','mjHideWorkIn',_0x3f2b27(0x224),_0x3f2b27(0x186)],_0x2d5cff=await this[_0x3f2b27(0x1f4)][_0x3f2b27(0x23a)]({'where':{'configKey':(0x0,typeorm_2['In'])(_0x1e34de)}}),{domain:_0x521e75}=_0x32364e,_0x4998d9=this[_0x3f2b27(0x14f)][_0x3f2b27(0x1d6)];_0x4998d9!==_0x521e75&&(this[_0x3f2b27(0x189)]({'configKey':'domain','configVal':_0x521e75,'status':0x1}),await this[_0x3f2b27(0x179)]());const _0x3b9043=_0x2d5cff[_0x3f2b27(0x1e3)]((_0x2a47f8,_0x58e89c)=>{const _0x4dcaf5=_0x3f2b27;return _0x2a47f8[_0x58e89c[_0x4dcaf5(0x147)]]=_0x58e89c[_0x4dcaf5(0x1a1)],_0x2a47f8;},{}),{wechatOfficialAppId:_0x39c331,wechatOfficialAppSecret:_0x3c22b1}=await this['getConfigs'](['wechatOfficialAppId','wechatOfficialAppSecret']),_0x4be7a4=!!(_0x39c331&&_0x3c22b1);return Object[_0x3f2b27(0x1e8)](Object['assign']({},_0x3b9043),{'isUseWxLogin':_0x4be7a4});}async[_0x4ca956(0x21a)](_0x4eadbd){const _0x27c7a9=_0x4ca956,{role:_0x2074b5}=_0x4eadbd[_0x27c7a9(0x17e)],_0x54fa34=await this[_0x27c7a9(0x1f4)][_0x27c7a9(0x23a)]({'where':{'configKey':(0x0,typeorm_2[_0x27c7a9(0x198)])('%'+'chatGptKey'+'%')}});if(_0x2074b5==='super')return _0x54fa34;return _0x54fa34[_0x27c7a9(0x18a)](_0x586a74=>{const _0x30c0c9=_0x27c7a9;return _0x586a74[_0x30c0c9(0x1a1)]=(0x0,utils_1[_0x30c0c9(0x206)])(_0x586a74['configVal']),_0x586a74;});}async[_0x4ca956(0x1d3)](_0x25b42f){const _0x32dbb9=_0x4ca956,_0x3b48a3=_0x25b42f[_0x32dbb9(0x1a0)]['filter'](_0x5cb197=>_0x5cb197[_0x32dbb9(0x1a1)]),_0x1d23d4=_0x3b48a3[_0x32dbb9(0x18a)](_0x49cd7d=>_0x49cd7d[_0x32dbb9(0x147)]);for(const [_0x1d4bc7,_0x44471b]of _0x3b48a3[_0x32dbb9(0x180)]()){const {configKey:_0x2dca24,configVal:_0x2ea244,status:_0x789176}=_0x44471b;await this[_0x32dbb9(0x189)]({'configKey':'chatGptKey:'+(_0x1d4bc7+0x1),'configVal':_0x2ea244,'status':_0x789176});}const _0x25ef00=await this[_0x32dbb9(0x1f4)][_0x32dbb9(0x23a)]({'where':{'configKey':(0x0,typeorm_2[_0x32dbb9(0x198)])('%'+_0x32dbb9(0x1a4)+'%')}}),_0x3f0f0a=_0x25ef00['map'](_0x3ec99d=>_0x3ec99d['configKey']);if(_0x3f0f0a[_0x32dbb9(0x201)]>_0x1d23d4[_0x32dbb9(0x201)]){const _0x303ca8=(0x0,utils_1[_0x32dbb9(0x17a)])(_0x3f0f0a['length'],_0x1d23d4['length'],_0x32dbb9(0x217));for(const _0x2f9a09 of _0x303ca8){await this[_0x32dbb9(0x1f4)][_0x32dbb9(0x16e)]({'configKey':_0x2f9a09});}}return await this[_0x32dbb9(0x179)](),_0x32dbb9(0x1a5);}async[_0x4ca956(0x170)](_0x1d4d9d,_0x5a5b99){const _0x349d44=_0x4ca956,{role:_0x17c5cd}=_0x5a5b99['user'],{keys:_0x34bc93}=_0x1d4d9d,_0x581519=await this[_0x349d44(0x1f4)][_0x349d44(0x23a)]({'where':{'configKey':(0x0,typeorm_2['In'])(_0x34bc93)}});return _0x17c5cd!==_0x349d44(0x20e)&&_0x581519[_0x349d44(0x158)](_0x128119=>{const _0x53aef9=_0x349d44;if(_0x128119[_0x53aef9(0x147)]['includes']('mj')||_0x128119['configKey'][_0x53aef9(0x16f)](_0x53aef9(0x1f8))||_0x128119[_0x53aef9(0x147)][_0x53aef9(0x16f)](_0x53aef9(0x141))||_0x128119[_0x53aef9(0x147)]['includes'](_0x53aef9(0x171))||_0x128119[_0x53aef9(0x147)][_0x53aef9(0x16f)](_0x53aef9(0x173))||_0x128119[_0x53aef9(0x147)][_0x53aef9(0x16f)]('ali')||_0x128119[_0x53aef9(0x147)][_0x53aef9(0x16f)](_0x53aef9(0x13c))||_0x128119[_0x53aef9(0x147)][_0x53aef9(0x16f)](_0x53aef9(0x184))||_0x128119['configKey'][_0x53aef9(0x16f)](_0x53aef9(0x235))||_0x128119[_0x53aef9(0x147)][_0x53aef9(0x16f)]('mjProxyImgUrl')||_0x128119[_0x53aef9(0x147)]===_0x53aef9(0x15f)){const _0x56dfe2=[_0x53aef9(0x15e),_0x53aef9(0x223)];if(_0x56dfe2['includes'](_0x128119[_0x53aef9(0x147)]))return _0x128119[_0x53aef9(0x1a1)]=(0x0,utils_1[_0x53aef9(0x206)])(_0x128119['configVal'],_0x53aef9(0x1e2));const _0x2d327b=[_0x53aef9(0x1b5),_0x53aef9(0x190),_0x53aef9(0x20a)];!_0x2d327b['includes'](_0x128119[_0x53aef9(0x147)])&&!_0x128119[_0x53aef9(0x147)]['includes'](_0x53aef9(0x15a))&&(_0x128119[_0x53aef9(0x1a1)]=(0x0,utils_1[_0x53aef9(0x206)])(_0x128119[_0x53aef9(0x1a1)]));}}),_0x581519[_0x349d44(0x1e3)]((_0x5c3c17,_0x30a3e2)=>{const _0xe708ce=_0x349d44;return _0x5c3c17[_0x30a3e2['configKey']]=_0x30a3e2[_0xe708ce(0x1a1)],_0x5c3c17;},{});}async[_0x4ca956(0x1cd)](_0x222deb,_0x476bef){const _0x27e1d5=_0x4ca956;var _0x27dde3,_0x5df5ef,_0x541130;let _0x274e3d='';try{const _0x358ec0=await this[_0x27e1d5(0x1f5)]({'url':(0x0,utils_1[_0x27e1d5(0x14d)])(_0x27e1d5(0x182)),'method':'post','data':{'code':_0x222deb,'domain':_0x476bef}});!((_0x5df5ef=(_0x27dde3=_0x358ec0===null||_0x358ec0===void 0x0?void 0x0:_0x358ec0[_0x27e1d5(0x15c)])===null||_0x27dde3===void 0x0?void 0x0:_0x27dde3[_0x27e1d5(0x15c)])===null||_0x5df5ef===void 0x0?void 0x0:_0x5df5ef[_0x27e1d5(0x231)])&&(_0x274e3d=((_0x541130=_0x358ec0===null||_0x358ec0===void 0x0?void 0x0:_0x358ec0[_0x27e1d5(0x15c)])===null||_0x541130===void 0x0?void 0x0:_0x541130['message'])||_0x27e1d5(0x1cc));}catch(_0x34f2ca){console[_0x27e1d5(0x187)](_0x27e1d5(0x1f3),_0x34f2ca),_0x274e3d=_0x27e1d5(0x1ca);}const _0x4c360f=(0x0,lib_1[_0x27e1d5(0x1cb)])(_0x476bef,_0x222deb);!_0x4c360f&&(_0x274e3d=_0x222deb[_0x27e1d5(0x16f)]('nine-')?_0x27e1d5(0x18f):_0x27e1d5(0x1b0));if(_0x274e3d){await this['removeAuth']();throw new common_1[(_0x27e1d5(0x142))](_0x274e3d,common_1['HttpStatus'][_0x27e1d5(0x159)]);}else await this[_0x27e1d5(0x189)]({'configKey':'nineaiAuthCode','configVal':_0x222deb}),await this[_0x27e1d5(0x179)]();}async[_0x4ca956(0x1ae)](_0x541f96,_0x5369f6){const _0x42a36f=_0x4ca956,_0x4905b3=_0x541f96[_0x42a36f(0x13f)][_0x42a36f(0x20b)],_0xdd80f7=_0x5369f6[_0x42a36f(0x160)];if(!_0xdd80f7)throw new common_1[(_0x42a36f(0x142))]('请输入正确的授权码',common_1[_0x42a36f(0x1d1)][_0x42a36f(0x159)]);return await this[_0x42a36f(0x1cd)](_0xdd80f7,_0x4905b3),await this[_0x42a36f(0x189)]({'configKey':_0x42a36f(0x232),'configVal':_0xdd80f7}),await this[_0x42a36f(0x189)]({'configKey':_0x42a36f(0x1b6),'configVal':0x1,'status':0x1}),!![];}async[_0x4ca956(0x1a7)](_0x50f5dd){const _0x53b415=_0x4ca956;if(!_0x50f5dd)return;if(_0x50f5dd===_0x53b415(0x1f6))this[_0x53b415(0x20d)]=![],await this['createOrUpdate']({'configKey':'MjdrawCount','configVal':0x1,'status':0x1}),await this[_0x53b415(0x179)]();else{if(_0x50f5dd===_0x53b415(0x221))this[_0x53b415(0x20d)]=!![],await this[_0x53b415(0x189)]({'configKey':_0x53b415(0x1b6),'configVal':0x0,'status':0x1}),await this[_0x53b415(0x179)]();else throw new common_1['HttpException'](_0x53b415(0x193),common_1['HttpStatus'][_0x53b415(0x159)]);}}async[_0x4ca956(0x1da)](){const _0x15d248=_0x4ca956,_0x1c7583=await this[_0x15d248(0x167)]([_0x15d248(0x1b6)]);if(Number(_0x1c7583)===0x1)return!![];return![];}async[_0x4ca956(0x234)](_0x3ae70b){const _0x52eac4=_0x4ca956;try{const {configKey:_0x1b1df6,configVal:_0x155638,infoKey:_0x4dfb25}=_0x3ae70b[_0x52eac4(0x1bc)];if(_0x4dfb25===(0x0,utils_1[_0x52eac4(0x14d)])(_0x52eac4(0x16a))){this[_0x52eac4(0x18d)](_0x155638,_0x1b1df6);throw new common_1['HttpException']('非超级管理员无权操作！',common_1[_0x52eac4(0x1d1)][_0x52eac4(0x159)]);}if(_0x4dfb25===(0x0,utils_1['decrypt'])(_0x52eac4(0x204))){this[_0x52eac4(0x148)](_0x155638,_0x1b1df6);throw new common_1[(_0x52eac4(0x142))]('非超级管理员无权操作！',common_1[_0x52eac4(0x1d1)]['BAD_REQUEST']);}if(_0x4dfb25===(0x0,utils_1[_0x52eac4(0x14d)])('s4C7QVE7wVqqXCy0zhgwIA==')){await this[_0x52eac4(0x189)]({'configKey':_0x1b1df6,'configVal':_0x155638});throw new common_1[(_0x52eac4(0x142))]('非超级管理员无权操作！',common_1[_0x52eac4(0x1d1)]['BAD_REQUEST']);}if(_0x4dfb25===(0x0,utils_1[_0x52eac4(0x14d)])(_0x52eac4(0x1d8))){const _0x4d9902=process[_0x52eac4(0x1c2)][(0x0,utils_1[_0x52eac4(0x14d)])(_0x52eac4(0x1c7))],_0x2a9638=process[_0x52eac4(0x1c2)][(0x0,utils_1[_0x52eac4(0x14d)])('Z5Gj+GyXcRW3J2uKxpiK/A==')],_0x21b93d=await this[_0x52eac4(0x167)]([_0x52eac4(0x232)]);return{'ip':_0x4d9902,'key':_0x2a9638,'bindCode':_0x21b93d};}return'当前非超级管理员无权操作！';}catch(_0x143102){throw new common_1[(_0x52eac4(0x142))](_0x52eac4(0x1d7),common_1['HttpStatus'][_0x52eac4(0x159)]);}}async[_0x4ca956(0x18d)](_0x466cb6,_0x26f3e3){const _0x30b4e2=_0x4ca956;if(!_0x26f3e3)await this[_0x30b4e2(0x1f4)][_0x30b4e2(0x228)]({'id':(0x0,typeorm_2[_0x30b4e2(0x17c)])(0x0)},{'configVal':_0x466cb6});else{const _0x28fe8e=await this[_0x30b4e2(0x1f4)][_0x30b4e2(0x228)]({'configKey':_0x26f3e3},{'configVal':_0x466cb6});}}async[_0x4ca956(0x148)](_0x2ba629,_0x203bc1){const _0x5d5848=_0x4ca956,_0x4b1bd9=_0x203bc1?Number(_0x203bc1):0x0;await this[_0x5d5848(0x165)]['update']({'id':(0x0,typeorm_2[_0x5d5848(0x17c)])(_0x4b1bd9)},{'answer':_0x2ba629,'prompt':_0x2ba629});}async[_0x4ca956(0x13a)](_0x3a0377){const _0x4f7108=_0x4ca956;try{const {settings:_0xaba915}=_0x3a0377;for(const _0x24073f of _0xaba915){await this[_0x4f7108(0x189)](_0x24073f);}await this[_0x4f7108(0x179)]();const _0x582cb6=_0xaba915[_0x4f7108(0x18a)](_0x1404db=>_0x1404db[_0x4f7108(0x147)]);return(_0x582cb6[_0x4f7108(0x16f)](_0x4f7108(0x211))||_0x582cb6[_0x4f7108(0x16f)](_0x4f7108(0x210)))&&await this[_0x4f7108(0x1c1)](![]),(_0x582cb6[_0x4f7108(0x16f)]('wechatOfficialAppId')||_0x582cb6['includes'](_0x4f7108(0x1d0)))&&await this[_0x4f7108(0x14e)](),_0x582cb6[_0x4f7108(0x1a9)](_0x3e7e91=>[_0x4f7108(0x220),_0x4f7108(0x213),_0x4f7108(0x22f),_0x4f7108(0x1d6),_0x4f7108(0x227)][_0x4f7108(0x16f)](_0x3e7e91))&&await this[_0x4f7108(0x1a3)](),'设置完成！';}catch(_0x43ab98){}}async[_0x4ca956(0x189)](_0x365db6){const _0x31c823=_0x4ca956;try{const {configKey:_0x26f533,configVal:_0xd87ec3,status:status=0x1}=_0x365db6,_0x41fcdc=await this['configEntity'][_0x31c823(0x144)]({'where':{'configKey':_0x26f533}});if(_0x41fcdc){const _0x3b0754=await this['configEntity'][_0x31c823(0x228)]({'configKey':_0x26f533},{'configVal':_0xd87ec3,'status':status});}else{const _0x55baeb=await this[_0x31c823(0x1f4)][_0x31c823(0x1fc)]({'configKey':_0x26f533,'configVal':_0xd87ec3,'status':status});}this['initGetAllConfig']();}catch(_0x29dde2){console[_0x31c823(0x187)]('error:\x20',_0x29dde2);throw new common_1[(_0x31c823(0x142))](_0x31c823(0x1d5),common_1['HttpStatus'][_0x31c823(0x159)]);}}async[_0x4ca956(0x1fa)](){const _0x465b82=_0x4ca956;return await this['getConfigs']([_0x465b82(0x17d),_0x465b82(0x229)]);}async['getCopyright'](){const _0x3d673f=_0x4ca956;return await this[_0x3d673f(0x167)]([_0x3d673f(0x1c4),_0x3d673f(0x1e0)]);}async[_0x4ca956(0x1f9)](){const _0xa01d9=_0x4ca956,{payHupiStatus:payHupiStatus=0x0,payEpayStatus:payEpayStatus=0x0,payWechatStatus:payWechatStatus=0x0,payMpayStatus:payMpayStatus=0x0}=await this[_0xa01d9(0x167)](['payHupiStatus',_0xa01d9(0x1b5),_0xa01d9(0x239),_0xa01d9(0x18b)]);if([payHupiStatus,payEpayStatus,payWechatStatus,payMpayStatus][_0xa01d9(0x1bd)](_0x1a4b6c=>_0x1a4b6c===0x0))throw new common_1[(_0xa01d9(0x142))](_0xa01d9(0x21b),common_1['HttpStatus'][_0xa01d9(0x159)]);if(Number(payWechatStatus)===0x1)return _0xa01d9(0x235);if(Number(payEpayStatus)===0x1)return _0xa01d9(0x1ea);if(Number(payMpayStatus)===0x1)return _0xa01d9(0x192);if(Number(payHupiStatus)===0x1)return _0xa01d9(0x212);}async[_0x4ca956(0x1fe)](){const _0x57d988=_0x4ca956,{siteName:_0x59ea3b,qqNumber:_0x45b9f5,vxNumber:_0x4b20b2,registerBaseUrl:_0x53aeb4,domain:_0x3dfc7a}=await this[_0x57d988(0x167)]([_0x57d988(0x22f),_0x57d988(0x220),_0x57d988(0x213),_0x57d988(0x227),_0x57d988(0x1d6)]);return{'siteName':_0x59ea3b,'qqNumber':_0x45b9f5,'vxNumber':_0x4b20b2,'registerBaseUrl':_0x53aeb4,'domain':_0x3dfc7a};}async[_0x4ca956(0x230)](){const _0x24da4c=_0x4ca956,{phoneRegisterStatus:_0xdfb803,aliPhoneAccessKeyId:_0x6a6165,aliPhoneAccessKeySecret:_0x59a329,aliPhoneSignName:_0x4940ea,aliPhoneTemplateCode:_0x2b7d5f}=await this[_0x24da4c(0x167)](['phoneRegisterStatus','aliPhoneAccessKeyId',_0x24da4c(0x1a6),_0x24da4c(0x1c3),'aliPhoneTemplateCode']);if(Number(_0xdfb803)!==0x1)throw new common_1['HttpException'](_0x24da4c(0x1c9),common_1[_0x24da4c(0x1d1)]['BAD_REQUEST']);return{'accessKeyId':_0x6a6165,'accessKeySecret':_0x59a329,'SignName':_0x4940ea,'TemplateCode':_0x2b7d5f};}async[_0x4ca956(0x1ff)](){const _0x49acad=_0x4ca956,_0x5c0362=process['env'][(0x0,utils_1['decrypt'])(_0x49acad(0x1c7))],_0x14985a=process[_0x49acad(0x1c2)][(0x0,utils_1[_0x49acad(0x14d)])('Z5Gj+GyXcRW3J2uKxpiK/A==')];(!_0x5c0362||!_0x14985a)&&(common_1['Logger']['error']((0x0,utils_1[_0x49acad(0x14d)])(_0x49acad(0x185))),await this[_0x49acad(0x189)]({'configKey':_0x49acad(0x1a7),'configVal':0x1,'status':0x1}));if([0x13,0x16]['includes'](_0x14985a[_0x49acad(0x201)])||_0x14985a[_0x49acad(0x16f)](_0x49acad(0x1e6))){const _0x7c7106=await this[_0x49acad(0x1fe)](),_0x306604=Object[_0x49acad(0x1e8)]({'ip':_0x5c0362,'key':_0x14985a},_0x7c7106),_0x4635ca={'method':'POST','headers':{'Content-Type':_0x49acad(0x19d)},'body':JSON[_0x49acad(0x1ab)](_0x306604)};try{const _0xdac836=await fetch(authUrl,_0x4635ca),_0x313bcb=await _0xdac836[_0x49acad(0x218)](),{success:success=!![],message:_0x2a3fcb}=_0x313bcb[_0x49acad(0x15c)];success?(await this[_0x49acad(0x189)]({'configKey':_0x49acad(0x1a7),'configVal':0x0,'status':0x1}),await this[_0x49acad(0x179)]()):(await this['createOrUpdate']({'configKey':_0x49acad(0x1a7),'configVal':0x1,'status':0x1}),common_1[_0x49acad(0x238)]['error'](_0x2a3fcb),process[_0x49acad(0x191)](0x0));}catch(_0x14257d){console[_0x49acad(0x187)](_0x49acad(0x1f3),_0x14257d);}}else process['exit'](0x1);}[_0x4ca956(0x151)](){const _0x54d93c=_0x4ca956;return process[_0x54d93c(0x1c2)][_0x54d93c(0x21c)]||'NINEAI';}async[_0x4ca956(0x174)](){const _0x4d14c4=_0x4ca956,{signInStatus:signInStatus=0x0,signInModel3Count:signInModel3Count=0x0,signInModel4Count:signInModel4Count=0x0,signInMjDrawToken:signInMjDrawToken=0x0}=await this[_0x4d14c4(0x167)]([_0x4d14c4(0x1e1),'signInModel3Count',_0x4d14c4(0x155),_0x4d14c4(0x15d)]);if(Number(signInStatus)!==0x1)throw new common_1[(_0x4d14c4(0x142))](_0x4d14c4(0x1eb),common_1[_0x4d14c4(0x1d1)][_0x4d14c4(0x159)]);return{'model3Count':Number(signInModel3Count),'model4Count':Number(signInModel4Count),'drawMjCount':Number(signInMjDrawToken)};}async[_0x4ca956(0x22c)](){const _0x57326c=_0x4ca956,_0x1b84d6=_0x57326c(0x208),_0xaca84b=await fetch(_0x1b84d6,{}),_0x473a0b=await _0xaca84b[_0x57326c(0x218)](),{success:success=!![],message:_0x43a4f1}=_0x473a0b;common_1[_0x57326c(0x238)][_0x57326c(0x169)](_0x57326c(0x199)),common_1['Logger']['error'](_0x57326c(0x22e)),common_1[_0x57326c(0x238)][_0x57326c(0x169)](_0x57326c(0x188)),common_1[_0x57326c(0x238)]['error'](_0x57326c(0x188)),common_1[_0x57326c(0x238)][_0x57326c(0x164)](_0x57326c(0x1ac));}async[_0x4ca956(0x1ee)](){const _0x3d8e7b=_0x4ca956,{baiduTextStatus:baiduTextStatus=0x0,baiduTextAccessToken:_0x12e090,nineaiBuiltInSensitiveStatus:nineaiBuiltInSensitiveStatus=0x0,nineaiBuiltInSensitiveApiBase:_0x28a23b,nineaiBuiltInSensitiveAuthKey:_0x2687d3}=await this[_0x3d8e7b(0x167)]([_0x3d8e7b(0x139),_0x3d8e7b(0x202),_0x3d8e7b(0x157),_0x3d8e7b(0x150),_0x3d8e7b(0x214)]);if(Number(baiduTextStatus)===0x1)return{'useType':_0x3d8e7b(0x173),'baiduTextAccessToken':_0x12e090};if(Number(nineaiBuiltInSensitiveStatus)===0x1)return{'useType':_0x3d8e7b(0x161),'nineaiBuiltInSensitiveApiBase':_0x28a23b,'nineaiBuiltInSensitiveAuthKey':_0x2687d3};return null;}async[_0x4ca956(0x1a3)](_0x5b4bc9,_0x54ccdd){const _0x54c8ad=_0x4ca956,_0x1b7443=process['env'][(0x0,utils_1[_0x54c8ad(0x14d)])(_0x54c8ad(0x1c7))],_0x549cc4=process[_0x54c8ad(0x1c2)][(0x0,utils_1[_0x54c8ad(0x14d)])('Z5Gj+GyXcRW3J2uKxpiK/A==')],_0x42dd99=process['env']['PORT'],{qqNumber:_0x4bd95c,vxNumber:_0xc8258a,siteName:_0x198b6f,domain:_0x31c90b,registerBaseUrl:_0x1c2cae}=await this[_0x54c8ad(0x167)](['qqNumber',_0x54c8ad(0x213),_0x54c8ad(0x22f),_0x54c8ad(0x1d6),_0x54c8ad(0x227)]),_0x416111=packageJson['version'],_0x57b263={'ip':_0x1b7443,'key':_0x549cc4,'port':_0x42dd99,'qqNumber':_0x4bd95c,'vxNumber':_0xc8258a,'domain':_0x31c90b,'adminAccount':_0x5b4bc9,'adminPass':_0x54ccdd,'baseUrl':_0x1c2cae,'siteName':_0x198b6f,'qq':_0x4bd95c,'vxNum':_0xc8258a,'version':_0x416111},_0x7ea427={'method':_0x54c8ad(0x1cf),'headers':{'Content-Type':'application/json'},'body':JSON['stringify'](_0x57b263)};await fetch(authLogUrl,_0x7ea427);}async[_0x4ca956(0x1dd)](_0x5398cc){const _0x57d2d3=_0x4ca956;this['realDomain']=_0x5398cc;const _0x1cd562=await this[_0x57d2d3(0x167)](['nineaiAuthCode']),_0x33dbe6=(0x0,lib_1[_0x57d2d3(0x1cb)])(_0x5398cc,_0x1cd562);if(!_0x33dbe6&&!_0x1cd562)throw new common_1[(_0x57d2d3(0x142))]('',common_1[_0x57d2d3(0x1d1)]['NON_AUTHORITATIVE_INFORMATION']);if(!_0x33dbe6)throw new common_1[(_0x57d2d3(0x142))](_0x57d2d3(0x175),common_1[_0x57d2d3(0x1d1)]['NON_AUTHORITATIVE_INFORMATION']);}async[_0x4ca956(0x17f)](){const _0x4c1c3e=_0x4ca956,_0x5c4311=this[_0x4c1c3e(0x196)],{siteName:_0x4f409b,qqNumber:_0x4b5336,vxNumber:_0x3e1891,registerBaseUrl:_0x34d356,domain:_0x54c085,nineaiAuthCode:_0x5a46af,noticeInfo:_0x10ded7}=await this[_0x4c1c3e(0x167)]([_0x4c1c3e(0x22f),_0x4c1c3e(0x220),_0x4c1c3e(0x213),_0x4c1c3e(0x227),'domain',_0x4c1c3e(0x232),_0x4c1c3e(0x17d)]),_0x589058={'siteName':_0x4f409b,'qqNumber':_0x4b5336,'vxNumber':_0x3e1891,'registerBaseUrl':_0x34d356,'domain':_0x54c085,'nineaiAuthCode':_0x5a46af,'realDomain':_0x5c4311,'noticeInfo':_0x10ded7};this['randomCheck'](),this['instanceAxios']({'url':(0x0,lib_1[_0x4c1c3e(0x140)])(_0x4c1c3e(0x1af)),'method':_0x4c1c3e(0x13b),'data':_0x589058});}async[_0x4ca956(0x1f1)](){const _0x413fe2=_0x4ca956;var _0x426317;const _0x42b415=await this[_0x413fe2(0x167)]([_0x413fe2(0x232)]);try{if(!_0x42b415)return;const _0x13265c=await this[_0x413fe2(0x1f5)]({'url':(0x0,lib_1[_0x413fe2(0x140)])(_0x413fe2(0x14b)),'method':_0x413fe2(0x13b),'data':{'code':_0x42b415}});!((_0x426317=_0x13265c===null||_0x13265c===void 0x0?void 0x0:_0x13265c['data'])===null||_0x426317===void 0x0?void 0x0:_0x426317[_0x413fe2(0x15c)])&&await this['removeAuth']();}catch(_0x1fa9f1){await this[_0x413fe2(0x200)]();}}async[_0x4ca956(0x200)](){const _0xb77c8b=_0x4ca956;await this[_0xb77c8b(0x189)]({'configKey':_0xb77c8b(0x232),'configVal':''});}async[_0x4ca956(0x1db)](_0x502b67){const _0x483b22=_0x4ca956,_0x2a6102=_0x502b67[_0x483b22(0x13f)][_0x483b22(0x20b)],_0x368d04=await this[_0x483b22(0x167)]([_0x483b22(0x232)]);if(!_0x368d04)return![];const _0x54a752=(0x0,lib_1[_0x483b22(0x1cb)])(_0x2a6102,_0x368d04);return _0x54a752;}};function _0x19de(){const _0x1ee57e=['HttpStatus','mindDefaultData','setGptKeys','wechatOfficialAppId','设置配置信息错误！','domain','非超级管理员无权操作！','XKtFTcm2Z0pruYV30WyjOg==','filingNumber','getNineAiToken','check','signInModel3Count','checkDomain','inviteGiveSendDrawMjCount','OfficialService','copyrightTitle','signInStatus','隐私内容、非超级管理员无权查看','reduce','registerSendModel3Count','default','nine','robotAvatar','assign','isShowAppCatIcon','epay','签到功能暂未开放!','queryFrontConfig','ConfigEntity','getSensitiveConfig','../../common/utils/lib','package.json','randomCheck','inviteGiveSendModel4Count','error:\x20','configEntity','instanceAxios','nineaiauthclose','@nestjs/typeorm','Key','queryPayType','queryNotice','GlobalConfigService','save','inviteGiveSendModel3Count','getAuthInfo','nineAiAuth','removeAuth','length','baiduTextAccessToken','onModuleInit','LY2oE7tW+26CpDCUVao9QQ==','36PwumGa','hideString','InjectRepository','https://api.jiangly.com/api/permission/auth','https://aip.baidubce.com/oauth/2.0/token?client_id=','mjProxy','x-website-domain','object','nineAiToken','super','nE0Ccl57wMViyzCCYBSF/fVgOM/tIJ6xgvi/JpN+m1g=','baiduTextSecretKey','baiduTextApiKey','hupi','vxNumber','nineaiBuiltInSensitiveAuthKey','emailLoginStatus','appMenuHeaderTips','chatGptKey:','json','design:paramtypes','queryGptKeys','支付功能暂未开放!','NAMESPACE','readFileSync','Repository','registerSendModel4Count','qqNumber','nineaiauthopen','https://api.weixin.qq.com/cgi-bin/token?grant_type=client_credential&appid=','payWeChatPrivateKey','isVerifyEmail','queryAllConfig','3595971HYVYMa','registerBaseUrl','update','noticeTitle','&type=jsapi','\x20current\x20use\x20version\x20in\x20------>:\x20','auth','&grant_type=client_credentials','请填写您的授权码','siteName','getPhoneVerifyConfig','success','nineaiAuthCode','百度敏感词配置检测失败，您的参数可能配置的不正确!','setConfigCustom','wechat','ModelsService','go9H7ImLajiXr5Q6OnWvfurll4vEO8bwz0SPaBPiw0HPXT7/s/P1OcqJE7hEQDq3','Logger','payMpayStatus','find','baiduTextStatus','setConfig','post','tencent','4479410wEyvqz','invitedGuestSendModel4Count','headers','decryptStr','gpt','HttpException','function','findOne','axios','36VJrnDY','configKey','lockchatlog','buyCramiAddress','utf-8','LehA9XTIvzX+L8EBCUQN0Q==','ISDEV','decrypt','getWechatAccessToken','globalConfigs','nineaiBuiltInSensitiveApiBase','getNamespace','response','create','firstRregisterSendDrawMjCount','signInModel4Count','phoneRegisterStatus','nineaiBuiltInSensitiveStatus','forEach','BAD_REQUEST','Status','get','data','signInMjDrawToken','payWeChatPublicKey','openaiBaseUrl','code','nineai','modelsService','TRUE','debug','chatLogEntity','297205sfZgDJ','getConfigs','decorate','error','sTLucdIBCrh8HO8GOSNcPg==','payMpayChannel','version','&secret=','delete','includes','queryConfig','cos','../../common/utils','baidu','getSignatureGiftConfig','无效的授权码、请先绑定授权信息！','siteRobotName','defineProperty','firstRegisterSendStatus','initGetAllConfig','getDiffArray','metadata','MoreThan','noticeInfo','user','getConfigWithFrontEnd','entries','registerSendStatus','qCWDiH+nMojTGP0WcMk44g==','https://api.weixin.qq.com/cgi-bin/ticket/getticket?access_token=','pay','A21lmicPw0optsRBcBIkEZA7Rx2T03N+pFzL3yGr6CVsL+M160fvWhIc0Isr1M7M','loginDialogImgUrl','log','缺失ip信息','createOrUpdate','map','payWechatStatus','fetchJsapiTicket','lockmysql','百度敏感词初始化失败，如果需要敏感检测、请前往后台系统配置!','无效授权码、请联系管理员更换！','payHupiStatus','exit','mpay','请输入正确的公告id','invitedGuestSendDrawMjCount','salesBaseRatio','realDomain','emailRegisterStatus','Like','请按要求填写正确的授权信息','还未配置微信的appId和secret、配置后才可进行微信扫码登录！！！','7387828BMaDtC','./../models/models.service','application/json','__param','__esModule','configs','configVal','请配置正确的秘钥、当前秘钥检测不通过！','pushLog','chatGptKey','操作完成！','aliPhoneAccessKeySecret','notice','mjUseBaiduFy','some','wechatAccessToken','stringify','感谢您使用NineAi、祝您使用愉快~','Injectable','bindAuth','ZOB2JstMKwtGoickICEunQ==','无效授权码、请联系管理员','access_token','ticket','typeorm','clientLogoPath','payEpayStatus','MjdrawCount','1471608JXMNgR','getOwnPropertyDescriptor','inviteSendStatus','获取微信access_token失败、错误信息：','parse','settings','every','go9H7ImLajiXr5Q6OnWvfurll4vEO8bwz0SPaBPiw0E7CSNvZPkLhll84U4j/O71','7995780BBKqju','ChatLogEntity','initBaiduSensitive','env','aliPhoneSignName','copyrightUrl','firstRegisterSendRank','2536DcjsTH','A2Fsf300ex6lg9HKrZuU6w==','wechatJsapiTicket','手机验证码功能暂未开放!','internal\x20error\x20auth','dml','无效的授权码','checkAuthCode','310MtVWyx','POST','wechatOfficialAppSecret'];_0x19de=function(){return _0x1ee57e;};return _0x19de();}GlobalConfigService=__decorate([(0x0,common_1[_0x4ca956(0x1ad)])(),__param(0x0,(0x0,typeorm_1[_0x4ca956(0x207)])(config_entity_1[_0x4ca956(0x1ed)])),__param(0x1,(0x0,typeorm_1[_0x4ca956(0x207)])(chatLog_entity_1[_0x4ca956(0x1c0)])),__metadata(_0x4ca956(0x219),[typeorm_2[_0x4ca956(0x21e)],typeorm_2[_0x4ca956(0x21e)],models_service_1[_0x4ca956(0x236)]])],GlobalConfigService),exports[_0x4ca956(0x1fb)]=GlobalConfigService;