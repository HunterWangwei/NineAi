
/**
 * 由 Fantastic-admin 提供技术支持
 * Powered by Fantastic-admin
 * Gitee  https://gitee.com/hooray/fantastic-admin
 * Github https://github.com/hooray/fantastic-admin
 */
  
import{_ as Q}from"./index-9f0acf5e.js";import{A as X}from"./mj-5a58c02f.js";import{A as M}from"./chat-9c04a993.js";import{u as G}from"./utcformatTime-e76e5157.js";import{d as K,W as Z,e as ee}from"./index-867b894d.js";import{d as te,r as b,Q as le,x as ae,o as c,c as g,e as t,f as l,R as V,S as N,b as p,k as u,a as v,w as oe,I as w,t as m,E as P,h as o,X as ne,q as L}from"./index-534a2c19.js";const re={style:{float:"right"}},se=["src"],ie={key:1},ce={key:1},ue={class:"answer"},de={class:"answer_container"},_e=te({__name:"draw",setup(pe){const I=b(),D=b(0),y=b(!1),i=le({sysRec:null,status:null,page:1,size:10}),R=b([]);async function d(){try{y.value=!0;const s=await X.queryAdminDrawList(i);y.value=!1;const{rows:a,count:h}=s.data;D.value=h,R.value=a}catch{y.value=!1}}function j(s){s==null||s.resetFields(),d()}async function B(s){const a=await M.recMjDrawImg({id:s});P.success(a.data),d()}async function W(s){const a=await M.delChatLog({id:s});P.success(a.data),d()}return ae(()=>{d()}),(s,a)=>{const h=o("el-option"),z=o("el-select"),k=o("el-form-item"),f=o("el-button"),Y=o("el-form"),C=Q,$=o("el-alert"),r=o("el-table-column"),q=o("el-image"),A=o("el-tag"),O=o("el-popover"),S=o("el-popconfirm"),F=o("el-table"),E=o("el-pagination"),H=o("el-row"),J=ne("loading");return c(),g("div",null,[t(C,null,{default:l(()=>[t(Y,{ref_key:"formRef",ref:I,inline:!0,model:i},{default:l(()=>[t(k,{label:"推荐状态",prop:"rec"},{default:l(()=>[t(z,{modelValue:i.sysRec,"onUpdate:modelValue":a[0]||(a[0]=e=>i.sysRec=e),placeholder:"请选择推荐状态",clearable:""},{default:l(()=>[(c(!0),g(V,null,N(p(K),e=>(c(),w(h,{key:e.value,label:e.label,value:e.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),t(k,{label:"绘制状态",prop:"status"},{default:l(()=>[t(z,{modelValue:i.status,"onUpdate:modelValue":a[1]||(a[1]=e=>i.status=e),placeholder:"请选择绘制状态",clearable:""},{default:l(()=>[(c(!0),g(V,null,N(p(Z),e=>(c(),w(h,{key:e.value,label:e.label,value:e.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),t(k,null,{default:l(()=>[t(f,{type:"primary",onClick:d},{default:l(()=>[u(" 查询 ")]),_:1}),t(f,{onClick:a[2]||(a[2]=e=>j(p(I)))},{default:l(()=>[u(" 重置 ")]),_:1})]),_:1}),v("span",re,[t(f,{type:"success",onClick:d},{default:l(()=>[u(" 刷新列表 ")]),_:1})])]),_:1},8,["model"])]),_:1}),t(C,null,{default:l(()=>[t($,{"show-icon":"",title:"MJ绘图历史说明",description:"点击推荐的图片将会出现在画廊当中！",type:"success"})]),_:1}),t(C,{style:{width:"100%"}},{default:l(()=>[oe((c(),w(F,{border:"",data:p(R),style:{width:"100%"},size:"large"},{default:l(()=>[t(r,{prop:"userInfo.avatar",label:"用户头像",width:"90"},{default:l(e=>{var n,_;return[v("img",{src:(_=(n=e.row)==null?void 0:n.userInfo)==null?void 0:_.avatar,style:{height:"50px"}},null,8,se)]}),_:1}),t(r,{prop:"id",align:"center",label:"ID",width:"70"}),t(r,{prop:"originalImgUrl",align:"center",label:"绘图结果"},{default:l(e=>{var n,_,x,T,U;return[(n=e.row)!=null&&n.thumb||(_=e.row)!=null&&_.originalImgUrl?(c(),w(q,{key:0,style:{height:"120px"},"preview-teleported":"",fit:"contain","preview-src-list":[(x=e.row)==null?void 0:x.originalImgUrl],src:((T=e.row)==null?void 0:T.thumb)||((U=e.row)==null?void 0:U.originalImgUrl),lazy:"","hide-on-click-modal":""},null,8,["preview-src-list","src"])):(c(),g("span",ie,"---"))]}),_:1}),t(r,{prop:"userInfo.username",align:"center",label:"用户名",width:"120"},{default:l(e=>{var n,_;return[u(m(((_=(n=e.row)==null?void 0:n.userInfo)==null?void 0:_.username)||"游客"),1)]}),_:1}),t(r,{align:"center",label:"系统推荐",width:"90"},{default:l(e=>[t(A,{type:e.row.sysRec===1?"success":""},{default:l(()=>[u(m(e.row.sysRec===1?"已推荐":"未推荐"),1)]),_:2},1032,["type"])]),_:1}),t(r,{prop:"userInfo.email",label:"邮箱",width:"180",align:"center"}),t(r,{prop:"status",align:"center",label:"绘图状态",width:"105"},{default:l(e=>[e.row.status?(c(),w(A,{key:0,type:e.row.status===100?"success":""},{default:l(()=>[u(m(p(ee)[e.row.status]),1)]),_:2},1032,["type"])):(c(),g("span",ce,"---"))]),_:1}),t(r,{prop:"fullPrompt",label:"绘图指令",align:"center",width:"200"},{default:l(e=>[t(O,{placement:"top",width:400,trigger:"click"},{reference:l(()=>[v("div",ue,m(e.row.fullPrompt),1)]),default:l(()=>[v("div",de,m(e.row.fullPrompt),1)]),_:2},1024)]),_:1}),t(r,{prop:"progress",align:"center",label:"绘图进度",width:"90"}),t(r,{prop:"fileInfo.scale",align:"center",label:"绘图比例",width:"120"},{default:l(e=>{var n;return[u(m(((n=e.row)==null?void 0:n.scale)||"---"),1)]}),_:1}),t(r,{prop:"createdAt",label:"绘制时间",align:"center",width:"200"},{default:l(e=>[u(m(p(G)(e.row.createdAt,"YYYY-MM-DD hh:mm:ss")),1)]),_:1}),t(r,{fixed:"right",label:"操作",width:"200",align:"center"},{default:l(e=>[t(S,{title:`确认${Number(e.row.sysRec)===1?"取消推荐":"推荐"}图片吗！推荐的图片会在画廊对外展示！`,width:"260","icon-color":"red",onConfirm:n=>B(e.row.id)},{reference:l(()=>[t(f,{link:"",type:Number(e.row.sysRec)===1?"success":"",size:"small"},{default:l(()=>[u(m(Number(e.row.sysRec)===1?"取消推荐":"推荐图片"),1)]),_:2},1032,["type"])]),_:2},1032,["title","onConfirm"]),t(S,{title:"`确认删除此条记录么！",width:"260","icon-color":"red",onConfirm:n=>W(e.row.id)},{reference:l(()=>[t(f,{type:"warning",size:"small"},{default:l(()=>[u(" 删除记录 ")]),_:1})]),_:2},1032,["onConfirm"])]),_:1})]),_:1},8,["data"])),[[J,p(y)]]),t(H,{class:"flex justify-end mt-5"},{default:l(()=>[t(E,{"current-page":i.page,"onUpdate:currentPage":a[3]||(a[3]=e=>i.page=e),"page-size":i.size,"onUpdate:pageSize":a[4]||(a[4]=e=>i.size=e),class:"mr-5","page-sizes":[10,20,30,50],layout:"total, sizes, prev, pager, next, jumper",total:p(D),onSizeChange:d,onCurrentChange:d},null,8,["current-page","page-size","total"])]),_:1})]),_:1})])}}});typeof L=="function"&&L(_e);export{_e as default};
