import{d as I,a8 as Ee,a9 as De,aa as oe,ab as Te,a as r,b as v,e as s,z as C,t as k,B as S,m as x,f as d,u as t,_ as P,J as ee,F as N,p as j,W as de,q as w,ac as ve,i as Q,l as q,c as V,r as g,P as Ne,n as $,K as ae,ad as Re,ae as $e,w as L,af as se,ag as je,a5 as ze,ah as ce,ai as Z,o as Y,aj as Me,x as F,k as pe,j as H,ak as Pe,D as Le,A as ue,G as ke,H as Ve,N as Se,a4 as Fe,S as we,I as Oe,al as re,am as he,O as Je,U as Ge,an as Qe}from"./index-7b7a4325.js";import{i as Ie}from"./index-408e81f4.js";import{N as xe}from"./InputNumber-c001644f.js";import{N as be}from"./Switch-6569f460.js";import{N as He}from"./LayoutSider-ad3db2e7.js";import{N as Ke}from"./Drawer-e5a55838.js";import{c as Ue}from"./index-c94da121.js";const ne=I({name:"RadioButton",props:Ee,setup:De,render(){const{mergedClsPrefix:e}=this;return oe("label",{class:[`${e}-radio-button`,this.mergedDisabled&&`${e}-radio-button--disabled`,this.renderSafeChecked&&`${e}-radio-button--checked`,this.focus&&[`${e}-radio-button--focus`]]},oe("input",{ref:"inputRef",type:"radio",class:`${e}-radio-input`,value:this.value,name:this.mergedName,checked:this.renderSafeChecked,disabled:this.mergedDisabled,onChange:this.handleRadioInputChange,onFocus:this.handleRadioInputFocus,onBlur:this.handleRadioInputBlur}),oe("div",{class:`${e}-radio-button__state-border`}),Te(this.$slots.default,p=>!p&&!this.label?null:oe("div",{ref:"labelRef",class:`${e}-radio__label`},p||this.label)))}}),We={class:"w-full mb-[15px]"},qe={class:"flex items-center font-bold justify-between text-[14px]"},Ze={class:"flex items-center"},Ye={class:"flex-1 text-right"},Xe={class:"mt-[5px] mb-3"},D=I({__name:"subTitle",props:{title:null,tips:null,tipsWitdh:null},setup(e){return(p,a)=>(r(),v("div",We,[s("div",qe,[s("div",Ze,[C(k(e.title)+" ",1),e.tips?(r(),S(t(de),{key:0,placement:"right-end",trigger:"hover"},{trigger:x(()=>[d(t(P),{icon:"ri:error-warning-line",class:"text-base cursor-pointer ml-2 mb-[2px] hover:text-primary"})]),default:x(()=>[s("div",{style:ee({width:`${e.tipsWitdh}px`})},[(r(!0),v(N,null,j(e.tips,(l,c)=>(r(),v("p",{key:c},k(l),1))),128))],4)]),_:1})):w("",!0)]),s("div",Ye,[ve(p.$slots,"header")])]),s("div",Xe,[ve(p.$slots,"default")])]))}}),el=["accept"],ll={key:0,class:"absolute left-0 top-0 w-full h-full rounded"},tl=["src"],al={class:"mask absolute left-0 top-0 w-full h-full flex justify-center items-center rounded"},sl={class:"absolute inset-0 flex items-center justify-center bg-gray-800 bg-opacity-50 rounded"},nl=I({__name:"index",props:{modelValue:null,size:null},emits:["update:modelValue","selectSuccess","deleteBase"],setup(e,{emit:p}){const a=e,l=Q(),c=q();V(()=>l.getToken),g("/api/upload/local");const i=g(null),n=V(()=>["image/png","image/jpg","image/jpeg","image/webp"].join(","));function o(f){return new Promise(A=>{var M;const{size:B,type:T}=f;if(f||c.error("未获取到文件信息！"),!["image/png","image/jpg","image/jpeg"].includes(T)&&!((M=a.uploadLimit)!=null&&M.includes("*"))){c.error("只能上传指定格式的文件！");return}if(B>1024*1024*5)return c.error("图片大小不能超过5M"),A(!1);A(!0)})}async function u(){try{const f=i.value.files[0];if(!await o(f))return;const B=new FileReader;B.onload=T=>{const z=T.target.result.toString();p("update:modelValue",z),p("selectSuccess",z)},B.readAsDataURL(f)}catch{c.error("上传资源失败！")}}function h(){p("update:modelValue",""),p("deleteBase")}function m(f){f.stopPropagation(),i.value.click()}return(f,A)=>(r(),v("span",{class:$([[e.modelValue?"border-none":"border-dashed"],"upload relative inline-block border dark:border-[#31353b] rounded overflow-hidden hover:border-primary dark:hover:border-primary hover:text-primary"]),style:ee({width:`${e.size||100}px`,height:`${e.size||100}px`})},[s("span",null,[s("input",{id:"fileInputRef",ref_key:"fileInputRef",ref:i,accept:t(n),type:"file",style:{display:"none"},onClick:A[0]||(A[0]=Ne(()=>{},["stop"])),onChange:u},null,40,el)]),e.modelValue?(r(),v("div",ll,[s("img",{src:e.modelValue,alt:"",class:"w-full h-full object-cover rounded"},null,8,tl)])):w("",!0),s("div",al,[s("div",sl,[d(t(P),{icon:"ep:delete",class:"uploadIcon text-[16px] text-white cursor-pointer",onClick:h})])]),e.modelValue?w("",!0):(r(),v("div",{key:1,class:"absolute left-0 top-0 w-full h-full bg-[#fafafc] dark:bg-[#272a30] flex justify-center items-center cursor-pointer",onClick:m},[ve(f.$slots,"default",{},()=>[d(t(P),{icon:"prime:upload",class:"uploadIcon text-[18px] text-gray-300"})],!0)]))],6))}});const te=ae(nl,[["__scopeId","data-v-2a83ab2b"]]),ol={class:"w-full flex flex-wrap"},Ce=I({__name:"uploadGroup",props:{modelValue:null,max:null,min:null},emits:["update:modelValue"],setup(e,{emit:p}){const l=g(e.modelValue),c=g("");function i(o){l.value.splice(o,1)}function n(o){l.value.push(o),p("update:modelValue",l.value),c.value=""}return(o,u)=>(r(),v("div",ol,[(r(!0),v(N,null,j(l.value,(h,m)=>(r(),S(te,{key:m,modelValue:l.value[m],"onUpdate:modelValue":f=>l.value[m]=f,class:"mr-[5px] mb-[5px]",onDeleteBase:f=>i(m)},null,8,["modelValue","onUpdate:modelValue","onDeleteBase"]))),128)),l.value.length<e.max?(r(),S(te,{key:0,modelValue:c.value,"onUpdate:modelValue":u[0]||(u[0]=h=>c.value=h),onDeleteBase:i,onSelectSuccess:n},null,8,["modelValue"])):w("",!0)]))}}),Be=e=>(Re("data-v-bbf920f7"),e=e(),$e(),e),ul={class:"w-full space-y-1"},il=["onClick"],rl={class:"whitespace-nowrap"},dl={class:"whitespace-nowrap h-[22px]"},cl=Be(()=>s("span",{class:"select-none"},"自定义",-1)),pl={class:"flex items-center h-[22px]"},ml=Be(()=>s("span",{class:"w-[40px] flex justify-center"},":",-1)),fl=I({__name:"drawScale",props:{modelValue:null},emits:["update:modelValue"],setup(e,{emit:p}){const a=e,l=g([[{label:"1:1",val:[1,1],text:"头像"},{label:"3:2",val:[3,2],text:"文章配图"},{label:"3:4",val:[3,4],text:"社交媒体"},{label:"4:3",val:[4,3],text:"公众号配图"},{label:"9:16",val:[9,16],text:"海报图"}],[{label:"16:9",val:[16,9],text:"电脑壁纸"},{label:"16:9",val:[1,2],custom:!0,text:"海报自定义图"}]]);function c(u,h){return u[0]===h[0]&&u[1]===h[1]}function i(u){const h=["text-primary border-primary  dark:border-[#b3e2fe]"];return["p-1 flex flex-col text-[12px] items-center justify-center rounded border transition-all select-none cursor-pointer  dark:border-[#9a9ca0] hover:border-primary hover:text-primary",c(u,a.modelValue)&&[...h]].join(" ")}function n(u){p("update:modelValue",u)}function o(u){return Ie(u)?u.toString():"1"}return(u,h)=>(r(),v("div",ul,[(r(!0),v(N,null,j(l.value,(m,f)=>(r(),v("div",{key:f,class:"flex space-x-1 items-stretch"},[(r(!0),v(N,null,j(m,A=>(r(),v("span",{key:A.val,class:"flex-1",onClick:B=>n(A.val)},[A.custom?(r(),v("span",{key:1,class:$(i(A.val))},[cl,s("div",pl,[d(t(xe),{value:A.val[0],"onUpdate:value":B=>A.val[0]=B,format:o,size:"small",class:"!h-[22px] text-center","show-button":!1},null,8,["value","onUpdate:value"]),ml,d(t(xe),{value:A.val[1],"onUpdate:value":B=>A.val[1]=B,format:o,size:"small",class:"!h-[22px] text-center","show-button":!1},null,8,["value","onUpdate:value"])])],2)):(r(),v("span",{key:0,class:$(i(A.val))},[s("span",rl,k(A.label),1),s("span",dl,k(A.text),1)],2))],8,il))),128))]))),128))]))}});const vl=ae(fl,[["__scopeId","data-v-bbf920f7"]]),hl="/assets/niji-6eaa06b3.png",xl="/assets/mj-bd16de43.png",bl={class:"w-full flex space-x-2"},gl=["onClick"],yl={key:0,class:"absolute bottom-[8px] right-[8px] z-10"},wl=s("div",{class:"w-0 h-0 border-solid border-b-8 border-r-8 border-transparent"},null,-1),Al=s("div",{class:"absolute top-0 left-0 w-full h-full flex items-center justify-center"},[s("span",{class:"text-lg font-bold text-primary"},"✔")],-1),_l=[wl,Al],kl=["src"],Vl={class:"absolute inset-0 flex items-center justify-center select-none bg-gray-800 bg-opacity-70 flex-col hover:bg-opacity-10 transition-all"},Sl={class:"font-bold"},Il=I({__name:"drawModelType",props:{modelValue:null},emits:["update:modelValue"],setup(e,{emit:p}){const a=e,l=g([{label:"Midjourney",tips:"真实风格",value:"mj",bg:xl},{label:"Niji",tips:"动漫风格",value:"niji",bg:hl}]);function c(n){return["relative rounded-md overflow-hidden bordercursor-pointer",n===a.modelValue?"text-white border-primary ":"text-white font-semibold border-transparent"]}function i(n){p("update:modelValue",n)}return(n,o)=>(r(),v("div",bl,[(r(!0),v(N,null,j(l.value,u=>(r(),v("div",{key:u.value,class:$(["relative rounded-md overflow-hidden border cursor-pointer",c(u.value)]),onClick:h=>i(u.value)},[u.value===e.modelValue?(r(),v("div",yl,_l)):w("",!0),s("img",{src:u.bg,alt:"Your Image",class:"w-full h-auto"},null,8,kl),s("div",Vl,[s("span",Sl,k(u.label),1),s("span",null,k(u.tips),1)])],10,gl))),128))]))}}),Ul=I({__name:"drawVersion",props:{modelValue:null,modelType:null},emits:["update:modelValue"],setup(e,{emit:p}){const a=e,l=g(""),c=V(()=>a.modelType==="mj"?[{label:"V6",value:"6.0"},{label:"V5.2",value:"5.2"},{label:"V5.1",value:"5.1"},{label:"V5",value:"5"},{label:"V4",value:"4"}]:a.modelType==="niji"?[{label:"V6",value:"6"},{label:"V5",value:"5"}]:[]);function i(n){l.value=n,p("update:modelValue",l.value)}return L(()=>a.modelType,()=>{c.value.length?l.value=c.value[0].value:l.value="",p("update:modelValue",l.value)},{immediate:!0}),(n,o)=>(r(),S(t(se),{value:l.value,"onUpdate:value":o[0]||(o[0]=u=>l.value=u),size:"small","on-update:value":i,name:"radiogroup"},{default:x(()=>[(r(!0),v(N,null,j(t(c),u=>(r(),S(t(ne),{key:u.value,class:"text-[12px] font-normal",value:u.value,label:u.label},null,8,["value","label"]))),128))]),_:1},8,["value"]))}}),Cl=I({__name:"drawQuality",props:{modelValue:null},emits:["update:modelValue"],setup(e,{emit:p}){const a=e,l=g(""),c=g([{label:"普通",value:".25"},{label:"一般",value:".5"},{label:"高清",value:"1"},{label:"超高清",value:"2"}]);function i(n){l.value=n,p("update:modelValue",l.value)}return L(()=>a.modelValue,()=>{l.value=a.modelValue},{immediate:!0}),(n,o)=>(r(),S(t(se),{value:l.value,"onUpdate:value":o[0]||(o[0]=u=>l.value=u),size:"small","on-update:value":i,name:"radiogroup"},{default:x(()=>[(r(!0),v(N,null,j(c.value,u=>(r(),S(t(ne),{key:u.value,class:"text-[12px] font-normal",value:u.value,label:u.label},null,8,["value","label"]))),128))]),_:1},8,["value"]))}}),Bl=I({__name:"drawInputNumber",props:{modelValue:null,max:null,min:null,defaultNull:{type:Boolean},clearable:{type:Boolean},notShowButton:{type:Boolean},step:null},emits:["update:modelValue"],setup(e,{emit:p}){const a=e,l=g(0);function c(n){return Ie(n)?n.toString():a.defaultNull?null:"1"}function i(n){l.value=n,p("update:modelValue",l.value)}return L(()=>a.modelValue,()=>{l.value=a.modelValue},{immediate:!0}),(n,o)=>(r(),S(t(xe),{value:l.value,"onUpdate:value":o[0]||(o[0]=u=>l.value=u),step:e.step,clearable:e.clearable,min:e.min,max:e.max,"show-button":!e.notShowButton,format:c,size:"small",class:"!h-[22px] text-[12px] font-normal text-center","on-update:value":i},null,8,["value","step","clearable","min","max","show-button"]))}});const ie=ae(Bl,[["__scopeId","data-v-044018a7"]]),El=I({__name:"drawSlider",props:{modelValue:null,max:null,min:null},emits:["update:modelValue"],setup(e,{emit:p}){const a=e,l=g(0);function c(i){l.value=i,p("update:modelValue",l.value)}return L(()=>a.modelValue,()=>{l.value=a.modelValue},{immediate:!0}),(i,n)=>(r(),S(t(je),{value:l.value,"onUpdate:value":n[0]||(n[0]=o=>l.value=o),type:"primary",step:1,tooltip:!1,min:e.min,max:e.max,"on-update:value":c,class:"!py-3"},null,8,["value","min","max"]))}});const fe=ae(El,[["__scopeId","data-v-f5c96076"]]),X=I({__name:"drawSelect",props:{modelValue:null,dataList:null,placeholder:null},emits:["update:modelValue"],setup(e,{emit:p}){const a=e,l=g(null);function c(i){l.value=i,p("update:modelValue",l.value)}return L(()=>a.modelValue,()=>{l.value=a.modelValue},{immediate:!0}),(i,n)=>(r(),S(t(ze),{value:l.value,"onUpdate:value":n[0]||(n[0]=o=>l.value=o),placeholder:e.placeholder,size:"small",options:e.dataList,"on-update:value":c},null,8,["value","placeholder","options"]))}}),Dl=I({__name:"drawStyle",props:{modelValue:null},emits:["update:modelValue"],setup(e,{emit:p}){const a=e,l=g(""),c=[{label:"默认",value:0},{label:"表现力",value:"expressive"},{label:"可爱",value:"cute"},{label:"景观",value:"scenic"}];function i(n){l.value=n,p("update:modelValue",l.value)}return L(()=>a.modelValue,()=>{l.value=a.modelValue},{immediate:!0}),(n,o)=>(r(),S(t(se),{value:l.value,"onUpdate:value":o[0]||(o[0]=u=>l.value=u),size:"small","on-update:value":i,name:"radiogroup"},{default:x(()=>[(r(),v(N,null,j(c,u=>d(t(ne),{key:u.value,class:"text-[12px] font-normal",value:u.value,label:u.label},null,8,["value","label"])),64))]),_:1},8,["value"]))}});function Tl(e){return ce({url:"/draw/recSysList",data:e})}function Nl(e){return ce({url:"/draw/mineList",data:e})}function Rl(e){return ce({url:"/draw/detail",data:e})}function $l(){return ce({url:"/draw/notice"})}function jl(e){return Z({url:"/draw/textToImage",data:e})}function zl(e){return Z({url:"/draw/drawAction",data:e})}function Ml(e){return Z({url:"/draw/delItem",data:e})}function Pl(e){return Z({url:"/draw/swapFace",data:e})}function Ll(e){return Z({url:"/draw/drawBlend",data:e})}function Fl(e){return Z({url:"/draw/seed",data:e})}function Ol(e){return Z({url:"/draw/describe",data:e})}const Jl={class:"w-full h-full p-[15px]"},Gl=["innerHTML"],Ql={class:"flex items-end justify-end"},Hl=s("span",{class:"whitespace-nowrap text-[12px] mr-1 font-normal"},"当前程度：",-1),Kl={class:"flex items-end justify-end"},Wl=s("span",{class:"whitespace-nowrap text-[12px] mr-1 font-normal"},"当前程度：",-1),ql={class:"flex items-end justify-end"},Zl={class:"flex items-end justify-end"},Yl={class:"mt-5 mb-2 font-bold text-[16px] flex items-center"},Xl=s("div",null," 参考图、数量最多五张 ",-1),et={class:"flex items-end justify-end"},lt=s("span",{class:"whitespace-nowrap text-[12px] mr-1 font-normal"},"当前程度：",-1),tt=s("h3",{class:"mt-5 mb-2 font-bold text-[16px]"}," 辅助提示 ",-1),at=I({__name:"textToImage",emits:["notice"],setup(e,{emit:p}){const a=g(""),l=g({taskType:1,scale:[9,16],model:"mj",version:"",quality:"1",chaos:0,stylize:0,style:"",view:null,cameraShot:null,light:null,seed:null,referencePic:[],iw:0,no:"",customInstruct:!1}),c=[{label:"宽景",value:"Wide view"},{label:"鸟瞰",value:"Bird view"},{label:"俯视",value:"Top view"},{label:"仰视",value:"Upview"},{label:"正面",value:"Front view"},{label:"头部特写",value:"Headshot"},{label:"超广角",value:"Ultrawideshot"},{label:"中景",value:"Medium Shot(MS)"},{label:"远景",value:"Long Shot(LS)"},{label:"景深",value:"depth offield(dof)"}],i=[{label:"脸部特写",value:"Face Shot (VCU)"},{label:"头部以上",value:"Big Close-Up(BCU)"},{label:"颈部以上",value:"Close-Up(CU)"},{label:"腰部以上",value:"Waist Shot(WS)"},{label:"膝盖以上",value:"KneeShot(KS)"},{label:"全身",value:"Full Length Shot(FLS)"},{label:"人在远方",value:"Extra Long Shot(ELS)"}],n=[{label:"冷光",value:"Cold light"},{label:"暖光",value:"Warm light"},{label:"强光",value:"hard lighting"},{label:"戏剧光",value:"Dramatic light"},{label:"反光",value:"reflection light"},{label:"雾气朦胧",value:"Misty foggy"},{label:"自然光",value:"Natural light"},{label:"太阳光",value:"Sun light"},{label:"暗黑的",value:"moody"}],o=V(()=>a.value?Me(a.value):"");async function u(){const h=await $l();a.value=h==null?void 0:h.data}return Y(()=>{p("notice",l.value),u()}),(h,m)=>(r(),v("div",Jl,[t(o)?(r(),v("div",{key:0,class:"w-full h-full bg-[#f2f3f9] dark:bg-[#31353B] rounded-md mb-2 p-2 text-[12px] text-black dark:text-white",innerHTML:t(o)},null,8,Gl)):w("",!0),d(D,{title:"模型选择",tips:["MJ: 偏真实通用模型","NIJI: 偏动漫风格、适用于二次元模型"]},{default:x(()=>[d(Il,{modelValue:l.value.model,"onUpdate:modelValue":m[0]||(m[0]=f=>l.value.model=f)},null,8,["modelValue"])]),_:1}),d(D,{title:"版本"},{header:x(()=>[d(Ul,{modelValue:l.value.version,"onUpdate:modelValue":m[1]||(m[1]=f=>l.value.version=f),"model-type":l.value.model},null,8,["modelValue","model-type"])]),default:x(()=>[d(D,{title:"图片比例",tips:["参数释义：生成图片尺寸比例"]},{default:x(()=>[d(vl,{modelValue:l.value.scale,"onUpdate:modelValue":m[2]||(m[2]=f=>l.value.scale=f)},null,8,["modelValue"])]),_:1})]),_:1}),d(D,{title:"品质"},{header:x(()=>[d(Cl,{modelValue:l.value.quality,"onUpdate:modelValue":m[3]||(m[3]=f=>l.value.quality=f)},null,8,["modelValue"])]),_:1}),l.value.model==="niji"&&l.value.version==="5"?(r(),S(D,{key:1,title:"风格"},{header:x(()=>[d(Dl,{modelValue:l.value.style,"onUpdate:modelValue":m[4]||(m[4]=f=>l.value.style=f)},null,8,["modelValue"])]),_:1})):w("",!0),d(D,{title:"混乱程度",tips:["取值范围：0-100、 --chaos 或 --c","混乱级别，可以理解为让AI天马行空的空间","值越小越可靠、默认0最为精准"]},{header:x(()=>[s("div",Ql,[Hl,d(ie,{modelValue:l.value.chaos,"onUpdate:modelValue":m[5]||(m[5]=f=>l.value.chaos=f),min:0,max:100,class:"w-[90px]"},null,8,["modelValue"])])]),default:x(()=>[d(fe,{modelValue:l.value.chaos,"onUpdate:modelValue":m[6]||(m[6]=f=>l.value.chaos=f),min:0,max:100},null,8,["modelValue"])]),_:1}),d(D,{title:"风格化程度","tips-witdh":240,tips:["风格化：--stylize 或 --s，范围 1-1000参数释义：数值越高，画面表现也会更具丰富性和艺术性"]},{header:x(()=>[s("div",Kl,[Wl,d(ie,{modelValue:l.value.stylize,"onUpdate:modelValue":m[7]||(m[7]=f=>l.value.stylize=f),min:0,max:1e3,class:"w-[90px]"},null,8,["modelValue"])])]),default:x(()=>[d(fe,{modelValue:l.value.stylize,"onUpdate:modelValue":m[8]||(m[8]=f=>l.value.stylize=f),min:0,max:1e3},null,8,["modelValue"])]),_:1}),d(D,{"tips-witdh":200,title:"Seed",tips:["种子数是为每个图像随机生成的，如果您使用相同的种子号和提示，您将获得相似的最终图像。范围为0–4294967295的整数。","您可以在右侧找到喜欢的图片获取到此值！"]},{header:x(()=>[s("div",ql,[d(ie,{modelValue:l.value.seed,"onUpdate:modelValue":m[9]||(m[9]=f=>l.value.seed=f),"not-show-button":"","default-null":"",clearable:"",min:0,max:4294967295,class:"w-[155px]"},null,8,["modelValue"])])]),_:1}),d(D,{"tips-witdh":320,title:"禁用指令",tips:["开启后选项中的配置参数将不会携带，您可以在描述中进行自定义参数指定。","反之不打开、自定义输入--指令将会被忽略覆盖。","开启后不会翻译与优化咒语！"]},{header:x(()=>[s("div",Zl,[d(t(be),{value:l.value.customInstruct,"onUpdate:value":m[10]||(m[10]=f=>l.value.customInstruct=f)},null,8,["value"])])]),_:1}),s("h3",Yl,[C(" 垫图生图 "),d(t(de),{placement:"right-end",trigger:"hover"},{trigger:x(()=>[d(t(P),{icon:"ri:error-warning-line",class:"text-base cursor-pointer ml-2 mb-[2px] hover:text-primary"})]),default:x(()=>[Xl]),_:1})]),d(Ce,{modelValue:l.value.referencePic,"onUpdate:modelValue":m[11]||(m[11]=f=>l.value.referencePic=f),max:5,class:"mb-3"},null,8,["modelValue"]),d(D,{title:"参考图权重",tips:["数值越大对绘制结果影响越大"]},{header:x(()=>[s("div",et,[lt,d(ie,{modelValue:l.value.iw,"onUpdate:modelValue":m[12]||(m[12]=f=>l.value.iw=f),min:0,max:2,step:.01,class:"w-[90px]"},null,8,["modelValue","step"])])]),default:x(()=>[d(fe,{modelValue:l.value.iw,"onUpdate:modelValue":m[13]||(m[13]=f=>l.value.iw=f),step:.01,min:0,max:2},null,8,["modelValue","step"])]),_:1}),tt,d(D,{title:"视角"},{default:x(()=>[d(X,{modelValue:l.value.view,"onUpdate:modelValue":m[14]||(m[14]=f=>l.value.view=f),"data-list":c,placeholder:"视角选择"},null,8,["modelValue"])]),_:1}),d(D,{title:"人物镜头"},{default:x(()=>[d(X,{modelValue:l.value.cameraShot,"onUpdate:modelValue":m[15]||(m[15]=f=>l.value.cameraShot=f),"data-list":i,placeholder:"镜头选择"},null,8,["modelValue"])]),_:1}),d(D,{title:"灯光"},{default:x(()=>[d(X,{modelValue:l.value.light,"onUpdate:modelValue":m[16]||(m[16]=f=>l.value.light=f),"data-list":n,placeholder:"灯光选择"},null,8,["modelValue"])]),_:1})]))}}),st={class:"w-full h-full p-[14px] relative"},nt={class:"flex justify-end"},ot={class:"flex justify-center w-full mt-8 pr-5"},ut=s("div",{class:"mt-5 space-y-1"},[s("h3",{class:"font-semibold"}," 使用说明 "),s("p",null,"- 混图需要2-6张图片、请注意张数"),s("p",null,"- 单张图片大小不可大于5M"),s("p",null,"- 图片顺序越前，权重越高"),s("p",null,"- 建议把你最想融合的图片放在最前面")],-1),it=I({__name:"blendImage",emits:["notice","submitNotice"],setup(e,{emit:p}){const a=Q();V(()=>a.isLogin);const l=q(),c=g(!1),i=g({taskType:2,base64Arr:[],dimensions:"PORTRAIT"}),n=g([{label:"广场 SQUARE (1:1)",value:"SQUARE"},{label:"肖像 PORTRAIT(2:3)",value:"PORTRAIT"},{label:"景观 LANDSCAPE(3:2)",value:"LANDSCAPE"}]);async function o(){try{if(c.value=!0,i.value.base64Arr.length<2&&i.value.base64Arr.length>6){l.error("混合图片需要2-6张图片");return}await Ll(i.value),c.value=!1,p("submitNotice"),a.getUserInfo()}catch{c.value=!1}}return Y(()=>{p("notice",i.value)}),(u,h)=>(r(),v("div",st,[d(D,{title:"视角",tips:["混合后的图片的尺寸"]},{header:x(()=>[s("div",nt,[d(X,{modelValue:i.value.dimensions,"onUpdate:modelValue":h[0]||(h[0]=m=>i.value.dimensions=m),"data-list":n.value,placeholder:"尺寸选择",class:"!w-[200px]"},null,8,["modelValue","data-list"])])]),_:1}),d(D,{title:"混合图片",tips:["混合图片最少需要两张图片","混合图片最多支持六张图"]},{default:x(()=>[d(Ce,{modelValue:i.value.base64Arr,"onUpdate:modelValue":h[1]||(h[1]=m=>i.value.base64Arr=m),tips:["图片最少两张、最多六张"],max:6,class:"mb-3"},null,8,["modelValue"])]),_:1}),s("div",ot,[d(t(F),{size:"small",type:"primary",loading:c.value,disabled:c.value||i.value.base64Arr.length<2,onClick:o},{default:x(()=>[C(k(c.value?"正在提交...":"提交混合任务"),1)]),_:1},8,["loading","disabled"])]),ut]))}}),rt={class:"w-full h-full p-[14px]"},dt={class:"flex justify-around items-center"},ct=s("span",{class:"text-gray-400"},"您的头像",-1),pt=s("span",{class:"text-gray-400"},"明星图",-1),mt={class:"flex justify-center w-full mt-8 pr-5"},ft=s("div",{class:"mt-5 space-y-1"},[s("h3",{class:"font-semibold"}," 使用说明 "),s("p",null,"- 请注意图片都须包含人脸、否则可能出图异常"),s("p",null,"- 你的头像：建议用一寸个人照效果更佳"),s("p",null,"- 明星图：也可以通过mj绘制出来之后使用"),s("p",null,"- 单张图片大小不可大于5M")],-1),vt=I({__name:"swapFace",emits:["notice","submitNotice"],setup(e,{emit:p}){const a=Q();V(()=>a.isLogin);const l=q(),c=g(!1),i=g({taskType:3,sourceBase:"",targetBase:""});Y(()=>{p("notice",i.value)});async function n(){try{if(c.value=!0,!i.value.sourceBase||!i.value.targetBase){l.error("请上传两张图片");return}await Pl(i.value),c.value=!1,p("submitNotice"),l.success("提交成功"),a.getUserInfo()}catch{c.value=!1}}return(o,u)=>(r(),v("div",rt,[s("div",dt,[d(te,{modelValue:i.value.targetBase,"onUpdate:modelValue":u[0]||(u[0]=h=>i.value.targetBase=h),size:140},{default:x(()=>[ct]),_:1},8,["modelValue"]),C(" + "),d(te,{modelValue:i.value.sourceBase,"onUpdate:modelValue":u[1]||(u[1]=h=>i.value.sourceBase=h),size:140},{default:x(()=>[pt]),_:1},8,["modelValue"])]),s("div",mt,[d(t(F),{size:"small",type:"primary",loading:c.value,disabled:c.value||!i.value.targetBase||!i.value.sourceBase,onClick:n},{default:x(()=>[C(k(c.value?"正在提交...":"提交换脸任务"),1)]),_:1},8,["loading","disabled"])]),ft]))}}),ht=I({__name:"drawQualityDalle",props:{modelValue:null},emits:["update:modelValue"],setup(e,{emit:p}){const a=e,l=g(""),c=[{label:"标准质量",value:"standard"},{label:"优质质量",value:"hd"}];function i(n){l.value=n,p("update:modelValue",l.value)}return L(()=>a.modelValue,()=>{l.value=a.modelValue},{immediate:!0}),(n,o)=>(r(),S(t(se),{value:l.value,"onUpdate:value":o[0]||(o[0]=u=>l.value=u),size:"small","on-update:value":i,name:"radiogroup"},{default:x(()=>[(r(),v(N,null,j(c,u=>d(t(ne),{key:u.value,class:"text-[12px] font-normal",value:u.value,label:u.label},null,8,["value","label"])),64))]),_:1},8,["value"]))}}),xt=I({__name:"drawStyleDalle",props:{modelValue:null},emits:["update:modelValue"],setup(e,{emit:p}){const a=e,l=g(""),c=[{label:"真实风格",value:"vivid"},{label:"自然风格",value:"natural"}];function i(n){l.value=n,p("update:modelValue",l.value)}return L(()=>a.modelValue,()=>{l.value=a.modelValue},{immediate:!0}),(n,o)=>(r(),S(t(se),{value:l.value,"onUpdate:value":o[0]||(o[0]=u=>l.value=u),size:"small","on-update:value":i,name:"radiogroup"},{default:x(()=>[(r(),v(N,null,j(c,u=>d(t(ne),{key:u.value,class:"text-[12px] font-normal",value:u.value,label:u.label},null,8,["value","label"])),64))]),_:1},8,["value"]))}}),bt={class:"w-full h-full p-[14px]"},gt={class:"flex justify-end"},yt={class:"flex justify-end"},wt={class:"flex justify-end"},At={class:"flex justify-end"},_t=I({__name:"dalle",emits:["notice"],setup(e,{emit:p}){const a=g({taskType:4,model:"dall",version:"3",scale:"1024x1024",quality:"standard",style:"vivid"}),l=V(()=>Number(a.value.version)===3?[{label:"1024px*1024px",value:"1024x1024"},{label:"1024px*1792px",value:"1024x1792"},{label:"1792px*1024px",value:"1792x1024"}]:[{label:"1024px*1024px",value:"1024x1024"},{label:"512px*512px",value:"512*512"},{label:"256px*256px",value:"256x256"}]),c=[{label:"Dall.E 3",value:"3"},{label:"Dall.E 2",value:"2"}];return L(()=>a.value.version,()=>{a.value.scale="1024x1024"}),Y(()=>{p("notice",a.value)}),(i,n)=>(r(),v("div",bt,[d(D,{title:"版本",tips:["Dall.E 版本选择"]},{header:x(()=>[s("div",gt,[d(X,{modelValue:a.value.version,"onUpdate:modelValue":n[0]||(n[0]=o=>a.value.version=o),"data-list":c,placeholder:"尺寸选择",class:"!w-[185px]"},null,8,["modelValue"])])]),_:1},8,["tips"]),d(D,{title:"尺寸",tips:["更大尺寸价格更贵"]},{header:x(()=>[s("div",yt,[d(X,{modelValue:a.value.scale,"onUpdate:modelValue":n[1]||(n[1]=o=>a.value.scale=o),"data-list":t(l),placeholder:"尺寸选择",class:"!w-[185px]"},null,8,["modelValue","data-list"])])]),_:1}),Number(a.value.version)===3?(r(),S(D,{key:0,title:"质量",tips:["生成图片的质量"]},{header:x(()=>[s("div",wt,[d(ht,{modelValue:a.value.quality,"onUpdate:modelValue":n[2]||(n[2]=o=>a.value.quality=o)},null,8,["modelValue"])])]),_:1})):w("",!0),Number(a.value.version)===3?(r(),S(D,{key:1,title:"风格",tips:["选择您喜欢的风格把"]},{header:x(()=>[s("div",At,[d(xt,{modelValue:a.value.style,"onUpdate:modelValue":n[3]||(n[3]=o=>a.value.style=o)},null,8,["modelValue"])])]),_:1})):w("",!0)]))}}),kt="data:image/png;base64,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",Vt={class:"absolute w-full bg-white dark:bg-[#1f1f1f] rounded-b-md h-[50px] bottom-0 border-t border-[#eaebef] dark:border-[#404752] flex items-center justify-between px-4"},St={class:"text-[14px] py-1 flex items-center"},It=["src"],Ut={class:"text-[#3076fd]"},Ct={class:"flex items-center"},Bt=I({__name:"index",emits:["notice","submitNotice"],setup(e,{emit:p}){const a=Q(),l=g(!1),c=pe(),i=V(()=>c.siderDrawCollapsed),{isMobile:n}=H(),o=V(()=>n.value?{position:"fixed",zIndex:50}:{backgroundColor:"#000"}),u=V(()=>a.userBalance),h=V(()=>u.value.sumDrawMjCount||0);function m(){c.setSiderDrawCollapsed(!i.value)}function f(T){p("notice",T)}function A(){p("submitNotice")}async function B(){l.value=!0;try{await a.getUserInfo(),l.value=!1}catch{l.value=!1}}return Pe(()=>{n.value&&c.setSiderDrawCollapsed(!0)}),(T,z)=>(r(),v(N,null,[d(t(He),{collapsed:t(i),"collapsed-width":0,width:350,"show-trigger":t(n)?!1:"arrow-circle","collapse-mode":"transform",position:"absolute",bordered:"",style:ee(t(o)),"content-style":{backgroundColor:t(c).theme==="dark"?"#1f1f1f":"#dce3f1"},onUpdateCollapsed:m},{default:x(()=>[s("div",{class:$(["bg-white dark:bg-[#1f1f1f] rounded-md pb-[80px]",t(n)?"mt-[45px] border-t dark:border-[#404752]":""])},[d(t(Le),{"default-value":"textToImgae","justify-content":"space-evenly",type:"line"},{default:x(()=>[d(t(ue),{name:"textToImgae",tab:"文生图"},{default:x(()=>[d(at,{onNotice:f})]),_:1}),d(t(ue),{name:"blend",tab:"混图"},{default:x(()=>[d(it,{onNotice:f,onSubmitNotice:A})]),_:1}),d(t(ue),{name:"swapFace",tab:"换脸"},{default:x(()=>[d(vt,{onNotice:f,onSubmitNotice:A})]),_:1}),d(t(ue),{name:"DallE",tab:"Dall.E"},{default:x(()=>[d(_t,{onNotice:f})]),_:1})]),_:1})],2),s("div",Vt,[s("span",St,[s("img",{src:t(kt),class:"w-[16px] mr-1 mb-1"},null,8,It),C(" 钱包余额("),s("b",Ut,k(t(h)||0),1),C(" 积分)")]),s("span",Ct,[d(t(F),{text:"",size:"tiny",type:"primary",loading:l.value,onClick:B},{default:x(()=>[C("刷新")]),_:1},8,["loading"]),d(t(de),{placement:"top",trigger:"hover"},{trigger:x(()=>[d(t(P),{icon:"ri:error-warning-line",class:"text-base ml-2"})]),default:x(()=>[C(" 绘画账户信息 ")]),_:1})])])]),_:1},8,["collapsed","show-trigger","style","content-style"]),t(n)?ke((r(),v("div",{key:0,class:"fixed inset-0 z-10 bg-black/40",onClick:m},null,512)),[[Ve,!t(i)]]):w("",!0)],64))}}),Et={key:0,class:"px-[18px] py-[10px] bg-white dark:bg-[#1f1f1f] z-10 bg-transparent rounded-b-md"},Dt={class:"relative flex-1"},Tt={class:"absolute bottom-2 left-2 right-2"},Nt={class:"flex items-center justify-between"},Rt={class:"flex space-x-5"},$t={class:"flex items-center"},jt=s("span",{class:"w-[1px] h-[12px] bg-gray-400 mx-2"},null,-1),zt={class:"flex items-center"},Mt=s("span",{class:"w-[1px] h-[12px] bg-gray-400 mx-2"},null,-1),Pt={class:"flex justify-between items-center"},Lt={class:"dark:text-black"},Ft={class:"dark:text-black"},Ot={class:"w-[200px] h-full rounded-md flex p-3"},Jt={class:"flex flex-col w-full"},Gt=s("h4",{class:"mb-2"}," 咒语解析 ",-1),Qt={class:"flex flex-col justify-center items-center w-full"},Ht=I({__name:"inputBox",props:{notifyId:null,submitLoading:{type:Boolean},params:null},emits:["submit"],setup(e,{emit:p}){const a=e,l=g(""),c=g(!1),i=Fe(),{isMobile:n}=H(),o=g(""),u=g("fast"),h=g(!1),m=g(!0),f=pe(),A=g(!1);async function B(){var b;const y=i.query.drawId;if(!y)return;const _=await Rl({id:y});o.value=(b=_==null?void 0:_.data)==null?void 0:b.prompt}const T=V(()=>o.value===""||a.submitLoading);L(()=>a.notifyId,()=>{o.value=""});async function z(){try{A.value=!0,await Ol({base64:l.value}),l.value="",A.value=!1,c.value=!1}catch{A.value=!1}}function M(y){n.value?y.key==="Enter"&&y.ctrlKey&&(y.preventDefault(),O()):y.key==="Enter"&&!y.shiftKey&&(y.preventDefault(),O())}Y(()=>{B()});function J(){f.setSiderDrawCollapsed(!1)}function O(){p("submit",{prompt:o.value,autoOptimize:h.value,autoTranslate:m.value,speed:u.value})}function U(){c.value=!0}return(y,_)=>[1,4].includes(e.params.taskType)?(r(),v("div",Et,[s("div",{id:"drawer-target",class:"w-[200px] mb-2 rounded-md float-right",style:ee([{position:"relative","margin-top":"10px",display:"flex","align-items":"center","justify-content":"center",overflow:"hidden"},{height:c.value?"200px":"0px"}])},null,4),s("div",Dt,[d(t(Se),{ref:"inputRef",value:o.value,"onUpdate:value":_[0]||(_[0]=b=>o.value=b),type:"textarea",class:"pb-10",clearable:"",disabled:e.submitLoading,autofocus:"",placeholder:"发挥您的想象力、输入您想要生成的图片描述信息......",autosize:{minRows:t(n)?1:2,maxRows:t(n)?2:3},onKeypress:M},null,8,["value","disabled","autosize"]),s("div",Tt,[s("div",Nt,[s("div",Rt,[t(n)?(r(),v("span",{key:0,class:"text-2xl bg-[#6790f4] text-white shadow p-1 ml-1 mr-1 rounded-full",onClick:J},[d(t(P),{class:"text-[14px]",icon:"ep:expand"})])):w("",!0),s("span",$t,[d(t(be),{value:h.value,"onUpdate:value":_[1]||(_[1]=b=>h.value=b),size:"small"},null,8,["value"]),C(),jt,C(" "+k(t(n)?"优化":"自动优化提示词"),1)]),s("span",zt,[d(t(be),{value:m.value,"onUpdate:value":_[2]||(_[2]=b=>m.value=b),size:"small"},null,8,["value"]),C(),Mt,C(" "+k(t(n)?"翻译":"自动翻译"),1)]),t(n)?w("",!0):(r(),S(t(F),{key:1,type:"primary",size:"small",ghost:"",onClick:U},{default:x(()=>[d(t(P),{class:"text-[20px] mr-1 mb-[2px]",icon:"mage:light-bulb"}),C(" 咒语解析 ")]),_:1})),t(n)?(r(),S(t(P),{key:2,class:"text-[20px] mr-1 mb-[2px]",icon:"mage:light-bulb",onClick:U})):w("",!0)]),s("div",Pt,[e.submitLoading?w("",!0):(r(),S(t(F),{key:0,type:"primary",size:"small",style:{padding:"0px",width:"28px",height:"28px",border:"0px"},disabled:t(T),round:"",onClick:O},{icon:x(()=>[s("span",Lt,[d(t(P),{icon:"icon-park-outline:send"})])]),_:1},8,["disabled"])),e.submitLoading?(r(),S(t(F),{key:1,type:"primary",size:"small",style:{padding:"0px",width:"28px",height:"28px",border:"0px"},disabled:t(T),round:""},{icon:x(()=>[s("span",Ft,[d(t(P),{icon:"eos-icons:loading",class:"text-[22px]"})])]),_:1},8,["disabled"])):w("",!0)])])])]),d(t(Ke),{show:c.value,"onUpdate:show":_[4]||(_[4]=b=>c.value=b),height:200,placement:"bottom","trap-focus":!1,"block-scroll":!1,"show-mask":!1,to:"#drawer-target"},{default:x(()=>[s("div",Ot,[s("div",Jt,[Gt,s("div",Qt,[d(te,{modelValue:l.value,"onUpdate:modelValue":_[3]||(_[3]=b=>l.value=b),size:120,class:"flex-shrink-0"},null,8,["modelValue"]),d(t(F),{size:"small",type:"primary",disabled:!l.value,class:"!mt-2 !text-[12px] !h-[22px] !w-[118px]",loading:A.value,onClick:z},{default:x(()=>[C(" 解析 ")]),_:1},8,["disabled","loading"])])])])]),_:1},8,["show"])])):w("",!0)}});function Kt(e,p){let a=!1;return function(){a||(e(),a=!0,setTimeout(()=>{a=!1},p))}}function Wt(){const e=g(null),p=async()=>{await we(),e.value&&(e.value.scrollTop=e.value.scrollHeight)},a=async()=>{await we(),e.value&&(e.value.scrollTop=0)},l=Kt(c,100);async function c(){e.value&&e.value.scrollHeight-e.value.scrollTop-e.value.clientHeight<=500&&(e.value.scrollTop=e.value.scrollHeight)}return{scrollRef:e,scrollToBottom:p,scrollToTop:a,scrollToBottomIfAtBottom:l}}const qt={class:"flex min-h-[65px] border-l-2 border-[#d03050]"},Zt={class:"flex flex-col justify-between bg-[#fbeef1] dark:bg-[#404752] px-[20px] py-[4px] rounded-r-md min-w-[250px]"},Yt={class:"text-[16px] font-medium"},Xt={class:"text-[14px]"},Ae=I({__name:"errPanel",props:{errMsg:null},setup(e){const p=e,a=V(()=>l(p.errMsg));function l(c){const i=c.match(/\[(.*?)\]/),n=c.match(/\] (.*)/),o=i?i[1]:"",u=n?n[1]:"";return{title:o,text:u}}return(c,i)=>{var n,o;return r(),v("div",qt,[s("div",Zt,[s("span",Yt,k(((n=t(a))==null?void 0:n.title)||"draw err"),1),s("span",Xt,k(((o=t(a))==null?void 0:o.text)||p.errMsg||"出现了一点儿小错误！"),1)])])}}}),ea={class:"w-[300px]"},la=I({__name:"loadingImg",props:{url:null,preUrl:null,scale:null},setup(e){const p=e,a=pe(),l=g(!1),{isMobile:c}=H();function i(){l.value=!0}const n=V(()=>c?260:300),o=V(()=>{const u=p.scale||"1:1",[h,m]=u.split(":").map(Number);return n.value*m/h});return(u,h)=>(r(),v("div",ea,[ke(d(t(Oe),{width:t(n),src:e.url,"on-load":i,"preview-src":e.preUrl},null,8,["width","src","preview-src"]),[[Ve,l.value]]),l.value?w("",!0):(r(),v("div",{key:0,style:ee({width:`${t(n)}px`,height:`${t(o)}px`}),class:$(["relative",t(a).theme==="dark"?"loadBg-dark":"loadBg-light"])},[s("span",{style:ee({left:`${t(n)-37}px`}),class:"absolute top-2 bg-white rounded-full p-[2px]"},[d(t(P),{icon:"line-md:loading-alt-loop",class:"text-[24px] text-primary"})],4)],6))]))}});const ta=ae(la,[["__scopeId","data-v-36627085"]]),aa={key:0},sa=s("p",{class:"my-2"}," 下列咒语是由你解析的提示词、你可以选择喜欢的提示词、复制到输入框、如果有自定义指令、请在左侧禁用自定义指令！ ",-1),na=["onClick"],oa=I({__name:"describePre",props:{detail:null},setup(e){const p=e,a=q(),l=V(()=>{let i=[];try{i=JSON.parse(p.detail.detail).prompt.split(`
`).filter(o=>o)}catch{i=[]}return i});function c(i){Ue({text:i}),a.success("复制咒语成功、如果有自定义指令、请在左侧禁用自定义指令！")}return(i,n)=>t(l).length?(r(),v("div",aa,[sa,(r(!0),v(N,null,j(t(l),(o,u)=>(r(),v("p",{key:u,class:"text-[12px] mb-1",onClick:h=>c(o)},k(o),9,na))),128))])):w("",!0)}}),_e="data:image/png;base64,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",ua="/assets/dallAvatar-6100c500.png",ia={class:"flex justify-between w-full"},ra={class:"mr-[10px] flex-shrink-0"},da=["src"],ca={class:"flex-1 flex flex-col w-full"},pa={class:"flex items-center justify-between"},ma={class:"flex items-center h-full"},fa={class:"text-[16px] font-bold"},va={key:0,class:"w-[68px] h-[24px] rounded-sm flex items-center justify-center text-white bg-[#3388FF] text-[12px] mx-[12px]"},ha={key:0,class:"w-full text-[#1D1C23] dark:text-[#e1ebef] text-[14px] py-[8px] border-b border-[#404752] dark:border-[#404752]"},xa={key:0,class:"ml-4"},ba={key:2,class:"w-full text-[#1D1C23] dark:text-[#e1ebef] text-[14px] py-[8px] border-b border-[#404752]"},ga={key:3,class:"w-full text-[#1D1C23] dark:text-[#e1ebef] text-[14px] py-[8px] border-b border-[#404752]"},ya={key:4,class:"text-[#79bbff] text-[14px] my-[12px] flex items-center"},wa={key:0,class:"ml-1"},Aa={class:"ml-1"},_a={key:1,class:"relative w-[20px] inline-block"},ka={key:5,class:"text-[#79bbff] text-[14px] my-[12px] flex items-center"},Va={key:0,class:"ml-1"},Sa={class:"ml-1"},Ia={key:1,class:"relative w-[20px] inline-block"},Ua={class:"flex items-center py-2"},Ca={class:"flex justify-between items-end"},Ba=s("p",{class:"text-[12px]"}," 粘贴在左侧面板使用、可获得相似图片 ",-1),Ea=I({__name:"drawHeader",props:{detail:null},emits:["deleteItem","refresh"],setup(e,{emit:p}){const a=e,l=Q(),c=q(),{isMobile:i}=H(),n=V(()=>l.isLogin),o=g(!1),u=g(!1),h=g(a.detail.seed),m=V(()=>{const{status:U,drawType:y}=a.detail;return U==="IN_PROGRESS"&&y===1}),f=V(()=>{const{progress:U,status:y}=a.detail;return y==="SUCCESS"?!1:(!U||U!=="100%")&&y!=="FAILURE"}),A=V(()=>{const{speed:U,drawType:y,version:_}=a.detail;return y===1?`(${U})`:y===2?`(dall.e${_})`:""}),B=V(()=>{const{drawType:U}=a.detail;return U===1?_e:U===2?ua:_e}),T=V(()=>{const{drawType:U}=a.detail;return Number(U)===1?"Midjourney Bot":Number(U)===2?"Dall-E Bot":"Midjourney Bot"});V(()=>{const{swapFacePic:U}=a.detail;let y=[];try{y=JSON.parse(U)}catch{y=[]}return y});const z=V(()=>{const{createdAt:U}=a.detail;return U});function M(U){Ue({text:U}),c.success("复制seed值成功、请在画板中粘贴seed值进行绘画")}async function J(){try{u.value=!0;const U=a.detail.result,y=await Fl({resultId:U});h.value=y.data,u.value=!1}catch{u.value=!1}}function O(){M(h.value),o.value=!1,p("refresh")}return(U,y)=>(r(),v("div",ia,[s("span",ra,[s("img",{src:t(B),class:"w-[40px] h-[40px] rounded-full border"},null,8,da)]),s("div",ca,[s("div",pa,[s("div",ma,[s("span",fa,k(t(T)),1),t(i)?w("",!0):(r(),v("span",va,"AI机器人")),s("span",{class:$(["text-[12px] text-[#9E9E9E]",t(i)?"ml-2":""])},k(t(z)),3)]),t(n)?(r(),v("span",{key:0,onClick:y[0]||(y[0]=_=>p("deleteItem"))},[d(t(F),{size:"tiny",ghost:""},{icon:x(()=>[d(t(P),{icon:"ri:delete-bin-line",class:"text-base"})]),_:1})])):w("",!0)]),e.detail.prompt&&!["SWAP_FACE","BLEND"].includes(e.detail.action)?(r(),v("div",ha,[C(k(e.detail.prompt)+" ",1),e.detail.drawType===1&&e.detail.status==="SUCCESS"&&!["DESCRIBE"].includes(e.detail.action)?(r(),v("span",xa,[C(" ["),s("span",null,[C(" seed值: "),e.detail.seed?w("",!0):(r(),S(t(de),{key:0,trigger:"hover"},{trigger:x(()=>[e.detail.seed?w("",!0):(r(),S(t(F),{key:0,text:"",type:"primary",onClick:y[1]||(y[1]=_=>o.value=!0)},{default:x(()=>[C(" 点击获取 ")]),_:1}))]),default:x(()=>[C(" 使用获取到的seed值粘贴在右侧、可以获得很相似的图片！ ")]),_:1})),e.detail.seed?(r(),v("span",{key:1,class:"cursor-pointer dark:text-primary",onClick:y[2]||(y[2]=_=>M(e.detail.seed))},k(e.detail.seed),1)):w("",!0)]),C(" ]")])):w("",!0)])):w("",!0),["DESCRIBE"].includes(e.detail.action)?(r(),S(oa,{key:1,detail:e.detail},null,8,["detail"])):w("",!0),["SWAP_FACE"].includes(e.detail.action)?(r(),v("div",ba,[s("span",null,k(e.detail.progress==="100%"?"此任务由AI换脸完成......":"正在执行AI换脸任务中......"),1)])):w("",!0),["BLEND"].includes(e.detail.action)?(r(),v("div",ga,[s("span",null,k(e.detail.progress==="100%"?"此任务由混图功能完成......":"正在执行AI图片混合任务中......"),1)])):w("",!0),e.detail.prompt&&!["SWAP_FACE","BLEND"].includes(e.detail.action)?(r(),v("div",ya,[s("div",null,[C(k(e.detail.promptEn)+" ",1),t(m)?(r(),v("span",wa,"("+k(e.detail.progress||"watting start")+")",1)):w("",!0),C(),s("span",Aa,k(t(A)),1),t(f)?(r(),v("span",_a,[d(t(re),{class:"absolute left-[20px] top-[-12px] inline-block",size:16})])):w("",!0)])])):w("",!0),["SWAP_FACE","BLEND"].includes(e.detail.action)?(r(),v("div",ka,[s("div",null,[C(k(e.detail.fullPrompt)+" ",1),t(m)?(r(),v("span",Va,"("+k(e.detail.progress||"watting start")+")",1)):w("",!0),C(),s("span",Sa,k(t(A)),1),t(f)?(r(),v("span",Ia,[d(t(re),{class:"absolute left-[20px] top-[-12px] inline-block",size:16})])):w("",!0)])])):w("",!0)]),d(t(he),{show:o.value,"onUpdate:show":y[3]||(y[3]=_=>o.value=_),style:{width:"400px","max-width":"94vw"},"show-icon":!1,"on-after-enter":J,preset:"dialog",title:"获取seed值"},{default:x(()=>[s("div",Ua,[C(" 正在获取中： "),u.value?(r(),S(t(re),{key:0,size:16,class:"ml-2"})):w("",!0),C(),s("b",null,k(h.value),1)]),s("div",Ca,[Ba,d(t(F),{type:"primary",disabled:u.value,size:"small",onClick:O},{default:x(()=>[C(" 复制并退出 ")]),_:1},8,["disabled"])])]),_:1},8,["show"])]))}}),Da=["src"],Ta=I({__name:"regionDraw",props:{drawInfo:null,base64:null},emits:["success"],setup(e,{emit:p}){const a=e,l=g({q:""}),c=g(),i=o=>{if(console.log("我收到消息了",o.data),!(o!=null&&o.data))return;const u=JSON.parse(o.data);p("success",u)};Y(()=>{var u;const o={instance_id:"1",custom_id:"2",channel_id:"3",guild_id:"4",frame_id:"5",platform:"desktop",prompt:(u=a.drawInfo)==null?void 0:u.prompt,img_type:"png",img_info:JSON.stringify({image_url:a.drawInfo.originalImgUrl,prompt:a.drawInfo.fullPrompt})};console.log("整理的: ",o),l.value.q=Object.keys(o).map(h=>`${h}=${encodeURIComponent(o[h])}`).join("&"),console.log("st.value.q: ",l.value.q),window.addEventListener("message",i)}),Je(()=>{window.removeEventListener("message",i)});const n=o=>{var h;console.log("loadOk","good news");const u=o.target;u.contentWindow&&u.contentWindow.postMessage(JSON.stringify({act:"go",img_info:{image_url:a.base64===""?(h=a.drawInfo)==null?void 0:h.originalImgUrl:a.base64,prompt:a.drawInfo.fullPrompt}}),"*")};return(o,u)=>l.value.q?(r(),v("iframe",{key:0,ref_key:"ifdiv",ref:c,src:`https://mj.aibear.com.cn/draw/mitf/index.html?${l.value.q}`,class:"h-[80vh] w-full",style:{"border-width":"0px","border-style":"none",overflow:"hidden"},onLoad:n},null,40,Da)):w("",!0)}}),Na={key:0},Ra=["onClick"],$a={key:0,class:"relative w-[16px] inline-block"},ja={class:"flex justify-between items-end"},za=s("span",null,"修改zoom值,范围在 1.0~2.0 默认设置为1.7",-1),Ma={class:"w-full"},Pa=I({__name:"buttons",props:{detail:null,loading:{type:Boolean}},emits:["submit"],setup(e,{emit:p}){const a=e,l=Q(),{isMobile:c}=H(),i=g(""),n=g({}),o=g(!1),u=g(!1),h=g({}),m=g(!1),f=q();g(!1);const A=V(()=>{const{buttons:b}=a.detail;try{const E=JSON.parse(b);return B(E)}catch{return[]}});function B(b){if(b.length===0)return[];if(b.length===13)return[b.slice(0,5),b.slice(5,8),b.slice(8,12)];if(b.length===9)return[b.slice(0,5),b.slice(5,9)];if(b.length===14)return[b.slice(0,5),b.slice(5,9),b.slice(9,13)];if(b.length===5)return[b.slice(0,4)];if(b.length===3)return[b.slice(0,2)];if(b.length===6)return[b.slice(0,6)]}async function T(b,E){if(h.value={actionInfo:b,key:E},b.label==="Custom Zoom"){i.value=`${a.detail.fullPrompt} --zoom 1.7`,o.value=!0;return}if(b.label==="Vary (Region)"){f.warning("局部重绘功能即将开发...");return}M()}async function z(){M(i.value)}async function M(b=""){const{actionInfo:E,key:R}=h.value;if(Object.keys(n.value).some(le=>n.value[le]))return f.warning("请等待任务提交完成后继续");n.value[R]=!0,m.value=!0;const{customId:K,label:G}=E,{result:W}=a.detail;try{await zl({customId:K,taskId:W,label:G,zoomPrompt:b}),i.value="",h.value={},p("submit"),m.value=!1,o.value=!1,setTimeout(()=>{n.value[R]=!1,l.getUserInfo()},1e3)}catch{m.value=!1,o.value=!1,i.value="",h.value={},n.value[R]=!1}}async function J(b){n.value[b]||(n.value[b]=!1)}function O(b){let E=[];try{E=a.detail.operateButtons?JSON.parse(a.detail.operateButtons):[]}catch{E=[]}return E.includes(b)}function U(b){console.log("handleRegionSuccess: ",b)}function y(b){return b}function _(b){return b.includes("upscale_1")?b.replace("upscale_1",""):b}return(b,E)=>(r(),v(N,null,[t(A)&&t(A).length?(r(),v("div",Na,[(r(!0),v(N,null,j(t(A),(R,K)=>(r(),v("div",{key:K,class:"flex flex-wrap"},[(r(!0),v(N,null,j(R,(G,W)=>{var le,ge;return r(),v("span",{key:W,ref_for:!0,ref:()=>{var me;return J(`loading-${(me=e.detail)==null?void 0:me.result}-${K}-${W}`)},class:$([[n.value[`loading-${(le=e.detail)==null?void 0:le.result}-${K}-${W}`]?"brightness-90":"",O(G.customId)?"bg-[#5A91FC] text-[#fff]":"bg-[#fff] dark:bg-[#2e3246] text-black dark:text-white",t(c)?"px-[14px] py-[5px]  mt-[8px] mr-[6px]":"px-[16px] py-[4px]  mt-[8px] mr-2"],"text-[12px] rounded select-none cursor-pointer hover:brightness-90 active:brightness-95 transition-all whitespace-nowrap"]),onClick:me=>{var ye;return T(G,`loading-${(ye=e.detail)==null?void 0:ye.result}-${K}-${W}`)}},[s("span",{class:$(G.emoji&&G.label?"mr-[6px]":"")},k(_(G.emoji)),3),s("span",null,k(G.label),1),n.value[`loading-${(ge=e.detail)==null?void 0:ge.result}-${K}-${W}`]?(r(),v("span",$a,[d(t(re),{class:"absolute left-[8px] top-[-12px] inline-block",size:14})])):w("",!0)],10,Ra)}),128))]))),128))])):w("",!0),d(t(he),{show:o.value,"onUpdate:show":E[1]||(E[1]=R=>o.value=R),style:{width:"600px","max-width":"100vw"},"show-icon":!1,preset:"dialog",title:"自定义变焦"},{default:x(()=>[d(t(Se),{value:i.value,"onUpdate:value":E[0]||(E[0]=R=>i.value=R),type:"textarea",placeholder:"请按要求填写绘制参数",class:"my-5"},null,8,["value"]),s("div",ja,[za,d(t(F),{type:"primary",loading:m.value,disabled:m.value,size:"small",onClick:z},{default:x(()=>[C(k(m.value?"正在提交":"提交绘制"),1)]),_:1},8,["loading","disabled"])])]),_:1},8,["show"]),d(t(he),{show:u.value,"onUpdate:show":E[2]||(E[2]=R=>u.value=R),style:{width:"600px","max-width":"100vw"},"show-icon":!1,preset:"dialog",title:"局部重绘编辑"},{default:x(()=>{var R;return[s("div",Ma,[u.value?(r(),S(Ta,{key:0,"draw-info":(R=h.value)==null?void 0:R.actionInfo,onSuccess:U},null,8,["draw-info"])):w("",!0)])]}),_:1},8,["show"])],64))}}),La={class:"ml-[50px]"},Fa=I({__name:"drawItem",props:{detail:null,loading:{type:Boolean}},emits:["submit","deleteItem","refresh"],setup(e,{emit:p}){const{isMobile:a}=H();return(l,c)=>{var i,n;return r(),v("div",{class:$(["bg-[#f6f7fa] dark:bg-[#1f1f1f] flex flex-col pt-[21px] pb-[15px]",[t(a)?"px-2":"px-[12px]"]])},[d(Ea,{detail:e.detail,onDeleteItem:c[0]||(c[0]=o=>p("deleteItem",e.detail.id)),onRefresh:c[1]||(c[1]=o=>p("refresh"))},null,8,["detail"]),s("div",La,[e.detail.originalImgUrl&&!["DESCRIBE"].includes(e.detail.action)?(r(),S(ta,{key:0,"pre-url":e.detail.originalImgUrl||e.detail.thumb,url:e.detail.thumb||e.detail.originalImgUrl,scale:e.detail.scale},null,8,["pre-url","url","scale"])):w("",!0),["DESCRIBE"].includes(e.detail.action)?w("",!0):(r(),S(Pa,{key:1,detail:e.detail,loading:e.loading,onSubmit:c[2]||(c[2]=o=>p("submit"))},null,8,["detail","loading"])),e.detail.drawType===1&&e.detail.buttons==="[]"&&e.detail.requestErrTextTips?(r(),S(Ae,{key:2,"err-msg":(i=e.detail)==null?void 0:i.requestErrTextTips},null,8,["err-msg"])):w("",!0),e.detail.drawType===2&&e.detail.requestErrTextTips?(r(),S(Ae,{key:3,"err-msg":(n=e.detail)==null?void 0:n.requestErrTextTips},null,8,["err-msg"])):w("",!0)])],2)}}}),Oa={class:"space-y-3"},Ja=I({__name:"index",props:{notifyId:null},setup(e){const p=e,a=g([]),l=Q(),{scrollRef:c,scrollToBottom:i,scrollToBottomIfAtBottom:n}=Wt(),o=V(()=>l.isLogin),u=g(!1),h=g(!1),m=Ge(),f=q();async function A(){try{h.value=!0;const _=(await Nl()).data.rows;h.value=!1,_.length&&(a.value=_,u.value&&T(a.value)&&setTimeout(()=>{n()},100),B(a.value)&&setTimeout(()=>{A()},3e3)),_.length||M()}catch{h.value=!1}}function B(y){return y.some(_=>["NOT_START","SUBMITTED","MODAL","IN_PROGRESS"].includes(_.status))}function T(y){return["NOT_START","SUBMITTED","MODAL","IN_PROGRESS"].includes(y[y.length-1].status)}async function z(y){const _=m.warning({title:"删除记录",content:"是否确认删除当前绘制记录、已经启动的任务删除也会扣费！",positiveText:"删除",negativeText:"我再想想",onPositiveClick:async()=>(_.loading=!0,new Promise(async b=>{await Ml({id:y}),A(),f.success("删除绘制记录成功！"),b(!0)}))})}async function M(){try{h.value=!0;const y=await Tl({page:1,size:20});a.value=y.data.rows,h.value=!1}catch{h.value=!1}}async function J(){await A(),setTimeout(()=>{i(),u.value=!0},1e3)}async function O(){await A(),i()}Y(async()=>{await J()}),L(()=>p.notifyId,()=>{A()}),L(()=>o.value,()=>{J()});function U(y){y.target}return(y,_)=>(r(),v("div",{ref_key:"scrollRef",ref:c,class:$([u.value?" scroll-smooth":"","relative h-full overflow-hidden overflow-y-auto"]),onScroll:U},[s("div",Oa,[(r(!0),v(N,null,j(a.value,(b,E)=>(r(),S(Fa,{key:E,detail:b,loading:h.value,onRefresh:A,onSubmit:O,onDeleteItem:z},null,8,["detail","loading"]))),128))])],34))}}),Ga={class:"bg-white dark:bg-[#1f1f1f] h-full rounded-md flex flex-col"},Qa={class:"flex-1 flex flex-col h-1"},Ha=I({__name:"index",props:{params:null},setup(e,{expose:p}){const a=e;H();const l=g({prompt:"",autoOptimize:!1,autoTranslate:!0,speed:"fast"}),c=g(0),i=g(!1),n=Q();V(()=>n.isLogin);async function o(){try{i.value=!0;const m={...l.value,...a.params};await jl(m),i.value=!1,c.value++,n.getUserInfo()}catch{i.value=!1}}function u(){c.value++}p({noticeSubmit:u});function h(m){const{prompt:f,autoOptimize:A,speed:B,autoTranslate:T}=m;f&&(l.value={prompt:f,autoOptimize:A,autoTranslate:T,speed:B},o())}return(m,f)=>(r(),v("div",Ga,[s("main",Qa,[d(Ja,{class:"flex-1","notify-id":c.value},null,8,["notify-id"])]),d(Ht,{params:e.params,class:"overflow-hidden","notify-id":c.value,"submit-loading":i.value,onSubmit:h},null,8,["params","notify-id","submit-loading"])]))}}),Ka={class:"h-full dark:bg-[#000] transition-all"},ts=I({__name:"index",setup(e){const p=pe(),{isMobile:a}=H(),l=V(()=>p.siderDrawCollapsed),c=g({}),i=g(null),n=V(()=>["h-full","dark:bg-[#000] bg-[#dce3f1]"]);function o(m){c.value=m}const u=V(()=>a.value?["rounded-none","shadow-none"]:["rounded-md","shadow-md","dark:border-neutral-800"]);function h(){i.value&&i.value.noticeSubmit()}return(m,f)=>(r(),v("div",Ka,[s("div",{class:$(["h-full overflow-hidden",t(u)])},[d(t(Qe),{class:$(["z-40 transition",t(n)]),"has-sider":"","content-style":{backgroundColor:t(p).theme==="dark"?"#000":"#dce3f1"}},{default:x(()=>[d(Bt,{class:"h-full",onNotice:o,onSubmitNotice:h}),s("div",{class:$(["bg-[#dce3f1] dark:bg-[#000] transition-all",[!t(a)&&!t(l)?"translate-x-[350px] w-[calc(100%-362px)]":"w-full translate-x-0",t(a)?"px-0":"ml-[12px]"]])},[d(Ha,{ref_key:"contentRef",ref:i,params:c.value},null,8,["params"])],2)]),_:1},8,["class","content-style"])],2)]))}});export{ts as default};
